###############################################################################
# 
# TARIM BASIN
# 
# tarim_basin.0000-tarim_basin.0019			Setup events, history events, miscellaneous decisions
# tarim_basin.0020-tarim_basin.0039			Silk Road Communities
# tarim_basin.0040-tarim_basin.0049			Silk Road Entertainers flavor events
# tarim_basin.0050-tarim_basin.0099			Dunhuang
#	tarim_basin.0050-tarim_basin.0069			Dunhuang history
#	tarim_basin.0070-tarim_basin.0099			Mogao Caves
# tarim_basin.0100-tarim_basin.0149			Tocharians
#	tarim_basin.0100-tarim_basin.0109			Stage Animal Fights to Predict the Harvest
# tarim_basin.0150-tarim_basin.0199			Khotanese
#	tarim_basin.0150-tarim_basin.0169			Spring Procession
#	tarim_basin.0170-tarim_basin.0179			8 Protectors/Khotan refugees aftermath
# tarim_basin.0200-tarim_basin.0249			Kara-Khanids/Islamic Uighurs
#	tarim_basin.0200-tarim_basin.0209			Al-Kashgari/Compile First Turkic Dictionary
# tarim_basin.0250-tarim_basin.0299			Generic events
# 
# 
###############################################################################

namespace = tarim_basin

######################################################################################
# 
# SETUP EVENTS, HISTORY EVENTS, MISC DECISIONS
# 
# tarim_basin.0000-tarim_basin.0019
# 
######################################################################################


# Sinicization name event
tarim_basin.0010 = {
	type = character_event
	title = tarim_basin.0010.t
	desc = {
		desc = tarim_basin.0010.desc
		first_valid = {
			triggered_desc = {
				trigger = {
					game_start_date >= 755.1.1
					game_start_date <= 950.1.1
					current_date < 1000.1.1
				}
				desc = tarim_basin.0010.desc.867
			}
		}
	}
	theme = family
	right_portrait = root

	immediate = {
		RICE_tarim_basin_sinicize_effect = yes
	}
	
	#NAMING WIDGET
	widgets = {
		widget = {
			gui = "event_window_widget_RICE_sinicize_name"
			container = "dynamic_birth_name"
			controller = name_character
			setup_scope = {
				root = { save_scope_as = name_character_target }
			}
		}
	}

	#Go ahead
	option = {
		name = tarim_basin.0010.a
	}

	#On second thought...
	option = {
		name = tarim_basin.0010.b
		is_cancel_option = yes
	}

}


# Prepare to send Silk Road entertainers
tarim_basin.0012 = {
	type = character_event
	title = tarim_basin.0012.t
	desc = tarim_basin.0012.desc
	theme = realm
	
	left_portrait = scope:actor
	right_portrait = scope:recipient

	immediate = {
		play_music_cue = "middleeasterncourt_cue"
	}

	option = { # OK
		name = tarim_basin.0012.a

		add_prestige = 100

		dynasty = { add_dynasty_prestige = 50 }

		scope:recipient = {
			show_as_tooltip = {
				add_character_modifier = {
					modifier = RICE_tarim_basin_silk_road_entertainers
					years = 10
				}
				add_opinion = {
					target = scope:actor
					modifier = RICE_tarim_basin_gifted_silk_road_entertainers
				}
				if = {
					limit = {
						has_royal_court = yes
					}
					change_current_court_grandeur = minor_court_grandeur_gain
				}			
			}
			trigger_event = tarim_basin.0013
		}

	}
}



# Receive Silk Road entertainers
tarim_basin.0013 = {
	type = character_event
	title = tarim_basin.0013.t
	desc = tarim_basin.0013.desc
	theme = realm
	
	left_portrait = scope:actor
	right_portrait = scope:recipient
	
	immediate = {

		play_music_cue = "middleeasterncourt_cue"

		scope:actor = {
			show_as_tooltip = {				
				add_prestige = 100
				dynasty = { add_dynasty_prestige = 50 }	
			}
		}

		add_character_modifier = {
			modifier = RICE_tarim_basin_silk_road_entertainers
			years = 10
		}

		add_opinion = {
			target = scope:actor
			modifier = RICE_tarim_basin_gifted_silk_road_entertainers
		}

		if = {
			limit = {
				has_royal_court = yes
			}
			change_current_court_grandeur = minor_court_grandeur_gain
		}	
	}

	option = {
		name = tarim_basin.0013.a
	}

	after = {
		RICE_tarim_basin_save_entertainer_location_effect = yes
	}

}


# Prepare to send Kuchean entertainers
tarim_basin.0014 = {
	type = character_event
	title = tarim_basin.0014.t
	desc = tarim_basin.0014.desc
	theme = realm
	
	left_portrait = scope:actor
	right_portrait = scope:recipient

	immediate = {
		play_music_cue = "middleeasterncourt_cue"
		title:c_kucha = { #For loc.
			save_scope_as = kucha
		}	
	}

	option = { # OK
		name = tarim_basin.0014.a

		add_prestige = 200

		dynasty = { add_dynasty_prestige = 100 }

		scope:recipient = {
			show_as_tooltip = {
				add_character_modifier = {
					modifier = RICE_tarim_basin_kuchean_entertainers
					years = 10
				}
				add_opinion = {
					target = scope:actor
					modifier = RICE_tarim_basin_gifted_kuchean_entertainers
				}
				if = {
					limit = {
						has_royal_court = yes
					}
					change_current_court_grandeur = medium_court_grandeur_gain
				}			
			}
			trigger_event = tarim_basin.0015
		}

	}
}



# Receive Kuchean entertainers
tarim_basin.0015 = {
	type = character_event
	title = tarim_basin.0015.t
	desc = tarim_basin.0015.desc
	theme = realm
	
	left_portrait = scope:actor
	right_portrait = scope:recipient
	
	immediate = {

		play_music_cue = "middleeasterncourt_cue"

		scope:actor = {
			show_as_tooltip = {				
				add_prestige = 200
				dynasty = { add_dynasty_prestige = 100 }	
			}
		}

		add_character_modifier = {
			modifier = RICE_tarim_basin_kuchean_entertainers
			years = 10
		}

		add_opinion = {
			target = scope:actor
			modifier = RICE_tarim_basin_gifted_kuchean_entertainers
		}

		if = {
			limit = {
				has_royal_court = yes
			}
			change_current_court_grandeur = minor_court_grandeur_gain
		}	
	}

	option = {
		name = tarim_basin.0015.a
	}

	after = {
		RICE_tarim_basin_save_entertainer_location_effect = yes
	}

}


# Lop Nur lake level changes ping event
tarim_basin.0016 = {
	hidden = yes
	
	trigger = {
		has_global_variable = RICE_game_started_on_TFE_start_date
		has_title = title:c_loulan
		NOT = { has_global_variable = RICE_lop_nur_lake_levels_chill_out }
		current_year > 450
	}

	weight_multiplier = {
		base = 1
		modifier = {
			add = 1.35
			current_date > 475.1.1
		}
		modifier = {
			add = 1.55
			current_date > 500.1.1
		}
		modifier = {
			add = 1.75
			current_date > 525.1.1
		}
	}
	
	immediate = {
		RICE_tarim_basin_lop_nur_lake_level_change_effect = yes
		set_global_variable = {
			name = RICE_lop_nur_lake_levels_chill_out
			value = yes
		}
		title:c_loulan = { #For loc.
			save_scope_as = loulan
		}
		every_ruler = {
			limit = {
				is_ai = no
				OR = {
					any_held_title = {
						tier = tier_county
						any_county_province = {
							OR = {
								geographical_region = world_steppe_tarim
								geographical_region = RICE_dunhuang_region
							}
						}
					}
					title:c_loulan = {
						squared_distance = {
							target = root.capital_province
							value <= squared_distance_medium
						}
					}

				}
			}
			trigger_event = tarim_basin.0017
		}
	}
}

# Lop Nur lake becomes less crappy but is still pretty crappy
tarim_basin.0017 = {
	type = character_event
	title = tarim_basin.0017.t
	desc = tarim_basin.0017.desc
	theme = RICE_theme_tarim_basin_landscape
	
	immediate = {

		play_music_cue = "mx_cue_sacredrite"

		RICE_tarim_basin_lop_nur_lake_level_change_effect = yes
	}

	option = {
		name = tarim_basin.0017.a
	}
}


# Lose fake China status
tarim_basin.0018 = {
	hidden = yes
	
	trigger = {
		is_target_in_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:RICE_tarim_basin_fake_china_proclaimed_flag
		}
		root.dynasty = {
			has_dynasty_modifier = RICE_tarim_basin_fake_china_dynasty
		}
		NOT = {
			root.dynasty = {
				any_dynasty_member = {
					is_landed = yes
					any_held_title = {
						tier = tier_county
						any_county_province = {
							geographical_region = RICE_former_tang_western_region	
						}
					}
				}
			}
		}
	}
	
	immediate = {
		save_scope_as = RICE_tarim_basin_fake_china_person
		dynasty = {
			remove_dynasty_modifier = RICE_tarim_basin_fake_china_dynasty
		}
		every_ruler = {
			limit = {
				is_ai = no
				OR = {
					any_held_title = {
						tier = tier_county
						any_county_province = {
							geographical_region = RICE_silk_road_region
						}
					}
					dynasty = root.dynasty
				}
			}
			trigger_event = tarim_basin.0019
		}		
	}
}


# Fake China status is lost
tarim_basin.0019 = {
	type = character_event
	title = tarim_basin.0019.t
	desc = tarim_basin.0019.desc
	theme = RICE_theme_tarim_basin_landscape

	right_portrait = {
		character = scope:RICE_tarim_basin_fake_china_person
		animation = worry
	}
	
	immediate = {

		play_music_cue = "mx_cue_negative"

		show_as_tooltip = {
			scope:RICE_tarim_basin_fake_china_person = {
				dynasty = {
					remove_dynasty_modifier = RICE_tarim_basin_fake_china_dynasty
				}				
			}
		}
	}

	option = {
		name = tarim_basin.0019.a
	}
}



######################################################################################
# 
# SILK ROAD COMMUNITY EVENTS
# 
# tarim_basin.0020-tarim_basin.0039
# 
######################################################################################


# Silk Road community selected
tarim_basin.0020 = {
	type = character_event
	title = tarim_basin.0020.t
	desc = {
		desc = tarim_basin.0020.desc.intro
		first_valid = {
			triggered_desc = {
				trigger = {
					var:RICE_silk_road_community_type = flag:east_asian
				}
				desc = tarim_basin.0020.desc.east_asian
			}	
			triggered_desc = {
				trigger = {
					var:RICE_silk_road_community_type = flag:steppe
				}
				desc = tarim_basin.0020.desc.steppe
			}	
			triggered_desc = {
				trigger = {
					var:RICE_silk_road_community_type = flag:middle_eastern
				}
				desc = tarim_basin.0020.desc.middle_eastern
			}	
			triggered_desc = {
				trigger = {
					var:RICE_silk_road_community_type = flag:himalayan
				}
				desc = tarim_basin.0020.desc.himalayan
			}	
			triggered_desc = {
				trigger = {
					var:RICE_silk_road_community_type = flag:indian
				}
				desc = tarim_basin.0020.desc.indian
			}	
		}
	}
	theme = realm
	
	right_portrait = {
		character = root
		animation = war_defender
	}
	
	option = {
		name = {
			trigger = { var:RICE_silk_road_community_type = flag:east_asian }
			text = tarim_basin.0020.option.east_asian
		}
		name = {
			trigger = { var:RICE_silk_road_community_type = flag:steppe }
			text = tarim_basin.0020.option.steppe
		}
		name = {
			trigger = { var:RICE_silk_road_community_type = flag:middle_eastern }
			text = tarim_basin.0020.option.middle_eastern
		}
		name = {
			trigger = { var:RICE_silk_road_community_type = flag:himalayan }
			text = tarim_basin.0020.option.himalayan
		}
		name = {
			trigger = { var:RICE_silk_road_community_type = flag:indian }
			text = tarim_basin.0020.option.indian
		}
		if = {
			limit = {
				var:RICE_silk_road_community_type = flag:east_asian
			}
			if = {
				limit = {
					dynasty = {
						has_dynasty_perk = RICE_tarim_basin_silk_road_legacy_3
					}
				}
				add_character_modifier = {
					modifier = RICE_tarim_basin_east_asian_contacts
					years = 20
				}
			}
			else = {
				add_character_modifier = {
					modifier = RICE_tarim_basin_east_asian_contacts
					years = 10
				}
			}
			custom_tooltip = tarim_basin.0020.tooltip.east_asian
		}
		if = {
			limit = {
				var:RICE_silk_road_community_type = flag:steppe
			}
			if = {
				limit = {
					dynasty = {
						has_dynasty_perk = RICE_tarim_basin_silk_road_legacy_3
					}
				}
				add_character_modifier = {
					modifier = RICE_tarim_basin_steppe_contacts
					years = 20
				}
			}
			else = {
				add_character_modifier = {
					modifier = RICE_tarim_basin_steppe_contacts
					years = 10
				}
			}
			custom_tooltip = tarim_basin.0020.tooltip.steppe
		}
		if = {
			limit = {
				var:RICE_silk_road_community_type = flag:middle_eastern
			}
			if = {
				limit = {
					dynasty = {
						has_dynasty_perk = RICE_tarim_basin_silk_road_legacy_3
					}
				}
				add_character_modifier = {
					modifier = RICE_tarim_basin_middle_eastern_contacts
					years = 20
				}
			}
			else = {
				add_character_modifier = {
					modifier = RICE_tarim_basin_middle_eastern_contacts
					years = 10
				}
			}
			custom_tooltip = tarim_basin.0020.tooltip.middle_eastern
		}
		if = {
			limit = {
				var:RICE_silk_road_community_type = flag:himalayan
			}
			if = {
				limit = {
					dynasty = {
						has_dynasty_perk = RICE_tarim_basin_silk_road_legacy_3
					}
				}
				add_character_modifier = {
					modifier = RICE_tarim_basin_himalayan_contacts
					years = 20
				}
			}
			else = {
				add_character_modifier = {
					modifier = RICE_tarim_basin_himalayan_contacts
					years = 10
				}
			}
			custom_tooltip = tarim_basin.0020.tooltip.himalayan
		}
		if = {
			limit = {
				var:RICE_silk_road_community_type = flag:indian
			}
			if = {
				limit = {
					dynasty = {
						has_dynasty_perk = RICE_tarim_basin_silk_road_legacy_3
					}
				}
				add_character_modifier = {
					modifier = RICE_tarim_basin_indian_contacts
					years = 20
				}
			}
			else = {
				add_character_modifier = {
					modifier = RICE_tarim_basin_indian_contacts
					years = 10
				}
			}
			custom_tooltip = tarim_basin.0020.tooltip.indian
		}
	}

	after = {
		if = {
			limit = { has_variable = RICE_silk_road_community_type }
			remove_variable = RICE_silk_road_community_type
		}
	}

}



# Gift of gold from locals
tarim_basin.0021 = {
	type = character_event
	title = tarim_basin.0021.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_east_asian_contacts
				}
				desc = tarim_basin.0021.desc.east_asian
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_steppe_contacts
				}
				desc = tarim_basin.0021.desc.steppe
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_middle_eastern_contacts
				}
				desc = tarim_basin.0021.desc.middle_eastern
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_himalayan_contacts
				}
				desc = tarim_basin.0021.desc.himalayan
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_indian_contacts
				}
				desc = tarim_basin.0021.desc.indian
			}	
		}
	}
	theme = realm
	
	right_portrait = {
		character = root
		animation = happiness
	}

	# weight_multiplier = {
	# 	base = 1
	# 	modifier = {
	# 		add = 2
	# 		has_character_modifier = RICE_tarim_basin_middle_eastern_contacts
	# 	}
	# }

	immediate = {
		random_list = {
			5 = { add_gold = 20 }
			10 = { add_gold = 40 }
			10 = { add_gold = 60 }
			10 = { add_gold = 80 }
			15 = { add_gold = 100 }
			10 = { add_gold = 120 }
			10 = { add_gold = 140 }
			10 = { add_gold = 160 }
			5 = { add_gold = 180 }
			5 = { add_gold = 200 }
		}
	}


	option = { # Ok
		name = tarim_basin.0021.a
	}
}


# Gift of promising business deals
tarim_basin.0022 = {
	type = character_event
	title = tarim_basin.0022.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_east_asian_contacts
				}
				desc = tarim_basin.0022.desc.east_asian
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_steppe_contacts
				}
				desc = tarim_basin.0022.desc.steppe
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_middle_eastern_contacts
				}
				desc = tarim_basin.0022.desc.middle_eastern
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_himalayan_contacts
				}
				desc = tarim_basin.0022.desc.himalayan
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_indian_contacts
				}
				desc = tarim_basin.0022.desc.indian
			}	
		}
	}
	theme = stewardship_wealth_focus
	
	right_portrait = {
		character = root
		animation = happiness
	}

	weight_multiplier = {
		base = 1
		modifier = {
			add = 2
			has_character_modifier = RICE_tarim_basin_middle_eastern_contacts
		}
	}

	immediate = {
		random_list = {
			55 = {
				add_character_modifier = {
					modifier = RICE_tarim_basin_gift_silk_road_deals_1
					years = 10
				}
			}
			30 = {
				modifier = {
					add = 15
					has_character_modifier = RICE_tarim_basin_middle_eastern_contacts
				}
				add_character_modifier = {
					modifier = RICE_tarim_basin_gift_silk_road_deals_2
					years = 10
				}
			}
			15 = {
				modifier = {
					add = 15
					has_character_modifier = RICE_tarim_basin_middle_eastern_contacts
				}
				add_character_modifier = {
					modifier = RICE_tarim_basin_gift_silk_road_deals_3
					years = 10
				}
			}
		}
	}


	option = { # Ok
		name = tarim_basin.0022.a
		custom_tooltip = RICE.silk_road_gift_quality.tooltip.middle_eastern
	}
}


# Gift of a great feast
tarim_basin.0023 = {
	type = character_event
	title = tarim_basin.0023.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_east_asian_contacts
				}
				desc = tarim_basin.0023.desc.east_asian
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_steppe_contacts
				}
				desc = tarim_basin.0023.desc.steppe
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_middle_eastern_contacts
				}
				desc = tarim_basin.0023.desc.middle_eastern
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_himalayan_contacts
				}
				desc = tarim_basin.0023.desc.himalayan
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_indian_contacts
				}
				desc = tarim_basin.0023.desc.indian
			}	
		}
	}
	theme = feast_activity
	
	left_portrait = {
		character = root
		animation = ecstasy
	}

	weight_multiplier = {
		base = 1
		modifier = {
			add = 2
			has_character_modifier = RICE_tarim_basin_east_asian_contacts
		}
	}

	immediate = {
		random_list = {
			10 = {
				add_prestige = 50
			}
			10 = {
				add_prestige = 75
			}
			10 = {
				modifier = {
					add = 5
					has_character_modifier = RICE_tarim_basin_east_asian_contacts
				}
				add_prestige = 100
			}
			5 = {
				modifier = {
					add = 5
					has_character_modifier = RICE_tarim_basin_east_asian_contacts
				}
				add_prestige = 125
			}
			5 = {
				modifier = {
					add = 5
					has_character_modifier = RICE_tarim_basin_east_asian_contacts
				}
				add_prestige = 150
			}
		}
	}


	option = { # Ok
		name = tarim_basin.0023.a
		custom_tooltip = RICE.silk_road_gift_quality.tooltip.east_asian
	}
}


# Gift of renown
tarim_basin.0024 = {
	type = character_event
	title = tarim_basin.0024.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_east_asian_contacts
				}
				desc = tarim_basin.0024.desc.east_asian
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_steppe_contacts
				}
				desc = tarim_basin.0024.desc.steppe
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_middle_eastern_contacts
				}
				desc = tarim_basin.0024.desc.middle_eastern
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_himalayan_contacts
				}
				desc = tarim_basin.0024.desc.himalayan
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_indian_contacts
				}
				desc = tarim_basin.0024.desc.indian
			}	
		}
	}
	theme = diplomacy_foreign_affairs_focus
	
	left_portrait = {
		character = root
		animation = personality_content
	}

	weight_multiplier = {
		base = 1
		modifier = {
			add = 2
			has_character_modifier = RICE_tarim_basin_east_asian_contacts
		}
	}

	immediate = {
		random_list = {
			10 = {
				root.dynasty = {
					add_dynasty_prestige = 50
				}				
			}
			15 = {
				root.dynasty = {
					add_dynasty_prestige = 100
				}
			}
			10 = {
				modifier = {
					add = 5
					has_character_modifier = RICE_tarim_basin_east_asian_contacts
				}
				root.dynasty = {
					add_dynasty_prestige = 150
				}
			}
			5 = {
				modifier = {
					add = 5
					has_character_modifier = RICE_tarim_basin_east_asian_contacts
				}
				root.dynasty = {
					add_dynasty_prestige = 200
				}
			}
			5 = {
				modifier = {
					add = 5
					has_character_modifier = RICE_tarim_basin_east_asian_contacts
				}
				root.dynasty = {
					add_dynasty_prestige = 250
				}
			}
		}
	}


	option = { # Ok
		name = tarim_basin.0024.a
		custom_tooltip = RICE.silk_road_gift_quality.tooltip.east_asian
	}
}


# Gift of religious artifacts aka piety
tarim_basin.0025 = {
	type = character_event
	title = tarim_basin.0025.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_east_asian_contacts
				}
				desc = tarim_basin.0025.desc.east_asian
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_steppe_contacts
				}
				desc = tarim_basin.0025.desc.steppe
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_middle_eastern_contacts
				}
				desc = tarim_basin.0025.desc.middle_eastern
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_himalayan_contacts
				}
				desc = tarim_basin.0025.desc.himalayan
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_indian_contacts
				}
				desc = tarim_basin.0025.desc.indian
			}	
		}
	}
	theme = faith
	
	right_portrait = {
		character = root
		animation = personality_forgiving
	}

	weight_multiplier = {
		base = 1
		modifier = {
			add = 2
			has_character_modifier = RICE_tarim_basin_indian_contacts
		}
	}

	immediate = {
		random_list = {
			10 = {
				add_piety = 50
			}
			10 = {
				add_piety = 75
			}
			10 = {
				modifier = {
					add = 5
					has_character_modifier = RICE_tarim_basin_indian_contacts
				}
				add_piety = 100
			}
			5 = {
				modifier = {
					add = 5
					has_character_modifier = RICE_tarim_basin_indian_contacts
				}
				add_piety = 125
			}
			5 = {
				modifier = {
					add = 5
					has_character_modifier = RICE_tarim_basin_indian_contacts
				}
				add_piety = 150
			}
		}
	}


	option = { # Ok
		name = tarim_basin.0025.a
		custom_tooltip = RICE.silk_road_gift_quality.tooltip.indian
	}
}


# Gift of a book artifact
tarim_basin.0026 = {
	type = character_event
	title = tarim_basin.0026.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_east_asian_contacts
				}
				desc = tarim_basin.0026.desc.east_asian
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_steppe_contacts
				}
				desc = tarim_basin.0026.desc.steppe
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_middle_eastern_contacts
				}
				desc = tarim_basin.0026.desc.middle_eastern
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_himalayan_contacts
				}
				desc = tarim_basin.0026.desc.himalayan
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_indian_contacts
				}
				desc = tarim_basin.0026.desc.indian
			}	
		}
	}
	theme = vassal
	
	left_portrait = {
		character = root
		animation = personality_rational
	}

	artifact = { # To display the artifact in the event-window
		target = scope:silk_road_scroll
		position = lower_center_portrait
	}

	immediate = {
		hidden_effect_new_artifact = {
			if = {
				limit = {
					has_character_modifier = RICE_tarim_basin_east_asian_contacts
				}
				create_artifact = {
					name = RICE_tarim_basin_silk_road_scroll_east_asian_name
					description = RICE_tarim_basin_silk_road_scroll_east_asian_desc
					type = miscellaneous
					visuals = RICE_scroll_east_asian					
					quality = 40
					wealth = 40
					modifier = RICE_tarim_basin_scroll_east_asian_modifier
					save_scope_as = silk_road_scroll
					history = { type = created_before_history }
				}
			}
			if = {
				limit = {
					has_character_modifier = RICE_tarim_basin_steppe_contacts
				}
				create_artifact = {
					name = RICE_tarim_basin_silk_road_scroll_steppe_name
					description = RICE_tarim_basin_silk_road_scroll_steppe_desc
					type = miscellaneous
					visuals = RICE_scroll_steppe					
					quality = 40
					wealth = 40
					modifier = RICE_tarim_basin_scroll_steppe_modifier
					save_scope_as = silk_road_scroll
					history = { type = created_before_history }
				}
			}
			if = {
				limit = {
					has_character_modifier = RICE_tarim_basin_middle_eastern_contacts
				}
				create_artifact = {
					name = RICE_tarim_basin_silk_road_scroll_middle_eastern_name
					description = RICE_tarim_basin_silk_road_scroll_middle_eastern_desc
					type = miscellaneous
					visuals = RICE_scroll_middle_eastern					
					quality = 40
					wealth = 40
					modifier = RICE_tarim_basin_scroll_middle_eastern_modifier
					save_scope_as = silk_road_scroll
					history = { type = created_before_history }
				}
			}
			if = {
				limit = {
					has_character_modifier = RICE_tarim_basin_himalayan_contacts
				}
				create_artifact = {
					name = RICE_tarim_basin_silk_road_scroll_himalayan_name
					description = RICE_tarim_basin_silk_road_scroll_himalayan_desc
					type = miscellaneous
					visuals = RICE_scroll_himalayan					
					quality = 40
					wealth = 40
					modifier = RICE_tarim_basin_scroll_himalayan_modifier
					save_scope_as = silk_road_scroll
					history = { type = created_before_history }
				}
			}
			if = {
				limit = {
					has_character_modifier = RICE_tarim_basin_indian_contacts
				}
				create_artifact = {
					name = RICE_tarim_basin_silk_road_scroll_indian_name
					description = RICE_tarim_basin_silk_road_scroll_indian_desc
					type = miscellaneous
					visuals = RICE_scroll_indian					
					quality = 40
					wealth = 40
					modifier = RICE_tarim_basin_scroll_indian_modifier
					save_scope_as = silk_road_scroll
					history = { type = created_before_history }
				}
			}
		}		
	}


	option = { # Ok
		name = tarim_basin.0026.a
		show_as_tooltip = {
			scope:silk_road_scroll = {
				set_owner = {
					target = root
				}
			}
		}
	}
}


# Gift of soldiers
tarim_basin.0027 = {
	type = character_event
	title = tarim_basin.0027.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_east_asian_contacts
				}
				desc = tarim_basin.0027.desc.east_asian
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_steppe_contacts
				}
				desc = tarim_basin.0027.desc.steppe
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_middle_eastern_contacts
				}
				desc = tarim_basin.0027.desc.middle_eastern
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_himalayan_contacts
				}
				desc = tarim_basin.0027.desc.himalayan
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_indian_contacts
				}
				desc = tarim_basin.0027.desc.indian
			}	
		}
	}
	theme = martial_strategy_focus
	
	left_portrait = {
		character = root
		animation = personality_bold
	}

	weight_multiplier = {
		base = 1
		modifier = {
			add = 2
			has_character_modifier = RICE_tarim_basin_steppe_contacts
		}
	}

	immediate = {
		random_list = {
			40 = {
				RICE_tarim_basin_gift_silk_road_troops_low_quality_spawn_effect = yes
			}
			30 = {
				modifier = {
					add = 10
					has_character_modifier = RICE_tarim_basin_steppe_contacts
				}
				RICE_tarim_basin_gift_silk_road_troops_medium_quality_spawn_effect = yes
			}
			20 = {
				modifier = {
					add = 10
					has_character_modifier = RICE_tarim_basin_steppe_contacts
				}
				RICE_tarim_basin_gift_silk_road_troops_high_quality_spawn_effect = yes
			}
			10 = {
				modifier = {
					add = 10
					has_character_modifier = RICE_tarim_basin_steppe_contacts
				}
				RICE_tarim_basin_gift_silk_road_troops_very_high_quality_spawn_effect = yes
			}
		}		
	}


	option = { # Ok
		name = tarim_basin.0027.a
		custom_tooltip = RICE.silk_road_gift_quality.tooltip.steppe
	}
}


# Gift of intel
tarim_basin.0028 = {
	type = character_event
	title = tarim_basin.0028.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_east_asian_contacts
				}
				desc = tarim_basin.0028.desc.east_asian
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_steppe_contacts
				}
				desc = tarim_basin.0028.desc.steppe
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_middle_eastern_contacts
				}
				desc = tarim_basin.0028.desc.middle_eastern
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_himalayan_contacts
				}
				desc = tarim_basin.0028.desc.himalayan
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_indian_contacts
				}
				desc = tarim_basin.0028.desc.indian
			}	
		}
	}
	theme = secret
	
	right_portrait = {
		character = root
		animation = schadenfreude
	}

	weight_multiplier = {
		base = 1
		modifier = {
			add = 2
			has_character_modifier = RICE_tarim_basin_steppe_contacts
		}
	}

	immediate = {
		random_list = {
			55 = {
				add_character_modifier = {
					modifier = RICE_tarim_basin_gift_silk_road_intel_1
					years = 10
				}
			}
			30 = {
				modifier = {
					add = 15
					has_character_modifier = RICE_tarim_basin_steppe_contacts
				}
				add_character_modifier = {
					modifier = RICE_tarim_basin_gift_silk_road_intel_2
					years = 10
				}
			}
			15 = {
				modifier = {
					add = 15
					has_character_modifier = RICE_tarim_basin_steppe_contacts
				}
				add_character_modifier = {
					modifier = RICE_tarim_basin_gift_silk_road_intel_3
					years = 10
				}
			}
		}
	}


	option = { # Ok
		name = tarim_basin.0028.a
		custom_tooltip = RICE.silk_road_gift_quality.tooltip.steppe
	}
}



# Gift of a courtier
tarim_basin.0029 = {
	type = character_event
	title = tarim_basin.0029.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_east_asian_contacts
				}
				desc = tarim_basin.0029.desc.east_asian
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_steppe_contacts
				}
				desc = tarim_basin.0029.desc.steppe
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_middle_eastern_contacts
				}
				desc = tarim_basin.0029.desc.middle_eastern
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_himalayan_contacts
				}
				desc = tarim_basin.0029.desc.himalayan
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_indian_contacts
				}
				desc = tarim_basin.0029.desc.indian
			}	
		}
	}
	theme = vassal
	
	left_portrait = root
	right_portrait = {
		character = scope:local
		animation = throne_room_bow_2
	}

	# weight_multiplier = {
	# 	base = 1
	# 	modifier = {
	# 		add = 2
	# 		has_character_modifier = RICE_tarim_basin_steppe_contacts
	# 	}
	# }

	immediate = {
		if = {
			limit = {
				has_character_modifier = RICE_tarim_basin_east_asian_contacts
			}
			create_character = {
				location = root.location
				gender_female_chance = 50
				faith = root.faith
				random_culture = {
					culture:han = { weight = { base 80 } }
					culture:khitan = {
						trigger = {
							NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
						}
						weight = { base 10 }
					}
					culture:xianbei = {
						trigger = {
							has_global_variable = RICE_game_started_on_TFE_start_date
						}
						weight = { base 30 }
					}
				}
				random_traits = yes
				#employer = root
				after_creation = {
					# Set religion randomly - Buddhist, Taoist, Manichean, or ruler's religion (if it's something else)
					random_list = {
						10 = { }
						80 = { set_character_faith = faith:mahayana }
						20 = { set_character_faith = faith:vajrayana }
						40 = { set_character_faith = faith:zhengyi }
						# 10 = {
						# 	trigger = {
						# 		NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
						# 	}
						# 	set_character_faith = faith:nestorian
						# }
					}
				}
				save_scope_as = local
			}
		}
		else_if = {
			limit = {
				has_character_modifier = RICE_tarim_basin_steppe_contacts
			}
			create_character = {
				location = root.location
				gender_female_chance = 50
				faith = root.faith
				random_culture = {
					culture:mongol = {
						trigger = {
							NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
						}
						weight = { base 10 }
					}
					culture:oirat = {
						trigger = {
							NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
						}
						weight = { base 10 }
					}
					culture:naiman = {
						trigger = {
							NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
						}
						weight = { base 10 }
					}
					culture:kerait = {
						trigger = {
							NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
						}
						weight = { base 10 }
					}
					culture:cuman = {
						trigger = {
							NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
						}
						weight = { base 10 }
					}
					culture:khazar = {
						trigger = {
							NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
						}
						weight = { base 10 }
					}
					culture:karluk = {
						trigger = {
							NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
						}
						weight = { base 10 }
					}
					culture:kipchak = {
						trigger = {
							NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
						}
						weight = { base 10 }
					}
					culture:uyghur = {
						trigger = {
							OR = {
								AND = {
									has_global_variable = RICE_game_started_on_TFE_start_date
									has_global_variable = tiele_culture_split
								}
								NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
							}
						}
						weight = { base 10 }
					}
					culture:kirghiz = {
						trigger = {
							OR = {
								AND = {
									has_global_variable = RICE_game_started_on_TFE_start_date
									has_global_variable = tiele_culture_split
								}
								NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
							}
						}
						weight = { base 10 }
					}
					culture:turkish = {
						trigger = {
							OR = {
								AND = {
									has_global_variable = RICE_game_started_on_TFE_start_date
									has_global_variable = tiele_culture_split
								}
								NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
							}
						}
						weight = { base 10 }
					}
					culture:tiele = {
						trigger = {
							has_global_variable = RICE_game_started_on_TFE_start_date
							NOT = { has_global_variable = tiele_culture_split }
						}
						weight = { base 10 }
					}
					culture:rouran = {
						trigger = {
							has_global_variable = RICE_game_started_on_TFE_start_date
						}
						weight = { base 10 }
					}
					culture:xiongnu = {
						trigger = {
							has_global_variable = RICE_game_started_on_TFE_start_date
						}
						weight = { base 10 }
					}
					culture:hephthalite = {
						trigger = {
							has_global_variable = RICE_game_started_on_TFE_start_date
						}
						weight = { base 10 }
					}
					culture:xionite = {
						trigger = {
							has_global_variable = RICE_game_started_on_TFE_start_date
						}
						weight = { base 10 }
					}
				}
				random_traits = yes
				#employer = root
				after_creation = {
					# Set religion randomly - Tengri, Buddhist, Nestorian, Manichean, Muslim or ruler's religion (if it's something else)
					random_list = {
						10 = { }
						10 = { set_character_faith = faith:mahayana }
						10 = { set_character_faith = faith:vajrayana }
						20 = { set_character_faith = faith:manichean }
						20 = { set_character_faith = faith:nestorian }
						40 = { set_character_faith = faith:tengri_pagan }
						10 = {
							trigger = {
								OR = {
									AND = {
										has_global_variable = RICE_game_started_on_TFE_start_date
										has_global_variable = islam_spawned
									}
									NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
								}
							}
							set_character_faith = faith:maturidi
						}
						10 = {
							trigger = {
								OR = {
									AND = {
										has_global_variable = RICE_game_started_on_TFE_start_date
										has_global_variable = islam_spawned
									}
									NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
								}
							}
							set_character_faith = faith:ashari
						}
					}
				}
				save_scope_as = local
			}
		}
		else_if = {
			limit = {
				has_character_modifier = RICE_tarim_basin_middle_eastern_contacts
			}
			create_character = {
				location = root.location
				gender_female_chance = 50
				faith = root.faith
				random_culture = {
					culture:persian = {
						weight = { base 20 }
					}
					culture:tajik = {
						weight = { base 10 }
					}
					culture:sogdian = {
						trigger = {
							game_start_date < 1000.1.1
						}
						weight = { base 20 }
					}
					culture:tocharian = {
						trigger = {
							game_start_date < 1000.1.1
						}
						weight = { base 10 }
					}
					culture:saka = {
						trigger = {
							game_start_date < 1000.1.1
						}
						weight = { base 10 }
					}
					culture:bedouin = {
						weight = { base 10 }
					}
					culture:egyptian = {
						trigger = {
							NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
						}
						weight = { base 10 }
					}
					culture:levantine = {
						trigger = {
							NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
						}
						weight = { base 20 }
					}
					culture:yemeni = {
						trigger = {
							NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
						}
						weight = { base 20 }
					}
					culture:himyarite = {
						trigger = {
							has_global_variable = RICE_game_started_on_TFE_start_date
						}
						weight = { base 20 }
					}
					culture:aramean = {
						trigger = {
							has_global_variable = RICE_game_started_on_TFE_start_date
						}
						weight = { base 10 }
					}
					culture:bactrian = {
						trigger = {
							has_global_variable = RICE_game_started_on_TFE_start_date
						}
						weight = { base 10 }
					}
				}
				random_traits = yes
				#employer = root
				after_creation = {
					# Set religion randomly - Buddhist, Nestorian, Manichean, Zoroastrian, Muslim or ruler's religion (if it's something else)
					random_list = {
						10 = { }
						40 = {
							trigger = {
								OR = {
									culture = { has_cultural_pillar = heritage_iranian }
									culture = { has_cultural_pillar = heritage_tocharian }
								}
							}
							set_character_faith = faith:mahayana
						}
						20 = {
							trigger = {
								culture = { has_cultural_pillar = heritage_iranian }
							}
							set_character_faith = faith:manichean
						}
						40 = {
							trigger = {
								culture = { has_cultural_pillar = heritage_iranian }
							}
							set_character_faith = faith:mazdayasna
						}
						40 = {
							trigger = {
								NOT = { culture = culture:tocharian }
							}
							set_character_faith = faith:nestorian
						}
						40 = {
							trigger = {
								NOT = { culture = culture:tocharian }
								NOT = { culture = culture:saka }
								OR = {
									AND = {
										has_global_variable = RICE_game_started_on_TFE_start_date
										has_global_variable = islam_spawned
									}
									NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
								}
							}
							set_character_faith = faith:ashari
						}
						20 = {
							trigger = {
								NOT = { culture = culture:tocharian }
								OR = {
									AND = {
										has_global_variable = RICE_game_started_on_TFE_start_date
										has_global_variable = islam_spawned
									}
									NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
								}
							}
							set_character_faith = faith:ismaili
						}
						10 = {
							trigger = {
								culture = { has_cultural_pillar = heritage_arabic }
								has_global_variable = RICE_game_started_on_TFE_start_date
								NOT = { has_global_variable = islam_spawned }
							}
							set_character_faith = faith:arabic_pagan
						}
						10 = {
							trigger = {
								culture = { has_cultural_pillar = heritage_arabic }
								has_global_variable = RICE_game_started_on_TFE_start_date
								NOT = { has_global_variable = islam_spawned }
							}
							set_character_faith = faith:south_arabian_pagan
						}
					}
				}
				save_scope_as = local
			}
		}
		else_if = {
			limit = {
				has_character_modifier = RICE_tarim_basin_himalayan_contacts
			}
			create_character = {
				location = root.location
				gender_female_chance = 50
				faith = root.faith
				random_culture = {
					culture:zhangzhung = {
						trigger = {
							game_start_date < 1000.1.1
						}
						weight = { base 10 }
					}
					culture:bodpa = {
						weight = { base 30 }
					}
					culture:qiang = {
						weight = { base 10 }
					}
					culture:tangut = {
						weight = { base 10 }
					}
					culture:tuyuhun = {
						weight = { base 10 }
					}
				}
				random_traits = yes
				#employer = root
				after_creation = {
					# Set religion randomly - or ruler's religion (if it's something else)
					random_list = {
						10 = { }
						50 = {
							set_character_faith = faith:lamaism
						}
						20 = {
							trigger = {
								culture = { has_cultural_pillar = heritage_tibetan }
							}
							set_character_faith = faith:bon
						}
						20 = {
							trigger = {
								culture = culture:qiang
							}
							set_character_faith = faith:rrmeaism
						}
						20 = {
							trigger = {
								culture = culture:tangut
							}
							set_character_faith = faith:melieism
						}
						20 = {
							trigger = {
								culture = culture:tuyuhun
							}
							set_character_faith = faith:tengri_pagan
						}
					}
				}
				save_scope_as = local
			}
		}
		else_if = {
			limit = {
				has_character_modifier = RICE_tarim_basin_indian_contacts
			}
			create_character = {
				location = root.location
				gender_female_chance = 50
				faith = root.faith
				random_culture = {
					culture:gujarati = { weight = { base 10 } }
					culture:sindhi = { weight = { base 10 } }
					culture:marathi = { weight = { base 10 } }
					culture:tamil = { weight = { base 10 } }
					culture:kannada = { weight = { base 10 } }
					culture:sinhala = { weight = { base 10 } }
				}
				random_traits = yes
				#employer = root
				after_creation = {
					# Set religion randomly - Hindu, Buddhist, Nestorian, Muslim, or Socotran ruler's religion (if it's something else)
					random_list = {
						10 = { }
						25 = { set_character_faith = faith:vaishnavism }
						25 = { set_character_faith = faith:advaitism }
						25 = { set_character_faith = faith:shaivism }
						25 = { set_character_faith = faith:srikula_shaktism }
						25 = { set_character_faith = faith:kalikula_shaktism }
						25 = { set_character_faith = faith:smartism }
						25 = { set_character_faith = faith:krishnaism }
						10 = { set_character_faith = faith:theravada }
						10 = { set_character_faith = faith:vajrayana }
						10 = { set_character_faith = faith:mahayana }
						10 = {
							trigger = {
								NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
							}
							set_character_faith = faith:nestorian
						}
						10 = {
							trigger = {
								NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
							}
							set_character_faith = faith:maturidi
						}
						10 = {
							trigger = {
								NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
							}
							set_character_faith = faith:ashari
						}
					}
				}
				save_scope_as = local
			}
		}

	}


	option = { # Ok
		name = tarim_basin.0029.a
		pay_short_term_gold = {
			target = scope:local
			gold = minor_gold_value
		}
		add_courtier = scope:local
	}

	option = { # Ok
		name = tarim_basin.0029.b
	}
}


# Gift of Herbs and Medicines
tarim_basin.0030 = {
	type = character_event
	title = tarim_basin.0030.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_east_asian_contacts
				}
				desc = tarim_basin.0030.desc.east_asian
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_steppe_contacts
				}
				desc = tarim_basin.0030.desc.steppe
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_middle_eastern_contacts
				}
				desc = tarim_basin.0030.desc.middle_eastern
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_himalayan_contacts
				}
				desc = tarim_basin.0030.desc.himalayan
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_indian_contacts
				}
				desc = tarim_basin.0030.desc.indian
			}	
		}
	}
	theme = medicine
	override_background = { event_background = throne_room }
	
	left_portrait = {
		character = root
		animation = happiness
	}

	weight_multiplier = {
		base = 1
		modifier = {
			add = 2
			has_character_modifier = RICE_tarim_basin_himalayan_contacts
		}
	}

	immediate = {
		random_list = {
			55 = {
				add_character_modifier = {
					modifier = RICE_tarim_basin_gift_silk_road_medicine_1
					years = 10
				}
			}
			30 = {
				modifier = {
					add = 15
					has_character_modifier = RICE_tarim_basin_himalayan_contacts
				}
				add_character_modifier = {
					modifier = RICE_tarim_basin_gift_silk_road_medicine_2
					years = 10
				}
			}
			15 = {
				modifier = {
					add = 15
					has_character_modifier = RICE_tarim_basin_himalayan_contacts
				}
				add_character_modifier = {
					modifier = RICE_tarim_basin_gift_silk_road_medicine_3
					years = 10
				}
			}
		}
	}


	option = { # Ok
		name = tarim_basin.0030.a
		custom_tooltip = RICE.silk_road_gift_quality.tooltip.himalayan
	}
}


# Gift of infrastructure
tarim_basin.0031 = {
	type = character_event
	title = tarim_basin.0031.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_east_asian_contacts
				}
				desc = tarim_basin.0031.desc.east_asian
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_steppe_contacts
				}
				desc = tarim_basin.0031.desc.steppe
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_middle_eastern_contacts
				}
				desc = tarim_basin.0031.desc.middle_eastern
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_himalayan_contacts
				}
				desc = tarim_basin.0031.desc.himalayan
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_indian_contacts
				}
				desc = tarim_basin.0031.desc.indian
			}	
		}
	}
	theme = realm
	
	left_portrait = {
		character = root
		animation = personality_content
	}

	weight_multiplier = {
		base = 1
		modifier = {
			add = 2
			has_character_modifier = RICE_tarim_basin_middle_eastern_contacts
		}
	}

	immediate = {
		random_list = {
			55 = {
				capital_county = {
					add_county_modifier = {
						modifier = RICE_tarim_basin_gift_silk_road_infrastructure_1
						years = 10
					}			
				} 
			}
			30 = {
				modifier = {
					add = 15
					has_character_modifier = RICE_tarim_basin_middle_eastern_contacts
				}
				capital_county = {
					add_county_modifier = {
						modifier = RICE_tarim_basin_gift_silk_road_infrastructure_2
						years = 10
					}			
				} 
			}
			15 = {
				modifier = {
					add = 15
					has_character_modifier = RICE_tarim_basin_middle_eastern_contacts
				}
				capital_county = {
					add_county_modifier = {
						modifier = RICE_tarim_basin_gift_silk_road_infrastructure_3
						years = 10
					}			
				} 
			}
		}
	}


	option = { # Ok
		name = tarim_basin.0031.a
		custom_tooltip = RICE.silk_road_gift_quality.tooltip.middle_eastern
	}
}


# Gift of bodyguards
tarim_basin.0032 = {
	type = character_event
	title = tarim_basin.0032.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_east_asian_contacts
				}
				desc = tarim_basin.0032.desc.east_asian
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_steppe_contacts
				}
				desc = tarim_basin.0032.desc.steppe
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_middle_eastern_contacts
				}
				desc = tarim_basin.0032.desc.middle_eastern
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_himalayan_contacts
				}
				desc = tarim_basin.0032.desc.himalayan
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_indian_contacts
				}
				desc = tarim_basin.0032.desc.indian
			}	
		}
	}
	theme = martial_strategy_focus
	
	right_portrait = {
		character = root
		animation = personality_bold
	}

	weight_multiplier = {
		base = 1
		modifier = {
			add = 2
			has_character_modifier = RICE_tarim_basin_himalayan_contacts
		}
	}

	immediate = {
		random_list = {
			55 = {
				add_character_modifier = {
					modifier = RICE_tarim_basin_gift_silk_road_bodyguards_1
					years = 10
				}			
			}
			30 = {
				modifier = {
					add = 15
					has_character_modifier = RICE_tarim_basin_himalayan_contacts
				}
				add_character_modifier = {
					modifier = RICE_tarim_basin_gift_silk_road_bodyguards_2
					years = 10
				}			
			}
			15 = {
				modifier = {
					add = 15
					has_character_modifier = RICE_tarim_basin_himalayan_contacts
				}
				add_character_modifier = {
					modifier = RICE_tarim_basin_gift_silk_road_bodyguards_3
					years = 10
				}			
			}
		}
	}


	option = { # Ok
		name = tarim_basin.0032.a
		custom_tooltip = RICE.silk_road_gift_quality.tooltip.himalayan
	}
}


# Gift of Ideas
tarim_basin.0033 = {
	type = character_event
	title = tarim_basin.0033.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_east_asian_contacts
				}
				desc = tarim_basin.0033.desc.east_asian
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_steppe_contacts
				}
				desc = tarim_basin.0033.desc.steppe
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_middle_eastern_contacts
				}
				desc = tarim_basin.0033.desc.middle_eastern
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_himalayan_contacts
				}
				desc = tarim_basin.0033.desc.himalayan
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_indian_contacts
				}
				desc = tarim_basin.0033.desc.indian
			}	
		}
	}
	theme = realm
	override_icon = { reference = "gfx/interface/icons/event_types/type_learning.dds" }
	
	right_portrait = {
		character = root
		animation = personality_rational
	}

	weight_multiplier = {
		base = 1
		modifier = {
			add = 2
			has_character_modifier = RICE_tarim_basin_indian_contacts
		}
	}

	immediate = {
		random_list = {
			55 = {
				add_character_modifier = {
					modifier = RICE_tarim_basin_gift_silk_road_ideas_1
					years = 10
				}			
			}
			30 = {
				modifier = {
					add = 15
					has_character_modifier = RICE_tarim_basin_indian_contacts
				}
				add_character_modifier = {
					modifier = RICE_tarim_basin_gift_silk_road_ideas_2
					years = 10
				}			
			}
			15 = {
				modifier = {
					add = 15
					has_character_modifier = RICE_tarim_basin_indian_contacts
				}
				add_character_modifier = {
					modifier = RICE_tarim_basin_gift_silk_road_ideas_3
					years = 10
				}			
			}
		}
	}


	option = { # Ok
		name = tarim_basin.0033.a
		custom_tooltip = RICE.silk_road_gift_quality.tooltip.indian
	}
}

######################################################################################
# 
# SILK ROAD ENTERTAINER MISCELLANEOUS EVENTS
# 
# tarim_basin.0040-tarim_basin.0049
# 
######################################################################################


# Singer seems to catch everyone's attention (King version)
tarim_basin.0040 = {
	type = court_event
	title = tarim_basin.0040.t
	desc = tarim_basin.0040.desc

	theme = court
	court_scene = {
		button_position_character = scope:entertainer
		roles = {
			scope:praiser = {
				group = event_group
				animation = flirtation
			}
			scope:recipient = {
				group = event_group
				animation = personality_rational
			}
			scope:entertainer = {
				group = event_group
				animation = throne_room_kneel_1
			}
		}
	}

	trigger = {
		has_royal_court = yes
		any_courtier_or_guest = {
			is_available_ai_adult = yes
		}
	}

	immediate = {
		random_courtier_or_guest = {
			limit = {
				is_available_ai_adult = yes
			}
			save_scope_as = praiser
		}

		if = {
			limit = {
				has_character_modifier = RICE_tarim_basin_kuchean_entertainers
			}
			create_character = {
				location = root.location
				template = RICE_silk_road_basic_entertainer_template
				save_scope_as = entertainer
				culture = scope:kucha_county.culture
				faith = scope:kucha_county.faith
			}
		}
		else = {
			create_character = {
				location = root.capital_province
				template = RICE_silk_road_basic_entertainer_template
				save_scope_as = entertainer
				random_culture = {
					culture:han = { weight = { base 10 } }
					culture:persian = { weight = { base 10 } }
					culture:bedouin = { weight = { base 10 } }
					culture:greek = { weight = { base 10 } }
					culture:punjabi = { weight = { base 10 } }
					culture:hindustani = { weight = { base 10 } }
					culture:bodpa = { weight = { base 10 } }
					culture:armenian = { weight = { base 10 } }
					culture:georgian = { weight = { base 10 } }
					culture:sogdian = {
						trigger = {
							game_start_date < 1000.1.1
						}
						weight = { base 50 }
					}
					culture:tocharian = {
						trigger = {
							game_start_date < 1000.1.1
						}
						weight = { base 50 }
					}
					culture:saka = {
						trigger = {
							game_start_date < 1000.1.1
						}
						weight = { base 20 }
					}
					culture:uyghur = {
						trigger = {
							OR = {
								AND = {
									has_global_variable = RICE_game_started_on_TFE_start_date
									has_global_variable = tiele_culture_split
								}
								NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
							}
						}
						weight = { base 20 }
					}
					culture:turkish = {
						trigger = {
							OR = {
								AND = {
									has_global_variable = RICE_game_started_on_TFE_start_date
									has_global_variable = tiele_culture_split
								}
								NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
							}
						}
						weight = { base 10 }
					}
					culture:tiele = {
						trigger = {
							has_global_variable = RICE_game_started_on_TFE_start_date
							NOT = { has_global_variable = tiele_culture_split }
						}
						weight = { base 10 }
					}
					culture:hephthalite = {
						trigger = {
							has_global_variable = RICE_game_started_on_TFE_start_date
						}
						weight = { base 10 }
					}
					culture:xionite = {
						trigger = {
							has_global_variable = RICE_game_started_on_TFE_start_date
						}
						weight = { base 10 }
					}
					culture:bactrian = {
						trigger = {
							has_global_variable = RICE_game_started_on_TFE_start_date
						}
						weight = { base 10 }
					}
					culture:pactyan = {
						trigger = {
							has_global_variable = RICE_game_started_on_TFE_start_date
						}
						weight = { base 10 }
					}
					culture:afghan = {
						trigger = {
							NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
						}
						weight = { base 10 }
					}
					culture:himyarite = {
						trigger = {
							has_global_variable = RICE_game_started_on_TFE_start_date
						}
						weight = { base 10 }
					}
					culture:levantine = {
						trigger = {
							NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
						}
						weight = { base 10 }
					}
					culture:rouran = {
						trigger = {
							has_global_variable = RICE_game_started_on_TFE_start_date
						}
						weight = { base 10 }
					}
					culture:mongol = {
						trigger = {
							NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
						}
						weight = { base 10 }
					}
					culture:ostrogothic = {
						trigger = {
							has_global_variable = RICE_game_started_on_TFE_start_date
						}
						weight = { base 10 }
					}
					culture:lithuanian = {
						trigger = {
							NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
						}
						weight = { base 10 }
					}
					culture:norse = {
						trigger = {
							NOT = { has_global_variable = norse_culture_split }
						}
						weight = { base 10 }
					}
					culture:swedish = {
						trigger = {
							has_global_variable = norse_culture_split
						}
						weight = { base 10 }
					}
					culture:antean = {
						trigger = {
							has_global_variable = RICE_game_started_on_TFE_start_date
							NOT = { has_global_variable = antean_culture_split }
						}
						weight = { base 10 }
					}
					culture:volhynian = {
						trigger = {
							has_global_variable = RICE_game_started_on_TFE_start_date
							has_global_variable = antean_culture_split
						}
						weight = { base 10 }
					}
					culture:russian = {
						trigger = {
							#OR = {
							#	AND = {
							#		has_global_variable = RICE_game_started_on_TFE_start_date
							#		has_global_variable = venedian_culture_split
							#	}
								NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
							#}
						}
						weight = { base 10 }
					}
				}
				faith = root.faith
			}
		}

	}

	option = { # Ok
		name = tarim_basin.0040.a
		trigger = {
			OR = {
				is_ai = no
				gold >= 50
			}
		}
		remove_short_term_gold = 50
		add_courtier = scope:entertainer
		if = {
			limit = {
				can_add_hook = {
					target = scope:entertainer
					type = loyalty_hook
				}
			}
			add_hook = {
				target = scope:entertainer
				type = loyalty_hook
			}
		}
		scope:praiser = {
			add_opinion = {
				target = root
				modifier = RICE_tarim_basin_similar_opinions_entertainers
			}		
		}
		scope:entertainer = {
			add_opinion = {
				target = root
				modifier = RICE_tarim_basin_honored_entertainer
			}
			set_relation_friend = scope:praiser		
		}	
	}

	option = { # No need
		name = tarim_basin.0040.b
		hidden_effect = {
			scope:entertainer = {
				death = {
					death_reason = death_vanished
				}
			}
		}	
	}
}




# Courtier has a crush on a beautiful entertainer (King version)
tarim_basin.0042 = {
	type = court_event
	title = tarim_basin.0042.t
	desc = {
		desc = tarim_basin.0042.desc.intro
		first_valid = {
			triggered_desc = {
				trigger = {
					var:RICE_entertainer_romance_type = flag:mutual
				}
				desc = tarim_basin.0042.desc.mutual
			}		
			triggered_desc = {
				trigger = {
					var:RICE_entertainer_romance_type = flag:one_sided
				}
				desc = tarim_basin.0042.desc.one_sided
			}		
			triggered_desc = {
				trigger = {
					var:RICE_entertainer_romance_type = flag:neutral
				}
				desc = tarim_basin.0042.desc.neutral
			}		
		}
	}

	theme = court
	court_scene = {
		button_position_character = scope:entertainer
		roles = {
			scope:lover = {
				group = petitioners_group
				animation = beg
			}
			# scope:recipient = {
			# 	group = event_group
			# 	animation = personality_rational
			# }
			scope:crush = {
				group = petitioners_group
				animation = throne_room_kneel_1
			}
		}
	}

	trigger = {
		has_royal_court = yes
		any_courtier = {
			is_available_ai_adult = yes
			is_female = no
			NOT = { dynasty = root.dynasty }
			is_married = no
			NOR = {
				has_sexuality = asexual
				has_sexuality = homosexual
				has_trait = celibate
				has_trait = eunuch
				has_trait = devoted
			}
		}
	}

	immediate = {

		random_courtier_or_guest = {
			limit = {
				is_available_ai_adult = yes
				is_female = no
				NOT = { dynasty = root.dynasty }
				is_married = no
				NOR = {
					has_sexuality = asexual
					has_sexuality = homosexual
					has_trait = celibate
					has_trait = eunuch
					has_trait = devoted
				}
			}
			save_scope_as = lover
		}

		if = {
			limit = {
				has_character_modifier = RICE_tarim_basin_kuchean_entertainers
			}
			create_character = {
				location = root.location
				template = RICE_silk_road_female_entertainer_template
				save_scope_as = crush
				culture = scope:kucha_county.culture
				faith = scope:kucha_county.faith
			}
		}
		else = {
			create_character = {
				location = root.capital_province
				template = RICE_silk_road_female_entertainer_template
				save_scope_as = crush
				random_culture = {
					culture:han = { weight = { base 10 } }
					culture:persian = { weight = { base 10 } }
					culture:bedouin = { weight = { base 10 } }
					culture:greek = { weight = { base 10 } }
					culture:punjabi = { weight = { base 10 } }
					culture:hindustani = { weight = { base 10 } }
					culture:bodpa = { weight = { base 10 } }
					culture:armenian = { weight = { base 10 } }
					culture:georgian = { weight = { base 10 } }
					culture:sogdian = {
						trigger = {
							game_start_date < 1000.1.1
						}
						weight = { base 50 }
					}
					culture:tocharian = {
						trigger = {
							game_start_date < 1000.1.1
						}
						weight = { base 50 }
					}
					culture:saka = {
						trigger = {
							game_start_date < 1000.1.1
						}
						weight = { base 20 }
					}
					culture:uyghur = {
						trigger = {
							OR = {
								AND = {
									has_global_variable = RICE_game_started_on_TFE_start_date
									has_global_variable = tiele_culture_split
								}
								NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
							}
						}
						weight = { base 20 }
					}
					culture:turkish = {
						trigger = {
							OR = {
								AND = {
									has_global_variable = RICE_game_started_on_TFE_start_date
									has_global_variable = tiele_culture_split
								}
								NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
							}
						}
						weight = { base 10 }
					}
					culture:tiele = {
						trigger = {
							has_global_variable = RICE_game_started_on_TFE_start_date
							NOT = { has_global_variable = tiele_culture_split }
						}
						weight = { base 10 }
					}
					culture:hephthalite = {
						trigger = {
							has_global_variable = RICE_game_started_on_TFE_start_date
						}
						weight = { base 10 }
					}
					culture:xionite = {
						trigger = {
							has_global_variable = RICE_game_started_on_TFE_start_date
						}
						weight = { base 10 }
					}					
					culture:bactrian = {
						trigger = {
							has_global_variable = RICE_game_started_on_TFE_start_date
						}
						weight = { base 10 }
					}
					culture:pactyan = {
						trigger = {
							has_global_variable = RICE_game_started_on_TFE_start_date
						}
						weight = { base 10 }
					}
					culture:afghan = {
						trigger = {
							NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
						}
						weight = { base 10 }
					}
					culture:himyarite = {
						trigger = {
							has_global_variable = RICE_game_started_on_TFE_start_date
						}
						weight = { base 10 }
					}
					culture:levantine = {
						trigger = {
							NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
						}
						weight = { base 10 }
					}
					culture:rouran = {
						trigger = {
							has_global_variable = RICE_game_started_on_TFE_start_date
						}
						weight = { base 10 }
					}
					culture:mongol = {
						trigger = {
							NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
						}
						weight = { base 10 }
					}
					culture:ostrogothic = {
						trigger = {
							has_global_variable = RICE_game_started_on_TFE_start_date
						}
						weight = { base 10 }
					}
					culture:lithuanian = {
						trigger = {
							NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
						}
						weight = { base 10 }
					}
					culture:norse = {
						trigger = {
							NOT = { has_global_variable = norse_culture_split }
						}
						weight = { base 10 }
					}
					culture:swedish = {
						trigger = {
							has_global_variable = norse_culture_split
						}
						weight = { base 10 }
					}
					culture:antean = {
						trigger = {
							has_global_variable = RICE_game_started_on_TFE_start_date
							NOT = { has_global_variable = antean_culture_split }
						}
						weight = { base 10 }
					}
					culture:volhynian = {
						trigger = {
							has_global_variable = RICE_game_started_on_TFE_start_date
							has_global_variable = antean_culture_split
						}
						weight = { base 10 }
					}
					culture:russian = {
						trigger = {
							#OR = {
							#	AND = {
							#		has_global_variable = RICE_game_started_on_TFE_start_date
							#		has_global_variable = venedian_culture_split
							#	}
								NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
							#}
						}
						weight = { base 10 }
					}
				}
				faith = root.faith
			}
		}

		# Determine the girl's opinion of him
		random_list = {
			# The girl doesn't seem to have an opinion either way
			50 = {
				set_variable = {
					name = RICE_entertainer_romance_type
					value = flag:neutral					
				}
			}
			# The girl seems to like the guy... or at least the comforts he could give her
			50 = {
				# She needs to be interested in him
				trigger = {
					scope:crush = { is_attracted_to_gender_of = scope:lover }
				}
				# Opinion
				opinion_modifier = {
					who = scope:crush
					opinion_target = scope:lover
					multiplier = 1.5
				}
				# Trait compatibility
				compatibility_modifier = {
					who = scope:crush
					compatibility_target = scope:lover
					multiplier = 1.1
				}
				# He's good looking
				modifier = {
					add = 5
					scope:lover = {
						has_trait = beauty_good_1
					}
				}
				modifier = {
					add = 10
					scope:lover = {
						has_trait = beauty_good_2
					}
				}
				modifier = {
					add = 15
					scope:lover = {
						has_trait = beauty_good_3
					}
				}
				# The girl is a gold digger or power hungry
				modifier = {
					add = 15
					scope:crush = {
						OR = {
							ai_greed >= medium_positive_ai_value
							has_trait = greedy
							has_trait = ambitious
						}
					}
					scope:lover = {
						is_landed = yes
					}
				}
				# The guy has a reputation for being nice
				modifier = {
					add = 10
					scope:lover = {
						has_trait_benevolent_trigger = yes
					}
				}
				# The guy is good at charming women
				modifier = {
					add = 10
					scope:lover = {
						OR = {
							has_trait = gallant
							has_trait = seducer
							has_trait = gregarious
						}
					}
				}
				set_variable = {
					name = RICE_entertainer_romance_type
					value = flag:mutual					
				}
			}
			# The girl does not like the guy for various reasons
			50 = {
				opinion_modifier = {
					who = scope:crush
					compatibility_target = scope:lover
					multiplier = -0.7
				}
				# Trait compatibility
				compatibility_modifier = {
					who = scope:crush
					compatibility_target = scope:lover
					multiplier = -0.5
				}
				# He's ugly
				modifier = {
					add = 5
					scope:lover = {
						has_trait = beauty_bad_1
					}
				}
				modifier = {
					add = 10
					scope:lover = {
						has_trait = beauty_bad_2
					}
				}
				modifier = {
					add = 15
					scope:lover = {
						has_trait = beauty_bad_3
					}
				}
				# The girl looks down on the guy
				modifier = {
					add = 5
					scope:crush = {
						has_trait = arrogant
					}
				}
				# The girl is worried
				modifier = {
					add = 5
					scope:crush = {
						has_trait = paranoid
					}
				}
				# The guy has a reputation for being an asshole
				modifier = {
					add = 25
					scope:lover = {
						OR = {
							has_trait = sadistic
							has_trait = wrathful
							has_trait = arrogant
							has_trait = callous
							has_trait = vengeful
						}
					}
				}
				set_variable = {
					name = RICE_entertainer_romance_type
					value = flag:one_sided					
				}
			}
		}


	}

	option = { # Allow them to marry
		name = tarim_basin.0042.a
		RICE_tarim_basin_marry_entertainer_crush_effect = yes
		scope:lover = {
			add_opinion = {
				target = scope:recipient
				modifier = RICE_tarim_basin_allowed_me_marry
			}
			random = {
				chance = 70
				progress_towards_friend_effect = {
					CHARACTER = scope:recipient
					OPINION = no
				}
			}
		}
		if = {
			limit = {
				var:RICE_entertainer_romance_type = flag:mutual
			}
			scope:crush = {
				add_opinion = {
					target = scope:recipient
					modifier = RICE_tarim_basin_allowed_me_marry
				}
				random = {
					chance = 20
					progress_towards_friend_effect = {
						CHARACTER = scope:recipient
						OPINION = no
					}
				}	
			}
		}
		if = {
			limit = {
				OR = {
					has_trait = compassionate
					has_trait = generous
				}
			}
			stress_impact = {
				compassionate = minor_stress_impact_loss
				generous = miniscule_stress_impact_loss
			}
		}
		else = {
			stress_impact = {
				lustful = minor_stress_impact_gain
				sadistic = minor_stress_impact_gain
				callous = minor_stress_impact_gain
			}
		}
	}

	option = { # Allow them to marry... but get a hook on the guy
		name = tarim_basin.0042.b
		add_hook = {
			target = scope:lover
			type = favor_hook
		}
		RICE_tarim_basin_marry_entertainer_crush_effect = yes	
	}

	option = { # I'll take her for myself!
		name = tarim_basin.0042.c
		trigger = {
			scope:crush = {
				OR = {
					can_become_concubine_of_character_trigger = { CHARACTER = scope:recipient }
					can_marry_character_trigger = { CHARACTER = scope:recipient }
				}
			}
		}
		if = {
			limit = {
				scope:crush = {
					can_become_concubine_of_character_trigger = { CHARACTER = scope:recipient }
				}
				OR = {
					culture = { has_cultural_tradition = tradition_concubines }
					faith = { has_doctrine = doctrine_concubines }
				}
			}
			scope:recipient = {
				make_concubine = scope:crush
			}
		}
		else = {
			marry = scope:crush
		}
		if = {
			limit = {
				NOT = { var:RICE_entertainer_romance_type = flag:one_sided }
				OR = {
					has_trait = compassionate
					has_trait = just
					has_trait = chaste
					has_trait = generous
				}
			}
			stress_impact = {
				compassionate = medium_stress_impact_gain
				chaste = medium_stress_impact_gain
				generous = minor_stress_impact_gain
				just = minor_stress_impact_gain
			}
		}
		else = {
			stress_impact = {
				lustful = medium_stress_impact_loss
				sadistic = medium_stress_impact_loss
				callous = minor_stress_impact_loss
				arbitrary = minor_stress_impact_loss
			}
		}
		# The girl is interested in him and doesn't like that you took her for yourself
		if = {
			limit = {
				var:RICE_entertainer_romance_type = flag:mutual
			}
			scope:crush = {
				add_opinion = {
					target = scope:recipient
					modifier = RICE_tarim_basin_took_me_as_a_plaything_likes_guy
				}
				random = {
					chance = 40
					progress_towards_rival_effect = {
						CHARACTER = scope:recipient
						OPINION = no
					}
				}
			}
		}
		# The girl is relieved if she doesn't like him and she has a decent opinion of you
		else_if = {
			limit = {
				var:RICE_entertainer_romance_type = flag:one_sided
				scope:crush = {
					opinion = {
						target = scope:recipient
						value > 25
					}
				}
			}
			scope:crush = {
				add_opinion = {
					target = scope:recipient
					modifier = RICE_tarim_basin_protected_me_from_creep
				}
			}
		}
		# The girl doesn't want to be your plaything
		else_if = {
			trigger = {
				NOT = { var:RICE_entertainer_romance_type = flag:neutral } # She doesn't care
				scope:crush = {
					opinion = {
						target = scope:recipient
						value < 0
					}
				}
				OR = {
					has_sexuality = asexual
					has_sexuality = homosexual
					has_trait = celibate
				}
			}
			scope:crush = {
				add_opinion = {
					target = scope:recipient
					modifier = RICE_tarim_basin_took_me_as_a_plaything_didnt_like_guy
				}
			}
		}
		# He hates your guts
		scope:lover = {
			add_opinion = {
				target = scope:recipient
				modifier = RICE_tarim_basin_took_away_my_beloved
			}
			if = {
				limit = {
					scope:lover = {
						OR = {
							has_trait = vengeful
							has_trait = wrathful
							has_trait = arbitrary
							scope:lover = {
								opinion = {
									target = scope:recipient
									value < -40
								}
							}
						}
					}
				}
				set_relation_rival = scope:recipient
			}
			else = {
				progress_towards_rival_effect = {
					CHARACTER = scope:recipient
					OPINION = no
				}
			}
		}
	}

	option = { # No, I do not give permission
		name = tarim_basin.0042.d
		trigger = {
			diplomacy < decent_skill_rating
		}
		scope:lover = {
			add_opinion = {
				target = scope:recipient
				modifier = RICE_tarim_basin_prevented_me_from_marrying_beloved
			}
			random = {
				chance = 50				
				progress_towards_rival_effect = {
					CHARACTER = scope:recipient
					OPINION = no
				}
			}
		}
		hidden_effect = {
			scope:crush = {
				death = {
					death_reason = death_vanished
				}
			}
		}
		stress_impact = {
			compassionate = minor_stress_impact_gain
			generous = minor_stress_impact_gain
		}
	}

	option = { # Let the girl choose for herself!
		name = tarim_basin.0042.e
		hidden_effect = {
			scope:crush = {
				death = {
					death_reason = death_vanished
				}
			}
		}
		stress_impact = {
			arrogant = minor_stress_impact_gain
			callous = minor_stress_impact_gain
			sadistic = minor_stress_impact_gain
		}
	}

	option = { # Be reasonable
		name = tarim_basin.0042.f
		trigger = {
			diplomacy >= decent_skill_rating
		}
		skill = diplomacy
		hidden_effect = {
			scope:crush = {
				death = {
					death_reason = death_vanished
				}
			}
		}
	}

	after = {
		if = {
			limit = { has_variable = RICE_entertainer_romance_type }
			remove_variable = RICE_entertainer_romance_type
		}
	}

}





# Entertainer has neutral opinion
# Entertainer appears to be eyeing the man with hope - does she like him back because he's been kind to her?
# Entertainer appears to look anxious and you know she finds hiim creepy



######################################################################################
# 
# DUNHUANG EVENTS
# 
# tarim_basin.0050-tarim_basin.0099
# 
######################################################################################


# Choose who to play as Dunhuang and who becomes the hostage - Part 2
tarim_basin.0050 = {
	type = character_event
	title = tarim_basin.0050.t
	desc = tarim_basin.0050.desc
	theme = RICE_theme_dunhuang_villa
	
	left_portrait = {
		character = scope:yichao
		animation = stress
	}
	right_portrait = {
		character = scope:yitan
		animation = personality_zealous
	}
	
	immediate = {
		character:304187 = {
			save_scope_as = yitan
		}
		character:206811 = {
			save_scope_as = yichao
		}
		character:244004 = {
			save_scope_as = huaishen
		}
		character:304188 = {
			save_scope_as = huaiding
		}
		character:RICE_zhang_003 = {
			save_scope_as = huaiding_son_1
		}
		character:RICE_zhang_004 = {
			save_scope_as = huaiding_son_2
		}
		character:RICE_zhang_005 = {
			save_scope_as = huaiding_son_3
		}
		character:RICE_zhang_006 = {
			save_scope_as = huaiding_son_4
		}
		character:RICE_dunhuang_misc_001 = {
			save_scope_as = zhu_zaiqing
		}
		character:RICE_dunhuang_misc_002 = {
			save_scope_as = wuzhen
		}
		character:RICE_dunhuang_misc_004 = {
			save_scope_as = zhang_qiu
		}
		# Seriously wtf are all these Tangut people doing here
		hidden_effect = {
			every_courtier_or_guest = {
				limit = {
					has_culture = culture:tangut
				}
				move_to_pool = yes
			}
		}
	}
	
	option = {
		name = tarim_basin.0050.a
		trigger_event = tarim_basin.0051
	}
}

# Part 2
tarim_basin.0051 = {
	type = character_event
	title = tarim_basin.0051.t
	desc = tarim_basin.0051.desc
	theme = RICE_theme_dunhuang_villa
	
	left_portrait = {
		character = scope:yichao
		animation = personality_honorable
	}
	right_portrait = {
		character = scope:huaishen
		animation = worry
	}
	lower_center_portrait = scope:yitan
	
	# Default
	option = {
		name = tarim_basin.0051.a
		hidden_effect = {
			# Just lost it since it was conquered in 866 and lost to Uighurs right after
			add_pressed_claim = title:c_luntai
			add_pressed_claim = title:c_karashar
			add_pressed_claim = title:c_loulan
			add_pressed_claim = title:c_charkliq
			add_pressed_claim = title:c_toksun
			add_pressed_claim = title:c_kara_khoja
			scope:yichao = {
				death = {
					death_reason = death_RICE_went_to_china
				}			
			}
		}
		custom_tooltip = tarim_basin.0051.a.tooltip
		every_vassal = {
			limit = {
				culture = { has_cultural_pillar = heritage_chinese }
				highest_held_title_tier = tier_duchy
			}
			add_unpressed_claim = title:k_guiyi
		}	
		add_to_global_variable_list = {
			name = RICE_dunhuang_tang_hostage
			target = flag:yeeted_yichao
		}
	}
	
	# Play as Yichao, Huaishen leaves
	option = {
		name = tarim_basin.0051.b
		hidden_effect = {
			scope:yichao = {
				get_title = title:c_changma # Weird quirk to ensure Yichao keeps Shazhou and not Huaishen's heir
				get_title = title:d_guiyi
				get_title = title:k_guiyi
				get_title = title:c_shazhou

				# Just lost it since it was conquered in 866 and lost to Uighurs right after
				add_pressed_claim = title:c_luntai
				add_pressed_claim = title:c_karashar
				add_pressed_claim = title:c_loulan
				add_pressed_claim = title:c_charkliq
				add_pressed_claim = title:c_toksun
				add_pressed_claim = title:c_kara_khoja

				add_courtier = scope:huaiding_son_1
				add_courtier = scope:huaiding_son_2
				add_courtier = scope:huaiding_son_3
				add_courtier = scope:huaiding_son_4
				add_courtier = scope:zhu_zaiqing
				add_courtier = scope:wuzhen
				add_courtier = scope:zhang_qiu
			}
		}
		set_player_character = scope:yichao	
		hidden_effect = {			
			scope:huaishen = {
				death = {
					death_reason = death_RICE_went_to_china
				}			
			}
			character:1059714 = {
				get_title = title:c_changma # Weird quirk to ensure Yichao keeps Shazhou and not Huaishen's heir
			}
		}
		custom_tooltip = tarim_basin.0051.b.tooltip
		add_to_global_variable_list = {
			name = RICE_dunhuang_tang_hostage
			target = flag:yeeted_huaishen
		}
	}
	
	# Play as Yichao, no one leaves
	option = {
		name = tarim_basin.0051.c
		hidden_effect = {
			scope:yichao = {
				get_title = title:c_changma # Weird quirk to ensure Yichao keeps Shazhou and not Huaishen's heir
				get_title = title:d_guiyi
				get_title = title:k_guiyi
				get_title = title:c_shazhou
			}
		}
		set_player_character = scope:yichao
		scope:yichao = {
			add_character_modifier = {
				modifier = RICE_tarim_basin_guiyi_tang_distrust
			}
		}
		hidden_effect = {
			scope:yichao = {

				# Just lost it since it was conquered in 866 and lost to Uighurs right after
				add_pressed_claim = title:c_luntai
				add_pressed_claim = title:c_karashar
				add_pressed_claim = title:c_loulan
				add_pressed_claim = title:c_charkliq
				add_pressed_claim = title:c_toksun
				add_pressed_claim = title:c_kara_khoja

				add_courtier = scope:huaishen
				add_courtier = scope:huaiding_son_1
				add_courtier = scope:huaiding_son_2
				add_courtier = scope:huaiding_son_3
				add_courtier = scope:huaiding_son_4
				add_courtier = scope:zhu_zaiqing
				add_courtier = scope:wuzhen
				add_courtier = scope:zhang_qiu

			}
			character:1059714 = {
				get_title = title:c_changma # Weird quirk to ensure Yichao keeps Shazhou and not Huaishen's heir
			}
		}
		custom_tooltip = tarim_basin.0051.c.tooltip
		add_to_global_variable_list = {
			name = RICE_dunhuang_tang_hostage
			target = flag:yeeted_no_one
		}
	}

	after = {
		character:206811 = {
			trigger_event = tarim_basin.0052
		}
		every_ruler = {
			limit = {
				is_ai = no
				any_held_title = {
					tier = tier_county
					any_county_province = {
						geographical_region = RICE_dunhuang_region
					}
				}
			}
			trigger_event = tarim_basin.0052
		}		
	}
}


# Dunhuang choice notification	
tarim_basin.0052 = {
	type = character_event
	title = tarim_basin.0052.t
	desc = {
		desc = tarim_basin.0052.desc
		first_valid = {
			# Yichao leaves (historical)
			triggered_desc = {
				trigger = {
					is_target_in_global_variable_list = {
						name = RICE_dunhuang_tang_hostage
						target = flag:yeeted_yichao
					}
				}
				desc = tarim_basin.0052.desc.yeet_yichao
			}
			# Yichao doesn't leave, Huaishen leaves
			triggered_desc = {
				trigger = {
					is_target_in_global_variable_list = {
						name = RICE_dunhuang_tang_hostage
						target = flag:yeeted_huaishen
					}
				}
				desc = tarim_basin.0052.desc.yeet_huaishen
			}
			# No one leaves
			triggered_desc = {
				trigger = {
					is_target_in_global_variable_list = {
						name = RICE_dunhuang_tang_hostage
						target = flag:yeeted_no_one
					}
				}
				desc = tarim_basin.0052.desc.yeet_no_one
			}
		}
	}
	theme = RICE_theme_dunhuang_villa
	
	left_portrait = {
		character = scope:yichao
		animation = personality_honorable
	}
	right_portrait = {
		character = scope:huaishen
		animation = worry
	}
	lower_center_portrait = scope:yitan

	immediate = {
		play_music_cue = "mx_li_ling_si_han"
	}
	
	option = { 
		name = tarim_basin.0052.a
	}
}


# Death of Zhang Yichao (if he stayed) - ping event
tarim_basin.0053 = {
	type = empty
	hidden = yes
	
	trigger = {
		has_character_modifier = RICE_tarim_basin_is_zhang_yichao
		exists = title:k_guiyi.holder
		OR = {
			is_target_in_global_variable_list = {
				name = RICE_dunhuang_tang_hostage
				target = flag:yeeted_huaishen
			}
			is_target_in_global_variable_list = {
				name = RICE_dunhuang_tang_hostage
				target = flag:yeeted_no_one
			}
		}
	}
	
	immediate = {
		save_scope_as = yichao
		title:k_guiyi = { #For loc.
			save_scope_as = guiyi_kingdom
		}
		set_global_variable = {
			name = RICE_zhang_yichao_passed_away
			value = yes
		}
		RICE_tarim_basin_dunhuang_zhang_yichao_death_effect = yes
		every_player = {
			limit = {
				is_ai = no
				any_held_title = {
					tier = tier_county
					any_county_province = {
						geographical_region = RICE_dunhuang_region
					}
				}		
			}
			trigger_event = tarim_basin.0054
		}
	}
}

# Death of Zhang Yichao (if he stayed) - notification
tarim_basin.0054 = {
	type = character_event
	title = tarim_basin.0054.t
	desc = tarim_basin.0054.desc
	theme = RICE_theme_dunhuang_mogao_caves
	
	left_portrait = {
		character = scope:yichao
		animation = personality_zealous
	}

	immediate = {
		character:206811 = {
			save_scope_as = yichao
		}		
		show_as_tooltip = {
			RICE_tarim_basin_dunhuang_zhang_yichao_death_effect = yes
		}
	}
	
	option = { # Ok
		name = tarim_basin.0054.a
	}
}



# Death of Zhang Yichao (if he left)
# tarim_basin.0055 = {
# 	type = character_event
# 	title = tarim_basin.0055.t
# 	desc = tarim_basin.0055.desc
# 	theme = RICE_theme_dunhuang_mogao_caves
	
# 	left_portrait = {
# 		character = scope:yichao
# 		animation = personality_zealous
# 	}

# 	# trigger = {
# 	# 	exists = title:k_guiyi.holder
# 	# 	has_title = title:k_guiyi
# 	# 	OR = {
# 	# 		is_target_in_global_variable_list = {
# 	# 			name = RICE_dunhuang_tang_hostage
# 	# 			target = flag:yeeted_huaishen
# 	# 		}
# 	# 		is_target_in_global_variable_list = {
# 	# 			name = RICE_dunhuang_tang_hostage
# 	# 			target = flag:yeeted_no_one
# 	# 		}
# 	# 	}
# 	# }

# 	immediate = {
# 		character:206811 = {
# 			save_scope_as = yichao
# 		}
# 		# set_global_variable = {
# 		# 	name = RICE_zhang_yichao_passed_away
# 		# 	value = yes
# 		# }
# 		show_as_tooltip = {
# 			RICE_tarim_basin_dunhuang_zhang_yichao_death_effect = yes
# 		}
# 	}
	
# 	option = { # Ok
# 		name = tarim_basin.0055.a
# 		# RICE_tarim_basin_dunhuang_zhang_yichao_death_effect = yes
# 		# trigger_event = tarim_basin.0054
# 		# every_player = {
# 		# 	limit = {
# 		# 		is_ai = no
# 		# 		any_held_title = {
# 		# 			tier = tier_county
# 		# 			any_county_province = {
# 		# 				geographical_region = RICE_dunhuang_region
# 		# 			}
# 		# 		}		
# 		# 	}
# 		# 	trigger_event = tarim_basin.0054
# 		# }
# 	}
# }

# Random Tang dynasty "gifts" tombola
tarim_basin.0056 = {
	hidden = yes
	
	trigger = {
		NOT = { has_global_variable = RICE_zhang_yichao_passed_away }
		current_year < 910 # Failsafe in case it keeps triggering for some reason
		exists = title:k_guiyi.holder
		has_title = title:k_guiyi
		OR = {
			is_target_in_global_variable_list = {
				name = RICE_dunhuang_tang_hostage
				target = flag:yeeted_yichao
			}			
			is_target_in_global_variable_list = {
				name = RICE_dunhuang_tang_hostage
				target = flag:yeeted_huaishen
			}
		}
	}
	
	immediate = {
		save_scope_as = guiyi_jiedushi
		# If Yichao is the hostage, higher chances of getting bonuses
		if = {
			limit = {
				is_target_in_global_variable_list = {
					name = RICE_dunhuang_tang_hostage
					target = flag:yeeted_yichao
				}
			}
			random_list = {
				# Nothing
				15 = { }
				# Gold
				15 = {
					add_character_flag = RICE_dunhuang_bonus_gold
				}
				# Troops
				15 = {
					add_character_flag = RICE_dunhuang_bonus_troops
				}
				# Prestige
				15 = {
					add_character_flag = RICE_dunhuang_bonus_prestige
				}
				# Economic Modifiers
				5 = {
					add_character_flag = RICE_dunhuang_bonus_economic
				}
				# Military Modifiers
				5 = {
					add_character_flag = RICE_dunhuang_bonus_military
				}
				# Political Modifiers
				5 = {
					add_character_flag = RICE_dunhuang_bonus_political
				}
			}
		}
		# If Huaishen is the hostage, higher chances of getting bonuses
		if = {
			limit = {
				is_target_in_global_variable_list = {
					name = RICE_dunhuang_tang_hostage
					target = flag:yeeted_huaishen
				}
			}
			random_list = {
				# Nothing
				60 = { }
				# Gold
				15 = {
					add_character_flag = RICE_dunhuang_bonus_gold
				}
				# Troops
				15 = {
					add_character_flag = RICE_dunhuang_bonus_troops
				}
				# Prestige
				15 = {
					add_character_flag = RICE_dunhuang_bonus_prestige
				}
				# Economic Modifiers
				5 = {
					add_character_flag = RICE_dunhuang_bonus_economic
				}
				# Military Modifiers
				5 = {
					add_character_flag = RICE_dunhuang_bonus_military
				}
				# Political Modifiers
				5 = {
					add_character_flag = RICE_dunhuang_bonus_political
				}
			}
		}
		if = {
			limit = {
				OR = {
					has_character_flag = RICE_dunhuang_bonus_gold
					has_character_flag = RICE_dunhuang_bonus_troops
					has_character_flag = RICE_dunhuang_bonus_prestige
					has_character_flag = RICE_dunhuang_bonus_economic
					has_character_flag = RICE_dunhuang_bonus_military
					has_character_flag = RICE_dunhuang_bonus_political
				}
			}
			trigger_event = tarim_basin.0057
		}
	}
}



# Tang Dynasty sends bonuses
tarim_basin.0057 = {
	type = character_event
	title = tarim_basin.0057.t
	desc = {
		desc = tarim_basin.0057.desc
		first_valid = {
			triggered_desc = {
				trigger = {
					has_character_flag = RICE_dunhuang_bonus_gold
				}
				desc = tarim_basin.0057.desc.gold
			}
			triggered_desc = {
				trigger = {
					has_character_flag = RICE_dunhuang_bonus_troops
				}
				desc = tarim_basin.0057.desc.troops
			}
			triggered_desc = {
				trigger = {
					has_character_flag = RICE_dunhuang_bonus_prestige
				}
				desc = tarim_basin.0057.desc.prestige
			}
			triggered_desc = {
				trigger = {
					has_character_flag = RICE_dunhuang_bonus_economic
				}
				desc = tarim_basin.0057.desc.economic
			}
			triggered_desc = {
				trigger = {
					has_character_flag = RICE_dunhuang_bonus_military
				}
				desc = tarim_basin.0057.desc.military
			}
			triggered_desc = {
				trigger = {
					has_character_flag = RICE_dunhuang_bonus_political
				}
				desc = tarim_basin.0057.desc.political
			}
		}
		desc = tarim_basin.0057.desc.conclusion
	}
	theme = realm
	
	left_portrait = {
		character = scope:guiyi_jiedushi
		animation = personality_honorable
	}

	immediate = {
		if = {
			limit = {
				is_target_in_global_variable_list = {
					name = RICE_dunhuang_tang_hostage
					target = flag:yeeted_yichao
				}
			}
			if = {
				limit = {
					has_character_flag = RICE_dunhuang_bonus_gold
				}
				add_gold = 150
			}
			if = {
				limit = {
					has_character_flag = RICE_dunhuang_bonus_troops
				}
				RICE_dunhuang_greater_troop_spawn_effect = yes
			}
			if = {
				limit = {
					has_character_flag = RICE_dunhuang_bonus_prestige
				}
				add_prestige = 200
			}
			if = {
				limit = {
					has_character_flag = RICE_dunhuang_bonus_economic
				}
				capital_county = {
					add_county_modifier = {
						modifier = RICE_tarim_basin_dunhuang_economic_bonus_greater
						years = 5
					}			
				}
			}
			if = {
				limit = {
					has_character_flag = RICE_dunhuang_bonus_military
				}
				add_character_modifier = {
					modifier = RICE_tarim_basin_dunhuang_military_bonus_greater
					years = 5
				}
			}
			if = {
				limit = {
					has_character_flag = RICE_dunhuang_bonus_political
				}
				add_character_modifier = {
					modifier = RICE_tarim_basin_dunhuang_political_bonus_greater
					years = 5
				}
			}
		}
		if = {
			limit = {
				is_target_in_global_variable_list = {
					name = RICE_dunhuang_tang_hostage
					target = flag:yeeted_huaishen
				}
			}
			if = {
				limit = {
					has_character_flag = RICE_dunhuang_bonus_gold
				}
				add_gold = 75
			}
			if = {
				limit = {
					has_character_flag = RICE_dunhuang_bonus_troops
				}
				RICE_dunhuang_lesser_troop_spawn_effect = yes
			}
			if = {
				limit = {
					has_character_flag = RICE_dunhuang_bonus_prestige
				}
				add_prestige = 100
			}
			if = {
				limit = {
					has_character_flag = RICE_dunhuang_bonus_economic
				}				
				capital_county = {
					add_county_modifier = {
						modifier = RICE_tarim_basin_dunhuang_economic_bonus_lesser
						years = 5
					}			
				}
			}
			if = {
				limit = {
					has_character_flag = RICE_dunhuang_bonus_military
				}
				add_character_modifier = {
					modifier = RICE_tarim_basin_dunhuang_military_bonus_lesser
					years = 5
				}
			}
			if = {
				limit = {
					has_character_flag = RICE_dunhuang_bonus_political
				}
				add_character_modifier = {
					modifier = RICE_tarim_basin_dunhuang_political_bonus_lesser
					years = 5
				}
			}
		}
	}
	
	option = { # Ok
		name = tarim_basin.0057.a
		RICE_dunhuang_tang_bonus_remove_character_flags_effect = yes
	}

}







######################################################################################
# 
# MOGAO EVENTS
# 
# tarim_basin.0070-tarim_basin.0099
# 
######################################################################################


# Choose your Mogao Cave
tarim_basin.0070 = {
	type = character_event
	title = tarim_basin.0070.t
	desc = {
		desc = tarim_basin.0070.desc.intro
		first_valid = {
			triggered_desc = {
				trigger = {
					var:RICE_tarim_basin_mogao_cave_type = flag:family
				}
				desc = tarim_basin.0070.desc.family
			}		
			triggered_desc = {
				trigger = {
					var:RICE_tarim_basin_mogao_cave_type = flag:jataka
				}
				desc = tarim_basin.0070.desc.jataka
			}		
			triggered_desc = {
				trigger = {
					var:RICE_tarim_basin_mogao_cave_type = flag:deities
				}
				desc = tarim_basin.0070.desc.deities
			}		
		}
		desc = tarim_basin.0070.desc.conclusion
	}
	theme = RICE_theme_dunhuang_mogao_caves
	
	right_portrait = {
		character = root
		animation = personality_rational
	}
	
	# Pay basic amount
	option = {
		name = tarim_basin.0070.a
		if = {
			limit = {
				dynasty = {
					has_dynasty_perk = RICE_tarim_basin_silk_road_legacy_5
				}
			}
			remove_short_term_gold = 75
		}
		else = {
			remove_short_term_gold = 100
		}
		set_variable = {
			name = RICE_tarim_basin_mogao_cave_size
			value = 1 # Small
		}
		custom_tooltip = tarim_basin.0070.tooltip
	}
	# Pay medium amount
	option = {
		name = tarim_basin.0070.b
		trigger = {
			OR = {
				is_ai = no
				short_term_gold >= 200
				AND = {
					short_term_gold >= 150
					dynasty = {
						has_dynasty_perk = RICE_tarim_basin_silk_road_legacy_5
					}
				}
			}
		}
		if = {
			limit = {
				dynasty = {
					has_dynasty_perk = RICE_tarim_basin_silk_road_legacy_5
				}
			}
			remove_short_term_gold = 150
		}
		else = {
			remove_short_term_gold = 200
		}
		set_variable = {
			name = RICE_tarim_basin_mogao_cave_size
			value = 2 # Medium
		}
		custom_tooltip = tarim_basin.0070.tooltip
	}
	# Pay large amount
	option = {
		name = tarim_basin.0070.c
		trigger = {
			OR = {
				is_ai = no
				short_term_gold >= 300
				AND = {
					short_term_gold >= 225
					dynasty = {
						has_dynasty_perk = RICE_tarim_basin_silk_road_legacy_5
					}
				}
			}
		}
		if = {
			limit = {
				dynasty = {
					has_dynasty_perk = RICE_tarim_basin_silk_road_legacy_5
				}
			}
			remove_short_term_gold = 225
		}
		else = {
			remove_short_term_gold = 300
		}
		set_variable = {
			name = RICE_tarim_basin_mogao_cave_size
			value = 3 # Large
		}
		custom_tooltip = tarim_basin.0070.tooltip
	}

	after = {
		add_character_flag = RICE_dunhuang_mogao_cave_wip
		hidden_effect = {
		# RANDOM EVENTS
			random = { # Workman has auspicious dream
				chance = 20
				trigger_event = {
					id = tarim_basin.0073
					days = { 30 350 }
				}
			}
			random = { # Sandstorm strikes
				chance = 20
				trigger_event = {
					id = tarim_basin.0074
					days = { 30 350 }
				}
			}
			random = { # Bandits steal supplies
				chance = 20
				trigger_event = {
					id = tarim_basin.0075
					days = { 30 350 }
				}
			}
			random = { # Lay organization donates
				chance = 20
				trigger_event = {
					id = tarim_basin.0076
					days = { 30 350 }
				}
			}
			random = { # Prominent monk vistis
				chance = 20
				trigger_event = {
					id = tarim_basin.0077
					days = { 30 350 }
				}
			}
			random = { # Conflict with merchants
				chance = 20
				trigger_event = {
					id = tarim_basin.0078
					days = { 30 350 }
				}
			}
			random = { # Hidden room with treasures
				chance = 20
				trigger_event = {
					id = tarim_basin.0081
					days = { 30 350 }
				}
			}
			random = { # Foreign artist having troubles
				chance = 20
				trigger_event = {
					id = tarim_basin.0082
					days = { 30 350 }
				}
			}
			random = { # Worker is sick
				chance = 20
				trigger_event = {
					id = tarim_basin.0084
					days = { 30 350 }
				}
			}
			random = { # Monks come by for alms
				chance = 20
				trigger_event = {
					id = tarim_basin.0085
					days = { 30 350 }
				}
			}
			random = { # Eating vegetarian food
				chance = 20
				trigger_event = {
					id = tarim_basin.0086
					days = { 30 350 }
				}
			}
		}

		# Event to trigger when complete
		trigger_event = {
			id = tarim_basin.0071
			days = { 365 400 }
		}
	}

}



# Mogao Cave is complete
tarim_basin.0071 = {
	type = character_event
	title = tarim_basin.0071.t
	desc = tarim_basin.0071.desc
	theme = RICE_theme_dunhuang_mogao_caves
	
	right_portrait = {
		character = root
		animation = personality_zealous
	}
	
	# Ok
	option = {
		name = tarim_basin.0071.a
		if = {
			limit = {
				var:RICE_tarim_basin_mogao_cave_size = 1
			}
			add_character_modifier = {
				modifier = RICE_tarim_basin_built_mogao_cave_normal
				years = 15
			}
			if = {
				limit = {
					var:RICE_tarim_basin_mogao_cave_type = flag:family
				}
				add_prestige = 150
				add_piety = 50
				dynasty = { add_dynasty_prestige = 100 }
			}
			if = {
				limit = {
					var:RICE_tarim_basin_mogao_cave_type = flag:jataka
				}
				add_prestige = 100
				add_piety = 100
				dynasty = { add_dynasty_prestige = 100 }
			}
			if = {
				limit = {
					var:RICE_tarim_basin_mogao_cave_type = flag:deities
				}
				add_prestige = 50
				add_piety = 150
				dynasty = { add_dynasty_prestige = 100 }
			}
		}
		if = {
			limit = {
				var:RICE_tarim_basin_mogao_cave_size = 2
			}
			add_character_modifier = {
				modifier = RICE_tarim_basin_built_mogao_cave_big
				years = 15
			}
			if = {
				limit = {
					var:RICE_tarim_basin_mogao_cave_type = flag:family
				}
				add_prestige = 225
				add_piety = 75
				dynasty = { add_dynasty_prestige = 200 }
			}
			if = {
				limit = {
					var:RICE_tarim_basin_mogao_cave_type = flag:jataka
				}
				add_prestige = 150
				add_piety = 150
				dynasty = { add_dynasty_prestige = 200 }
			}
			if = {
				limit = {
					var:RICE_tarim_basin_mogao_cave_type = flag:deities
				}
				add_prestige = 75
				add_piety = 225
				dynasty = { add_dynasty_prestige = 200 }
			}
		}
		if = {
			limit = {
				var:RICE_tarim_basin_mogao_cave_size = 3
			}
			add_character_modifier = {
				modifier = RICE_tarim_basin_built_mogao_cave_bigger
				years = 15
			}
			if = {
				limit = {
					var:RICE_tarim_basin_mogao_cave_type = flag:family
				}
				add_prestige = 300
				add_piety = 100
				dynasty = { add_dynasty_prestige = 300 }
			}
			if = {
				limit = {
					var:RICE_tarim_basin_mogao_cave_type = flag:jataka
				}
				add_prestige = 200
				add_piety = 200
				dynasty = { add_dynasty_prestige = 300 }
			}
			if = {
				limit = {
					var:RICE_tarim_basin_mogao_cave_type = flag:deities
				}
				add_prestige = 100
				add_piety = 300
				dynasty = { add_dynasty_prestige = 300 }
			}
		}
		if = {
			limit = {
				var:RICE_tarim_basin_mogao_cave_size = 4
			}
			add_character_modifier = {
				modifier = RICE_tarim_basin_built_mogao_cave_biggest
				years = 15
			}
			if = {
				limit = {
					var:RICE_tarim_basin_mogao_cave_type = flag:family
				}
				add_prestige = 375
				add_piety = 125
				dynasty = { add_dynasty_prestige = 400 }
			}
			if = {
				limit = {
					var:RICE_tarim_basin_mogao_cave_type = flag:jataka
				}
				add_prestige = 250
				add_piety = 250
				dynasty = { add_dynasty_prestige = 400 }
			}
			if = {
				limit = {
					var:RICE_tarim_basin_mogao_cave_type = flag:deities
				}
				add_prestige = 125
				add_piety = 375
				dynasty = { add_dynasty_prestige = 400 }
			}
		}
	}

	after = {
		remove_character_flag = RICE_dunhuang_mogao_cave_wip
		if = {
			limit = { has_variable = RICE_tarim_basin_mogao_cave_type }
			remove_variable = RICE_tarim_basin_mogao_cave_type
		}
		if = {
			limit = { has_variable = RICE_tarim_basin_mogao_cave_size }
			remove_variable = RICE_tarim_basin_mogao_cave_size
		}
	}

}




# Workman dreams of a Bodhisattva 
tarim_basin.0073 = {
	type = character_event
	title = tarim_basin.0073.t
	desc = tarim_basin.0073.desc
	theme = RICE_theme_dunhuang_mogao_caves
	
	right_portrait = {
		character = root
		animation = personality_content
	}
	
	# Ok
	option = {
		name = tarim_basin.0073.a
		add_piety = 15
		stress_impact = {
			zealous = minor_stress_impact_loss
		}
	}
}


# Small sandstorm disrupts cave construction
tarim_basin.0074 = {
	type = character_event
	title = tarim_basin.0074.t
	desc = tarim_basin.0074.desc
	theme = mental_health
	override_background = { event_background = RICE_background_dunhuang_mogao_caves }
	
	left_portrait = {
		character = root
		animation = stress
	}
	
	# Ok
	option = {
		name = tarim_basin.0074.a
		remove_short_term_gold = 20
		stress_impact = {
			base = miniscule_stress_impact_gain
			zealous = miniscule_stress_impact_gain
			wrathful = miniscule_stress_impact_gain
		}
	}
}


# Bandits steal building materials
tarim_basin.0075 = {
	type = character_event
	title = tarim_basin.0075.t
	desc = tarim_basin.0075.desc
	theme = corruption
	override_background = { event_background = RICE_background_dunhuang_mogao_caves }
	
	left_portrait = {
		character = root
		animation = worry
	}
	
	# Ok
	option = {
		name = tarim_basin.0075.a
		remove_short_term_gold = 20
		add_prestige = -30
		stress_impact = {
			base = miniscule_stress_impact_gain
			zealous = miniscule_stress_impact_gain
			wrathful = miniscule_stress_impact_gain
		}
	}
}


# Local Buddhist lay organizations request to be included in mural
tarim_basin.0076 = {
	type = character_event
	title = tarim_basin.0076.t
	desc = tarim_basin.0076.desc
	theme = RICE_theme_dunhuang_mogao_caves
	
	right_portrait = {
		character = root
		animation = personality_rational
	}
	
	# Ok
	option = {
		name = tarim_basin.0076.a
		add_piety = 50
		add_prestige = -50
		stress_impact = {
			arrogant = miniscule_stress_impact_gain
			paranoid = miniscule_stress_impact_gain
		}
		if = {
			limit = {
				NOT = { var:RICE_tarim_basin_mogao_cave_size = 4 }
			}
			change_variable = {
				name = RICE_tarim_basin_mogao_cave_size
				add = 1
			}
		}
		custom_tooltip = tarim_basin.0076.a.tooltip
	}
	
	# Give them donations instead
	option = {
		name = tarim_basin.0076.b
		trigger = {
			OR = {
				is_ai = no
				gold >= 50
			}
		}
		remove_short_term_gold = 50
		add_piety = 100
		add_prestige = 50
		stress_impact = {
			greedy = minor_stress_impact_gain
			arrogant = miniscule_stress_impact_gain
		}
	}
	
	# Don't need their help
	option = {
		name = tarim_basin.0076.c
		stress_impact = {
			humble = miniscule_stress_impact_gain
			zealous = miniscule_stress_impact_gain
			trusting = miniscule_stress_impact_gain
			gregarious = miniscule_stress_impact_gain
			greedy = miniscule_stress_impact_gain
		}
	}
}



# Local monk visits the caves and approves
tarim_basin.0077 = {
	type = character_event
	title = tarim_basin.0077.t
	desc = tarim_basin.0077.desc
	theme = RICE_theme_dunhuang_mogao_caves
	
	right_portrait = {
		character = root
		animation = personality_zealous
	}
	
	# Ok
	option = {
		name = tarim_basin.0077.a
		add_piety = 25
		stress_impact = {
			zealous = miniscule_stress_impact_loss
		}
	}
}


# Conflict with merchants building their own cave nearby
tarim_basin.0078 = {
	type = character_event
	title = tarim_basin.0078.t
	desc = tarim_basin.0078.desc
	theme = corruption
	override_background = { event_background = RICE_background_dunhuang_mogao_caves }
	
	right_portrait = {
		character = root
		animation = angry
	}
	
	# Back off, don't fight
	option = {
		name = tarim_basin.0078.a
		add_prestige = -50
		stress_impact = {
			arrogant = minor_stress_impact_gain
			wrathful = minor_stress_impact_gain
			vengeful = miniscule_stress_impact_gain
			arbitrary = miniscule_stress_impact_gain
		}
	}
	
	# Pay them to screw off
	option = {
		name = tarim_basin.0078.b
		trigger = {
			OR = {
				is_ai = no
				gold >= 25
			}
		}
		remove_short_term_gold = 25
		stress_impact = {
			greedy = medium_stress_impact_gain
			arrogant = minor_stress_impact_gain
			wrathful = minor_stress_impact_gain
			vengeful = miniscule_stress_impact_gain
			arbitrary = miniscule_stress_impact_gain
		}
	}
	
	# Forget the merchants!
	option = {
		name = tarim_basin.0078.c
		add_piety = -50
		stress_impact = {
			humble = minor_stress_impact_gain
			calm = minor_stress_impact_gain
			forgiving = miniscule_stress_impact_gain
			just = miniscule_stress_impact_gain
			compassionate = miniscule_stress_impact_gain
		}
	}
	
	# Perhaps we can combine our caves
	option = {
		name = tarim_basin.0078.d
		trigger = {
			diplomacy >= medium_skill_rating		
		}
		skill = diplomacy
		stress_impact = {
			arrogant = medium_stress_impact_gain
			wrathful = minor_stress_impact_gain
			paranoid = minor_stress_impact_gain
			vengeful = miniscule_stress_impact_gain
			arbitrary = miniscule_stress_impact_gain
			callous = miniscule_stress_impact_gain
		}
		if = {
			limit = {
				NOT = { var:RICE_tarim_basin_mogao_cave_size = 4 }
			}
			change_variable = {
				name = RICE_tarim_basin_mogao_cave_size
				add = 1
			}
		}
		trigger_event = tarim_basin.0079
		custom_tooltip = tarim_basin.0078.d.tooltip
	}
}


# You end up cooperating with the merchants to make a bigger cave
tarim_basin.0079 = {
	type = character_event
	title = tarim_basin.0079.t
	desc = tarim_basin.0079.desc
	theme = friendly
	override_background = { event_background = RICE_background_dunhuang_mogao_caves }
	
	right_portrait = {
		character = root
		animation = happiness
	}
	
	# Ok
	option = {
		name = tarim_basin.0079.a
		add_prestige = 25
		add_piety = 25
		hidden_effect = {
			random = {
				chance = 20
				trigger_event = {
					id = tarim_basin.0080
					days = { 5 13 }
				}
			}
		}
	}
}


# You befriend one of the merchants who offers to join your court
tarim_basin.0080 = {
	type = character_event
	title = tarim_basin.0080.t
	desc = tarim_basin.0080.desc
	theme = RICE_theme_dunhuang_villa
	override_icon = { reference = "gfx/interface/icons/event_types/type_duty.dds" }
	
	left_portrait = {
		character = root
		animation = happiness
	}

	right_portrait = {
		character = scope:merchant
		animation = throne_room_bow_2
	}

	immediate = {
		create_character = {
			location = root.location
			template = mogao_cave_merchant_template
			save_scope_as = merchant
			culture = root.culture
			faith = root.faith
		}
	}
	
	# Ok
	option = {
		name = tarim_basin.0080.a
		add_courtier = scope:merchant
		if = {
			limit = {
				can_set_relation_friend_trigger = { CHARACTER = scope:merchant }
			}
			set_relation_friend = scope:merchant
		}
		if = {
			limit = {
				can_add_hook = {
					target = scope:merchant
					type = loyalty_hook
				}
			}
			add_hook = {
				target = scope:merchant
				type = loyalty_hook
			}
		}
	}
}


# Workers discover a hidden room
tarim_basin.0081 = {
	type = character_event
	title = tarim_basin.0081.t
	desc = tarim_basin.0081.desc
	theme = RICE_theme_dunhuang_mogao_caves
	
	left_portrait = {
		character = root
		animation = personality_rational
	}
	
	# Donate them to a local monastery
	option = {
		name = tarim_basin.0081.a
		add_piety = 30
		stress_impact = {
			greedy = minor_stress_impact_gain
			cynical = miniscule_stress_impact_gain
		}
	}
	
	# Add them to your cave
	option = {
		name = tarim_basin.0081.b
		add_prestige = 30
		stress_impact = {
			humble = miniscule_stress_impact_gain
			paranoid = miniscule_stress_impact_gain
		}
	}
	
	# Study them back home
	option = {
		name = tarim_basin.0081.c
		add_character_modifier = {
			modifier = RICE_tarim_basin_studying_mogao_artifacts
			years = 5
		}
		random = {
			chance = 50
			add_learning_skill = 1
		}
		stress_impact = {
			arrogant = miniscule_stress_impact_gain
			lazy = miniscule_stress_impact_gain
		}
	}
	
	# Sell them
	option = {
		name = tarim_basin.0081.d
		add_gold = 15
		stress_impact = {
			zealous = miniscule_stress_impact_gain
			generous = miniscule_stress_impact_gain
		}
	}
}


# Foreign artisan has trouble communicating
tarim_basin.0082 = {
	type = character_event
	title = tarim_basin.0082.t
	desc = tarim_basin.0082.desc
	theme = RICE_theme_dunhuang_mogao_caves
	
	left_portrait = {
		character = root
		animation = personality_rational
	}
	right_portrait = {
		character = scope:foreigner
		animation = shame
	}

	immediate = {
		random_list = {
			# Han
			# Sogdian
			# Saka
			# Afghan
			# Tocharian
			# Bodpa
			# Kashmiri
			# Punjabi
			# Nepali
			# Uyghur
			10 = {
				trigger = {
					NOT = { culture = { has_cultural_pillar = heritage_chinese } }
				}
				create_character = {
					location = root.location
					template = mogao_cave_foreign_artist_template
					save_scope_as = foreigner
					culture = culture:han
					faith = root.faith
				}				
			}
			10 = {
				trigger = {
					NOT = { culture = { has_cultural_pillar = heritage_iranian } }
				}
				create_character = {
					location = root.location
					template = mogao_cave_foreign_artist_template
					save_scope_as = foreigner
					culture = culture:sogdian
					faith = root.faith
				}				
			}
			10 = {
				trigger = {
					NOT = { culture = { has_cultural_pillar = heritage_iranian } }
				}
				create_character = {
					location = root.location
					template = mogao_cave_foreign_artist_template
					save_scope_as = foreigner
					culture = culture:saka
					faith = root.faith
				}				
			}
			10 = {
				trigger = {
					NOT = { culture = { has_cultural_pillar = heritage_iranian } }
				}
				create_character = {
					location = root.location
					template = mogao_cave_foreign_artist_template
					save_scope_as = foreigner
					culture = culture:afghan
					faith = root.faith
				}				
			}
			10 = {
				trigger = {
					NOT = { culture = { has_cultural_pillar = heritage_tocharian } }
				}
				create_character = {
					location = root.location
					template = mogao_cave_foreign_artist_template
					save_scope_as = foreigner
					culture = culture:tocharian
					faith = root.faith
				}				
			}
			10 = {
				trigger = {
					NOT = { culture = { has_cultural_pillar = heritage_tibetan } }
				}
				create_character = {
					location = root.location
					template = mogao_cave_foreign_artist_template
					save_scope_as = foreigner
					culture = culture:bodpa
					faith = root.faith
				}				
			}
			10 = {
				trigger = {
					NOT = { culture = { has_cultural_pillar = heritage_indo_aryan } }
				}
				create_character = {
					location = root.location
					template = mogao_cave_foreign_artist_template
					save_scope_as = foreigner
					culture = culture:kashmiri
					faith = root.faith
				}				
			}
			10 = {
				trigger = {
					NOT = { culture = { has_cultural_pillar = heritage_indo_aryan } }
				}
				create_character = {
					location = root.location
					template = mogao_cave_foreign_artist_template
					save_scope_as = foreigner
					culture = culture:punjabi
					faith = root.faith
				}				
			}
			10 = {
				trigger = {
					NOT = { culture = { has_cultural_pillar = heritage_indo_aryan } }
				}
				create_character = {
					location = root.location
					template = mogao_cave_foreign_artist_template
					save_scope_as = foreigner
					culture = culture:nepali
					faith = root.faith
				}				
			}
			10 = {
				trigger = {
					NOT = { culture = { has_cultural_pillar = heritage_turkic } }
				}
				create_character = {
					location = root.location
					template = mogao_cave_foreign_artist_template
					save_scope_as = foreigner
					culture = culture:uyghur
					faith = root.faith
				}				
			}
		}
	}
	
	# Not my problem
	option = {
		name = tarim_basin.0082.a
		stress_impact = {
			compassionate = minor_stress_impact_gain
			just = miniscule_stress_impact_gain
		}
		hidden_effect = {
			scope:foreigner = {		
				death = {
					death_reason = death_disappearance
				}
			}
		}
	}
	
	# Help them with misunderstandings
	option = {
		name = tarim_basin.0082.b
		add_prestige = -25
		add_piety = 25
		stress_impact = {
			callous = minor_stress_impact_gain
			arrogant = minor_stress_impact_gain
			sadistic = miniscule_stress_impact_gain
			arbitrary = miniscule_stress_impact_gain
		}
		hidden_effect = {
			random_list = {
				20 = {
					trigger_event = tarim_basin.0083
				}
				# He disappears
				80 = {
					scope:foreigner = {		
						death = {
							death_reason = death_disappearance
						}
					}
				}
			}
		}
	}
}


# Foreign artisan appreciates assistance
tarim_basin.0083 = {
	type = character_event
	title = tarim_basin.0083.t
	desc = tarim_basin.0083.desc
	theme = RICE_theme_dunhuang_mogao_caves
	
	left_portrait = {
		character = root
		animation = personality_compassionate
	}
	right_portrait = {
		character = scope:foreigner
		animation = admiration
	}
	
	# Ok
	option = {
		name = tarim_basin.0083.a
		add_courtier = scope:foreigner
		if = {
			limit = {
				can_add_hook = {
					target = scope:merchant
					type = loyalty_hook
				}
			}
			add_hook = {
				target = scope:merchant
				type = loyalty_hook
			}
		}
	}
}


# Sick worker is slow
tarim_basin.0084 = {
	type = character_event
	title = tarim_basin.0084.t
	desc = tarim_basin.0084.desc
	theme = medicine
	override_background = { event_background = RICE_background_dunhuang_mogao_caves }
	
	left_portrait = root
	
	# Fire the worker
	option = {
		name = tarim_basin.0084.a
		add_piety = -30
		add_dread = 5
		stress_impact = {
			compassionate = medium_stress_impact_gain
			generous = minor_stress_impact_gain
			calm = minor_stress_impact_gain
			trusting = miniscule_stress_impact_gain
		}
	}
	
	# Ok
	option = {
		name = tarim_basin.0084.b
		add_prestige = -30
	}
	
	# Pay for meds
	option = {
		name = tarim_basin.0084.c
		trigger = {
			OR = {
				is_ai = no
				gold >= 15
			}
		}
		remove_short_term_gold = 15
		add_prestige = -30
		add_piety = 50
		stress_impact = {
			sadistic = medium_stress_impact_gain
			callous = medium_stress_impact_gain
			greedy = minor_stress_impact_gain
			wrathful = miniscule_stress_impact_gain
		}
	}
}


# Monks come by to pray
tarim_basin.0085 = {
	type = character_event
	title = tarim_basin.0085.t
	desc = tarim_basin.0085.desc
	theme = RICE_theme_dunhuang_mogao_caves
	
	left_portrait = root
	
	# No donations
	option = {
		name = tarim_basin.0085.a
		add_piety = -25
		stress_impact = {
			zealous = minor_stress_impact_gain
			generous = minor_stress_impact_gain
			compassionate = miniscule_stress_impact_gain
			just = miniscule_stress_impact_gain
		}
	}
	
	# Donations
	option = {
		name = tarim_basin.0085.b
		trigger = {
			OR = {
				is_ai = no
				gold >= 10
			}
		}
		remove_short_term_gold = 10
		add_piety = 20
		stress_impact = {
			cynical = miniscule_stress_impact_gain
			greedy = miniscule_stress_impact_gain
			#callous = miniscule_stress_impact_gain
			#arbitrary = miniscule_stress_impact_gain
		}
	}
	
	# Many donations
	option = {
		name = tarim_basin.0085.c
		trigger = {
			OR = {
				is_ai = no
				gold >= 30
			}
		}
		remove_short_term_gold = 30
		add_piety = 50
		stress_impact = {
			cynical = minor_stress_impact_gain
			greedy = medium_stress_impact_gain
			callous = miniscule_stress_impact_gain
			arbitrary = miniscule_stress_impact_gain
		}
	}
}



# Vegetarian feast at the Mogao Cave
tarim_basin.0086 = {
	type = character_event
	title = tarim_basin.0086.t
	desc = tarim_basin.0086.desc
	theme = feast_activity
	override_background = { event_background = RICE_background_dunhuang_mogao_caves }
	
	right_portrait = root
	
	# No vegetarianism
	option = {
		name = tarim_basin.0086.a
		add_piety = -25
		stress_impact = {
			zealous = minor_stress_impact_gain
			compassionate = minor_stress_impact_gain
			temperate = minor_stress_impact_gain
			humble = minor_stress_impact_gain
		}
	}
	
	# Eat what is needed
	option = {
		name = tarim_basin.0086.b
		add_piety = 15
		stress_impact = {
			gluttonous = miniscule_stress_impact_gain
		}
	}
	
	# Delicious!
	option = {
		name = tarim_basin.0086.c
		add_piety = 25
		add_prestige = -15
		stress_impact = {
			gluttonous = minor_stress_impact_gain
		}
	}
}



######################################################################################
# 
# TOCHARIAN EVENTS
# 
# tarim_basin.0100-tarim_basin.0149
# 
######################################################################################


######################################################################################
# 
# STAGE ANIMAL FIGHTS
# 
# tarim_basin.0100-tarim_basin.0109
# 
######################################################################################


# Prepare to stage an animal fight
tarim_basin.0100 = {
	type = character_event
	title = tarim_basin.0100.t
	desc = tarim_basin.0100.desc
	theme = realm
	override_icon = { reference = "gfx/interface/icons/event_types/type_feast.dds" }
	
	left_portrait = root
	
	immediate = {
		capital_province = { save_scope_as = capital_province } #For loc.
		# Stop characters from planning multiple activities at once.
		add_character_flag = planning_an_activity
	}
	
	option = { # Cattle
		name = tarim_basin.0100.a
		# Cows are sacred in Hinduism
		trigger = {
			NOT = { religion = religion:hinduism_religion }
		}
		custom_tooltip = tarim_basin.0100.a.tooltip
		set_variable = {
			name = RICE_tarim_basin_tocharian_fight_animal
			value = flag:cattle
		}
		# Choose appropriate location
		scope:capital_province = {	
			spawn_activity = {
				owner = root
				type = activity_tarim_basin_tocharian_animal_fight
			}	
		}
		custom_tooltip = tarim_basin.0100.tooltip
	}
	
	option = { # Horses
		name = tarim_basin.0100.b
		custom_tooltip = tarim_basin.0100.b.tooltip
		set_variable = {
			name = RICE_tarim_basin_tocharian_fight_animal
			value = flag:horses
		}
		# Choose appropriate location
		scope:capital_province = {	
			spawn_activity = {
				owner = root
				type = activity_tarim_basin_tocharian_animal_fight
			}	
		}
		custom_tooltip = tarim_basin.0100.tooltip
	}
	
	option = { # Camels
		name = tarim_basin.0100.c
		custom_tooltip = tarim_basin.0100.c.tooltip
		set_variable = {
			name = RICE_tarim_basin_tocharian_fight_animal
			value = flag:camels
		}
		# Choose appropriate location
		scope:capital_province = {	
			spawn_activity = {
				owner = root
				type = activity_tarim_basin_tocharian_animal_fight
			}	
		}
		custom_tooltip = tarim_basin.0100.tooltip
	}
	
	option = { # Goats
		name = tarim_basin.0100.d
		custom_tooltip = tarim_basin.0100.d.tooltip
		set_variable = {
			name = RICE_tarim_basin_tocharian_fight_animal
			value = flag:goats
		}
		# Choose appropriate location
		scope:capital_province = {	
			spawn_activity = {
				owner = root
				type = activity_tarim_basin_tocharian_animal_fight
			}	
		}
		custom_tooltip = tarim_basin.0100.tooltip
	}

}


# Animal Fight starts
tarim_basin.0101 = {
	type = character_event
	title = tarim_basin.0101.t
	desc = {
		desc = tarim_basin.0101.desc.intro
		first_valid = {
			triggered_desc = {
				trigger = {
					var:RICE_tarim_basin_tocharian_fight_animal = flag:cattle
				}
				desc = tarim_basin.0101.desc.cattle
			}	
			triggered_desc = {
				trigger = {
					var:RICE_tarim_basin_tocharian_fight_animal = flag:horses
				}
				desc = tarim_basin.0101.desc.horses
			}	
			triggered_desc = {
				trigger = {
					var:RICE_tarim_basin_tocharian_fight_animal = flag:camels
				}
				desc = tarim_basin.0101.desc.camels
			}	
			triggered_desc = {
				trigger = {
					var:RICE_tarim_basin_tocharian_fight_animal = flag:goats
				}
				desc = tarim_basin.0101.desc.goats
			}	
		}
		desc = tarim_basin.0101.desc.conclusion
	}
	theme = feast_activity
	override_background = { event_background = RICE_background_tarim_basin_town }
	
	left_portrait = root
	
	immediate = {
		play_music_cue = mx_cue_banquet
		capital_province = { save_scope_as = capital_province } #For loc.
	}
	
	option = { # Ok
		name = tarim_basin.0101.a
		trigger_event = {
			id = tarim_basin.0102
			days = 7
		}
	}
}


# Animal Fight ends
tarim_basin.0102 = {
	type = character_event
	title = tarim_basin.0102.t
	desc = {
		desc = tarim_basin.0102.desc.intro
		first_valid = {
			triggered_desc = {
				trigger = {
					var:RICE_tarim_basin_tocharian_fight_animal = flag:cattle
				}
				desc = tarim_basin.0102.desc.cattle
			}	
			triggered_desc = {
				trigger = {
					var:RICE_tarim_basin_tocharian_fight_animal = flag:horses
				}
				desc = tarim_basin.0102.desc.horses
			}	
			triggered_desc = {
				trigger = {
					var:RICE_tarim_basin_tocharian_fight_animal = flag:camels
				}
				desc = tarim_basin.0102.desc.camels
			}	
			triggered_desc = {
				trigger = {
					var:RICE_tarim_basin_tocharian_fight_animal = flag:goats
				}
				desc = tarim_basin.0102.desc.goats
			}	
		}
		first_valid = {
			triggered_desc = {
				trigger = {
					var:RICE_tarim_basin_tocharian_fight_result = flag:nothing
				}
				desc = tarim_basin.0102.desc.nothing
			}	
			triggered_desc = {
				trigger = {
					var:RICE_tarim_basin_tocharian_fight_result = flag:good
				}
				desc = tarim_basin.0102.desc.good
			}	
			triggered_desc = {
				trigger = {
					var:RICE_tarim_basin_tocharian_fight_result = flag:great
				}
				desc = tarim_basin.0102.desc.great
			}
		}
	}
	theme = feast_activity
	override_background = { event_background = RICE_background_tarim_basin_town }
	
	left_portrait = root
	
	immediate = {
		random_list = {
			40 = {
				set_variable = {
					name = RICE_tarim_basin_tocharian_fight_result
					value = flag:nothing
				}
				add_prestige = 50
			}
			40 = {
				set_variable = {
					name = RICE_tarim_basin_tocharian_fight_result
					value = flag:good
				}
				add_prestige = 100
				if = {
					limit = {
						var:RICE_tarim_basin_tocharian_fight_animal = flag:cattle
					}
					random_list = {
						66 = {
							add_character_modifier = {
								modifier = RICE_tarim_basin_fight_cattle_good_character
								years = 7
							}
						}
						33 = {
							capital_county = {
								add_county_modifier = {
									modifier = RICE_tarim_basin_fight_cattle_good_county
									years = 7
								}			
							} 
						}
					}	
				}
				if = {
					limit = {
						var:RICE_tarim_basin_tocharian_fight_animal = flag:horses
					}
					random_list = {
						66 = {
							add_character_modifier = {
								modifier = RICE_tarim_basin_fight_horses_good_character
								years = 7
							}
						}
						33 = {
							capital_county = {
								add_county_modifier = {
									modifier = RICE_tarim_basin_fight_horses_good_county
									years = 7
								}			
							} 
						}
					}	
				}
				if = {
					limit = {
						var:RICE_tarim_basin_tocharian_fight_animal = flag:camels
					}
					random_list = {
						66 = {
							add_character_modifier = {
								modifier = RICE_tarim_basin_fight_camels_good_character
								years = 7
							}
						}
						33 = {
							capital_county = {
								add_county_modifier = {
									modifier = RICE_tarim_basin_fight_camels_good_county
									years = 7
								}			
							} 
						}
					}	
				}
				if = {
					limit = {
						var:RICE_tarim_basin_tocharian_fight_animal = flag:goats
					}
					random_list = {
						66 = {
							add_character_modifier = {
								modifier = RICE_tarim_basin_fight_goats_good_character
								years = 7
							}
						}
						33 = {
							capital_county = {
								add_county_modifier = {
									modifier = RICE_tarim_basin_fight_goats_good_county
									years = 7
								}			
							} 
						}
					}	
				}
			}
			20 = {
				set_variable = {
					name = RICE_tarim_basin_tocharian_fight_result
					value = flag:great
				}
				add_prestige = 150
				if = {
					limit = {
						var:RICE_tarim_basin_tocharian_fight_animal = flag:cattle
					}
					random_list = {
						66 = {
							add_character_modifier = {
								modifier = RICE_tarim_basin_fight_cattle_great_character
								years = 7
							}
						}
						33 = {
							capital_county = {
								add_county_modifier = {
									modifier = RICE_tarim_basin_fight_cattle_great_county
									years = 7
								}			
							} 
						}
					}	
				}
				if = {
					limit = {
						var:RICE_tarim_basin_tocharian_fight_animal = flag:horses
					}
					random_list = {
						66 = {
							add_character_modifier = {
								modifier = RICE_tarim_basin_fight_horses_great_character
								years = 7
							}
						}
						33 = {
							capital_county = {
								add_county_modifier = {
									modifier = RICE_tarim_basin_fight_horses_great_county
									years = 7
								}			
							} 
						}
					}	
				}
				if = {
					limit = {
						var:RICE_tarim_basin_tocharian_fight_animal = flag:camels
					}
					random_list = {
						66 = {
							add_character_modifier = {
								modifier = RICE_tarim_basin_fight_camels_great_character
								years = 7
							}
						}
						33 = {
							capital_county = {
								add_county_modifier = {
									modifier = RICE_tarim_basin_fight_camels_great_county
									years = 7
								}			
							} 
						}
					}	
				}
				if = {
					limit = {
						var:RICE_tarim_basin_tocharian_fight_animal = flag:goats
					}
					random_list = {
						66 = {
							add_character_modifier = {
								modifier = RICE_tarim_basin_fight_goats_great_character
								years = 7
							}
						}
						33 = {
							capital_county = {
								add_county_modifier = {
									modifier = RICE_tarim_basin_fight_goats_great_county
									years = 7
								}			
							} 
						}
					}	
				}
			}
		}
	}
	
	option = { # Ok
		name = tarim_basin.0102.a
	}

	after = {
		if = {
			limit = { has_variable = RICE_tarim_basin_tocharian_fight_animal }
			remove_variable = RICE_tarim_basin_tocharian_fight_animal
		}
		hidden_effect = {
			scope:activity = {
				complete_activity = yes
			}
		}
	}

}



######################################################################################
# 
# KHOTANESE EVENTS
# 
# tarim_basin.0150-tarim_basin.0199
# 
######################################################################################


######################################################################################
# 
# ANNUAL PROCESSION EVENTS
# 
# tarim_basin.0150-tarim_basin.0169
# 
######################################################################################



# Annual procession starts
tarim_basin.0150 = {
	type = character_event
	title = tarim_basin.0150.t
	desc = tarim_basin.0150.desc
	theme = friendly
	override_icon = { reference = "gfx/interface/icons/event_types/type_faith.dds" }
	
	left_portrait = root
	
	immediate = {
		# Stop characters from planning multiple activities at once.
		add_character_flag = planning_an_activity
	}
	
	option = { # Cattle
		name = tarim_basin.0150.a
		# Choose appropriate location
		title:b_khotan.title_province = {	
			spawn_activity = {
				owner = root
				type = activity_tarim_basin_khotan_procession
			}	
		}
	}

	# after = {
	# 	hidden_effect = {
	# 		scope:activity = {
	# 			complete_activity = yes
	# 		}
	# 	}
	# }

}


# Procession is almost starting
tarim_basin.0151 = {
	type = character_event
	title = tarim_basin.0151.t
	desc = {
		desc = tarim_basin.0151.desc.intro
		first_valid = {
			triggered_desc = {
				trigger = {
					has_title = title:c_khotan
				}
				desc = tarim_basin.0151.desc.khotan_ruler
			}	
			triggered_desc = {
				trigger = {
					NOT = { has_title = title:c_khotan }
				}
				desc = tarim_basin.0151.desc.not_khotan_ruler
			}
		}
	}
	theme = faith
	override_background = { event_background = RICE_background_tarim_basin_landscape }
	
	left_portrait = {
		character = root
		animation = personality_zealous
	}
	
	immediate = {
		title:c_khotan.holder = {
			save_scope_as = khotan_ruler
		}
		title:c_khotan = { #For loc.
			save_scope_as = khotan
		}
	}
	
	option = { # Ok
		name = tarim_basin.0151.a
		trigger_event = tarim_basin.0152
	}

}


# Procession starts
tarim_basin.0152 = {
	type = character_event
	title = tarim_basin.0152.t
	desc = {
		desc = tarim_basin.0152.desc.intro
		first_valid = {
			triggered_desc = {
				trigger = {
					has_title = title:c_khotan
				}
				desc = tarim_basin.0152.desc.khotan_ruler
			}	
			triggered_desc = {
				trigger = {
					NOT = { has_title = title:c_khotan }
				}
				desc = tarim_basin.0152.desc.not_khotan_ruler
			}
		}
	}
	theme = faith
	override_background = { event_background = RICE_background_tarim_basin_landscape }
	
	right_portrait = {
		character = root
		animation = throne_room_bow_1
	}
	
	option = { # Ok
		name = tarim_basin.0152.a
		# Reflect on one of the Khotanese Buddhist legends
		random_list = {
			80 = {
				# Nothing
			}
			# Eight Protector kings
			10 = {
				trigger_event = {
					id = tarim_basin.0154
					days = { 3 11 }
				}
			}
			# Deer of Saṃjñāya - founding of Gomati
			10 = {
				trigger_event = {
					id = tarim_basin.0155
					days = { 3 11 }
				}
			}
			# Princess Vimalaprabha Khotan legends
			10 = {
				trigger_event = {
					id = tarim_basin.0156
					days = { 3 11 }
				}
			}
			# Buddha drains the lake
			10 = {
				trigger_event = {
					id = tarim_basin.0157
					days = { 3 11 }
				}
			}
			# Ashoka’s son, adopted by Chinese king
			10 = {
				trigger_event = {
					id = tarim_basin.0158
					days = { 3 11 }
				}
			}
			# Story about the Silk Princess
			10 = {
				trigger_event = {
					id = tarim_basin.0159
					days = { 3 11 }
				}
			}
			# Hill of Gautośan, with the monastery of Kāśyapa relics
			10 = {
				trigger_event = {
					id = tarim_basin.0160
					days = { 3 11 }
				}
			}
			# Miraculous statue of Pimo
			10 = {
				trigger_event = {
					id = tarim_basin.0161
					days = { 3 11 }
				}
			}
		}
		trigger_event = {
			id = tarim_basin.0153
			days = 14
		}
	}

}


# Procession ends
tarim_basin.0153 = {
	type = character_event
	title = tarim_basin.0153.t
	desc = {
		desc = tarim_basin.0153.desc.intro
		first_valid = {
			triggered_desc = {
				trigger = {
					has_title = title:c_khotan
				}
				desc = tarim_basin.0153.desc.khotan_ruler
			}	
			triggered_desc = {
				trigger = {
					NOT = { has_title = title:c_khotan }
				}
				desc = tarim_basin.0153.desc.not_khotan_ruler
			}
		}
	}
	theme = faith
	override_background = { event_background = RICE_background_tarim_basin_landscape }
	
	right_portrait = root

	option = { # Ok
		name = tarim_basin.0153.a
	}

	after = {
		hidden_effect = {
			scope:activity = {
				complete_activity = yes
			}
		}
	}
}


# Eight Protector Kings
tarim_basin.0154 = {
	type = character_event
	title = tarim_basin.0154.t
	desc = tarim_basin.0154.desc
	theme = diplomacy_majesty_focus
	override_background = { event_background = RICE_background_tibet_inner_altar }
	
	right_portrait = {
		character = root
		animation = personality_honorable
	}
	
	option = { # Ok
		name = tarim_basin.0154.a
		add_prestige = 15
		add_piety = 15
	}
}

# Deer of Saṃjñāya - founding of Gomati
tarim_basin.0155 = {
	type = character_event
	title = tarim_basin.0155.t
	desc = tarim_basin.0155.desc
	theme = faith
	override_background = { event_background = RICE_background_tarim_basin_landscape }
	
	left_portrait = {
		character = root
		animation = personality_rational
	}
	
	option = { # Ok
		name = tarim_basin.0155.a
		add_piety = 30
	}
}


# Princess Vimalaprabha Khotan legends
tarim_basin.0156 = {
	type = character_event
	title = tarim_basin.0156.t
	desc = tarim_basin.0156.desc
	theme = diplomacy_majesty_focus
	override_background = { event_background = RICE_background_tarim_basin_town }
	
	left_portrait = {
		character = root
		animation = personality_content
	}
	
	option = { # Ok
		name = tarim_basin.0156.a
		add_piety = 30
	}
}

# Buddha drains the lake
tarim_basin.0157 = {
	type = character_event
	title = tarim_basin.0157.t
	desc = tarim_basin.0157.desc
	theme = diplomacy_majesty_focus
	override_background = { event_background = RICE_background_tarim_basin_landscape }
	
	left_portrait = {
		character = root
		animation = personality_compassionate
	}
	
	option = { # Ok
		name = tarim_basin.0157.a
		add_piety = 15
		add_prestige = 15
	}
}

# Ashoka’s son, adopted by Chinese king
tarim_basin.0158 = {
	type = character_event
	title = tarim_basin.0158.t
	desc = tarim_basin.0158.desc
	theme = diplomacy_majesty_focus
	override_background = { event_background = RICE_background_tarim_basin_town }
	
	right_portrait = {
		character = root
		animation = personality_content
	}
	
	option = { # Ok
		name = tarim_basin.0158.a
		add_prestige = 30
	}
}

# Story about the Silk Princess
tarim_basin.0159 = {
	type = character_event
	title = tarim_basin.0159.t
	desc = tarim_basin.0159.desc
	theme = faith
	override_background = { event_background = RICE_background_tibet_inner_altar }
	
	right_portrait = {
		character = root
		animation = personality_zealous
	}
	
	option = { # Ok
		name = tarim_basin.0159.a
		add_piety = 15
		add_prestige = 15
	}
}

# Hill of Gautośan, with the monastery of Kāśyapa relics
tarim_basin.0160 = {
	type = character_event
	title = tarim_basin.0160.t
	desc = tarim_basin.0160.desc
	theme = faith
	override_background = { event_background = RICE_background_tarim_basin_landscape }
	
	right_portrait = {
		character = root
		animation = personality_zealous
	}
	
	option = { # Ok
		name = tarim_basin.0160.a
		add_piety = 15
		add_prestige = 15
	}
}

# Miraculous statue of Pimo
tarim_basin.0161 = {
	type = character_event
	title = tarim_basin.0161.t
	desc = tarim_basin.0161.desc
	theme = faith
	override_background = { event_background = RICE_background_tarim_basin_town }
	
	left_portrait = {
		character = root
		animation = personality_honorable
	}
	
	option = { # Ok
		name = tarim_basin.0161.a
		add_piety = 15
		add_prestige = 15
	}
}



######################################################################################
# 
# KARA-KHANID/ISLAMIC UIGHUR EVENTS
# 
# tarim_basin.0200-tarim_basin.0249
# 
######################################################################################


######################################################################################
# 
# AL-KASHGARI / TURKIC DICTIONARY
# 
# tarim_basin.0200-tarim_basin.0209
# 
######################################################################################

# al-Kashgari introduction
tarim_basin.0200 = {
	type = character_event
	title = tarim_basin.0200.t
	desc = tarim_basin.0200.desc
	theme = RICE_theme_tarim_basin_town
	override_icon = { reference = "gfx/interface/icons/event_types/type_learning.dds" }
	
	right_portrait = {
		character = root
		animation = war_defender
	}

	immediate = {
		show_as_tooltip = {			
			add_character_modifier = {
				modifier = RICE_tarim_basin_is_al_kashgari
			}
		}
		custom_tooltip = tarim_basin.0200.tooltip
	}
	
	option = { # Ok
		name = tarim_basin.0200.a
		custom_description_no_bullet = {
			text = tarim_basin.0200.info
		}
	}
}



# Start to Compile the Turkic Dictionary
tarim_basin.0201 = {
	type = character_event
	title = tarim_basin.0201.t
	desc = tarim_basin.0201.desc
	theme = learning
	
	right_portrait = {
		character = root
		animation = personality_callous
	}

	immediate = {
		culture:turkish = {
			save_scope_as = culture_scope
		}
		show_as_tooltip = {
			add_character_modifier = {
				modifier = RICE_tarim_basin_working_on_turkic_dictionary
			}
			stress_impact = {
				base = minor_stress_impact_gain
				lazy = minor_stress_impact_gain
			}
		}
	}

	option = { # OK
		name = tarim_basin.0201.a
		trigger_event = {
			id = tarim_basin.0202
			days = { 365 1095 }
		}
	}
}



# Finish writing the Turkic Dictionary
tarim_basin.0202 = {
	type = character_event
	title = tarim_basin.0202.t
	desc = tarim_basin.0202.desc
	theme = learning
	
	left_portrait = {
		character = root
		animation = happiness
	}

	artifact = { # To display the artifact in the event-window
		target = scope:turkic_dictionary
		position = lower_center_portrait
	}
	
	immediate = {
		save_scope_as = compiler

		play_music_cue = "mx_cue_epic_sacral_moment"

		remove_character_modifier = RICE_tarim_basin_working_on_turkic_dictionary

		add_character_modifier = {
			modifier = RICE_tarim_basin_wrote_first_turkic_dictionary	
		}

		hidden_effect_new_artifact = {
			#set_artifact_rarity_famed = yes
			create_artifact = {
				name = RICE_tarim_basin_first_turkic_dictionary_name
				description = RICE_tarim_basin_first_turkic_dictionary_desc
				type = miscellaneous
				visuals = RICE_book_placeholder					
				quality = 80
				wealth = 80
				modifier = artifact_learn_language_scheme_power_add_2_modifier
				save_scope_as = turkic_dictionary
			}
			scope:turkic_dictionary = {
				add_artifact_modifier = artifact_diplomacy_1_modifier
				add_artifact_modifier = artifact_diplomacy_1_modifier
				add_artifact_modifier = artifact_learning_1_modifier
				add_artifact_modifier = artifact_learning_1_modifier
			}
		}

		if = {
			limit = {
				is_independent_ruler = no
			}
			liege = {
				save_scope_as = liege
			}
		}

		if = {
			limit = {
				is_independent_ruler = no
				liege = {
					is_independent_ruler = no
				}
			}
			top_liege = {
				save_scope_as = top_liege
			}
		}

		if = {
			limit = {
				faith = { exists = religious_head }
				any_held_title = { is_head_of_faith = no }
			}
			faith.religious_head = {
				save_scope_as = religious_head
			}
		}

	}

	option = { # Ok
		name = tarim_basin.0202.a
		add_prestige = 400
		show_as_tooltip = {
			scope:turkic_dictionary = {
				set_owner = {
					target = root
				}
			}
		}
		if = {
			limit = {
				is_independent_ruler = no
			}
			custom_tooltip = tarim_basin.0202.copy.liege
			liege = {
				trigger_event = tarim_basin.0203	
			}
		}
		if = {
			limit = {
				is_independent_ruler = no
				liege = {
					is_independent_ruler = no
				}
			}
			custom_tooltip = tarim_basin.0202.copy.top_liege
			top_liege = {
				trigger_event = tarim_basin.0203	
			}
		}
		if = {
			limit = {
				faith = { exists = religious_head }
				any_held_title = { is_head_of_faith = no }
			}
			custom_tooltip = tarim_basin.0202.copy.religious_head
			faith.religious_head = {
				trigger_event = tarim_basin.0203	
			}
		}
	}

	after = {
		every_player = {
			limit = {
				is_ai = no
				culture = { has_cultural_pillar = heritage_turkic }
				OR = {
					culture = { has_cultural_pillar = language_turkic }
					culture = { has_cultural_pillar = language_oghur }
				}	
			}
			add_to_list = turkic_dictionary_notification_list
		}
		scope:liege = {
			add_to_list = turkic_dictionary_notification_list
			add_character_flag = RICE_tarim_basin_received_turkic_dictionary_copy
		}
		scope:top_liege = {
			add_to_list = turkic_dictionary_notification_list
			add_character_flag = RICE_tarim_basin_received_turkic_dictionary_copy
		}
		scope:religious_head = {
			add_to_list = turkic_dictionary_notification_list
			add_character_flag = RICE_tarim_basin_received_turkic_dictionary_copy
		}
		every_in_list = {
			list = turkic_dictionary_notification_list
			trigger_event = tarim_basin.0203
		}
	}

}



# Notification / Important people receive copies
tarim_basin.0203 = {
	type = character_event
	title = tarim_basin.0203.t
	desc = {
		desc = tarim_basin.0203.desc
		first_valid = {
			triggered_desc = {
				trigger = {
					has_character_flag = RICE_tarim_basin_received_turkic_dictionary_copy
				}
				desc = tarim_basin.0203.desc.copy
			}
		}
	}
	theme = learning
	
	left_portrait = {
		character = scope:compiler
		animation = personality_content
	}

	artifact = { # To display the artifact in the event-window
		target = scope:turkic_dictionary
		position = lower_center_portrait
	}
	
	immediate = {

		play_music_cue = "mx_cue_epic_sacral_moment"

		if = {
			limit = {
				has_character_flag = RICE_tarim_basin_received_turkic_dictionary_copy
			}
			hidden_effect_new_artifact = {
				#set_artifact_rarity_famed = yes
				create_artifact = {
					name = RICE_tarim_basin_first_turkic_dictionary_name
					description = RICE_tarim_basin_first_turkic_dictionary_desc
					type = miscellaneous
					visuals = RICE_book_placeholder					
					quality = 80
					wealth = 80
					modifier = artifact_learn_language_scheme_power_add_2_modifier
					save_scope_as = turkic_dictionary
				}
				scope:turkic_dictionary = {
					add_artifact_modifier = artifact_diplomacy_1_modifier
					add_artifact_modifier = artifact_diplomacy_1_modifier
					add_artifact_modifier = artifact_learning_1_modifier
					add_artifact_modifier = artifact_learning_1_modifier
				}
			}
		}
	}

	option = { # Ok
		name = tarim_basin.0203.a
		if = {
			limit = {
				has_character_flag = RICE_tarim_basin_received_turkic_dictionary_copy
			}
			show_as_tooltip = {
				scope:turkic_dictionary = {
					set_owner = {
						target = root
					}
				}
			}
		}
	}

	after = {
		if = {
			limit = {
				has_character_flag = RICE_tarim_basin_received_turkic_dictionary_copy
			}
			remove_character_flag = RICE_tarim_basin_received_turkic_dictionary_copy
		}
	}

}


# Character dies before completing the Turkic dictionary
tarim_basin.0204 = {
	type = empty
	hidden = yes
	
	trigger = {
		is_target_in_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:RICE_tarim_basin_compile_turkic_dictionary_done
		}
		has_character_modifier = RICE_tarim_basin_working_on_turkic_dictionary
	}
	
	immediate = {
		save_scope_as = compiler
		culture:turkish = {
			save_scope_as = culture_scope
		}
		if = {
			limit = {
				exists = primary_heir
			}
			primary_heir = {
				trigger_event = {
					id = tarim_basin.0205
					days = 1
				}
			}
		}
		# If heir doesn't exist for some reason, quietly re-enable it
		else = {
			remove_list_global_variable = {
				name = unavailable_unique_decisions
				target = flag:RICE_tarim_basin_compile_turkic_dictionary_done
			}
		}
	}
}




# Finish writing the Turkic Dictionary (compiler passed away version)
tarim_basin.0205 = {
	type = character_event
	title = tarim_basin.0205.t
	desc = tarim_basin.0205.desc
	theme = learning
	
	left_portrait = {
		character = scope:compiler
		animation = personality_content
	}
	right_portrait = {
		character = root
		animation = personality_rational
	}

	artifact = { # To display the artifact in the event-window
		target = scope:turkic_dictionary
		position = lower_center_portrait
	}
	
	immediate = {
		save_scope_as = compiler_heir

		play_music_cue = "mx_cue_epic_sacral_moment"

		remove_character_modifier = RICE_tarim_basin_working_on_turkic_dictionary

		add_character_modifier = {
			modifier = RICE_tarim_basin_wrote_first_turkic_dictionary
			years = 10	
		}

		hidden_effect_new_artifact = {
			#set_artifact_rarity_famed = yes
			create_artifact = {
				name = RICE_tarim_basin_first_turkic_dictionary_name
				description = RICE_tarim_basin_first_turkic_dictionary_desc
				type = miscellaneous
				visuals = RICE_book_placeholder					
				quality = 40
				wealth = 40
				modifier = artifact_learn_language_scheme_power_add_1_modifier
				save_scope_as = turkic_dictionary
			}
			scope:turkic_dictionary = {
				add_artifact_modifier = artifact_diplomacy_1_modifier
				add_artifact_modifier = artifact_learning_1_modifier
			}
		}

		if = {
			limit = {
				is_independent_ruler = no
			}
			liege = {
				save_scope_as = liege
			}
		}

		if = {
			limit = {
				is_independent_ruler = no
				liege = {
					is_independent_ruler = no
				}
			}
			top_liege = {
				save_scope_as = top_liege
			}
		}

		if = {
			limit = {
				faith = { exists = religious_head }
				any_held_title = { is_head_of_faith = no }
			}
			faith.religious_head = {
				save_scope_as = liege
			}
		}

	}

	option = { # Ok
		name = tarim_basin.0205.a
		add_prestige = 100
		show_as_tooltip = {
			scope:turkic_dictionary = {
				set_owner = {
					target = root
				}
			}
		}
		if = {
			limit = {
				is_independent_ruler = no
			}
			custom_tooltip = tarim_basin.0202.copy.liege
			liege = {
				trigger_event = tarim_basin.0206	
			}
		}
		if = {
			limit = {
				is_independent_ruler = no
				liege = {
					is_independent_ruler = no
				}
			}
			custom_tooltip = tarim_basin.0202.copy.top_liege
			top_liege = {
				trigger_event = tarim_basin.0206	
			}
		}
		if = {
			limit = {
				scope:compiler.faith = { exists = religious_head }
				any_held_title = { is_head_of_faith = no }
			}
			custom_tooltip = tarim_basin.0205.copy.religious_head
			scope:compiler.faith.religious_head = {
				trigger_event = tarim_basin.0206	
			}
		}
	}

	after = {
		every_player = {
			limit = {
				is_ai = no
				culture = { has_cultural_pillar = heritage_turkic }
				OR = {
					culture = { has_cultural_pillar = language_turkic }
					culture = { has_cultural_pillar = language_oghur }
				}	
			}
			add_to_list = turkic_dictionary_notification_list
		}
		scope:liege = {
			add_to_list = turkic_dictionary_notification_list
			add_character_flag = RICE_tarim_basin_received_turkic_dictionary_copy
		}
		scope:top_liege = {
			add_to_list = turkic_dictionary_notification_list
			add_character_flag = RICE_tarim_basin_received_turkic_dictionary_copy
		}
		scope:religious_head = {
			add_to_list = turkic_dictionary_notification_list
			add_character_flag = RICE_tarim_basin_received_turkic_dictionary_copy
		}
		every_in_list = {
			list = turkic_dictionary_notification_list
			trigger_event = tarim_basin.0206
		}
	}

}




# Important people receive copies (compiler passed away version)
tarim_basin.0206 = {
	type = character_event
	title = tarim_basin.0206.t
	desc = {
		desc = tarim_basin.0206.desc
		first_valid = {
			triggered_desc = {
				trigger = {
					has_character_flag = RICE_tarim_basin_received_turkic_dictionary_copy
				}
				desc = tarim_basin.0206.desc.copy
			}
		}
	}
	theme = learning
	
	left_portrait = {
		character = scope:compiler
		animation = personality_content
	}
	right_portrait = {
		character = scope:compiler_heir
		animation = admiration
	}

	artifact = { # To display the artifact in the event-window
		target = scope:turkic_dictionary
		position = lower_center_portrait
	}
	
	immediate = {

		play_music_cue = "mx_cue_epic_sacral_moment"

		if = {
			limit = {
				has_character_flag = RICE_tarim_basin_received_turkic_dictionary_copy
			}
			hidden_effect_new_artifact = {
				#set_artifact_rarity_famed = yes
				create_artifact = {
					name = RICE_tarim_basin_first_turkic_dictionary_name
					description = RICE_tarim_basin_first_turkic_dictionary_desc
					type = miscellaneous
					visuals = RICE_book_placeholder					
					quality = 40
					wealth = 40
					modifier = artifact_learn_language_scheme_power_add_1_modifier
					save_scope_as = turkic_dictionary
				}
				scope:turkic_dictionary = {
					add_artifact_modifier = artifact_diplomacy_1_modifier
					add_artifact_modifier = artifact_learning_1_modifier
				}
			}
		}
	}

	option = { # Ok
		name = tarim_basin.0206.a
		if = {
			limit = {
				has_character_flag = RICE_tarim_basin_received_turkic_dictionary_copy
			}
			show_as_tooltip = {
				scope:turkic_dictionary = {
					set_owner = {
						target = root
					}
				}
			}
		}
	}

	after = {
		if = {
			limit = {
				has_character_flag = RICE_tarim_basin_received_turkic_dictionary_copy
			}
			remove_character_flag = RICE_tarim_basin_received_turkic_dictionary_copy
		}
	}

}



# Al-Kashgari dies
tarim_basin.0207 = {
	type = empty
	hidden = yes
	
	trigger = {
		NOT = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:RICE_tarim_basin_compile_turkic_dictionary_done
			}
		}
		has_character_modifier = RICE_tarim_basin_is_al_kashgari
	}
	
	immediate = {
		# Enable it for anyone now that Al-Kashgari has passed away
		set_global_variable = {
			name = RICE_anyone_can_write_turkic_dictionary
			value = yes
		}
	}
}





######################################################################################
# 
# EIGHT PROTECTORS
# 
# tarim_basin.0170-tarim_basin.0179
# 
######################################################################################


# Change Khotan's Eight Protectors ruler modifier (for title transition)
tarim_basin.0170 = {
	hidden = yes
	
	trigger = {
		scope:title = title:c_khotan
		NOT = { has_global_variable = RICE_tarim_basin_khotan_eight_protectors_abandoned }
	}
	
	immediate = {
		if = {
			limit = {
				religion = religion:buddhism_religion
				scope:previous_holder = { 
					is_alive = yes
					has_character_modifier = RICE_tarim_basin_khotan_eight_protectors
					NOT = {
						has_title = title:c_khotan
					}
				}
			}
			scope:previous_holder = { remove_character_modifier = RICE_tarim_basin_khotan_eight_protectors }
			add_character_modifier = {
				modifier = RICE_tarim_basin_khotan_eight_protectors
			}
		}
		else_if = {
			limit = {
				RICE_tarim_basin_eight_protectors_remain_trigger = no
				NOT = {
					any_liege_or_above = {
						RICE_tarim_basin_eight_protectors_remain_trigger = yes
					}
				}
			}
			save_scope_as = khotan_new_ruler
			RICE_tarim_basin_eight_protectors_abandoned_effect = yes
			every_player = {
				limit = {
					is_ai = no
					any_held_title = {
						tier = tier_county
						any_county_province = {
							geographical_region = RICE_land_silk_road_region
						}
					}	
				}
				trigger_event = {
					id = tarim_basin.0172
					days = 1
				}
			}
		}
	}
}

# Change Khotan's Eight Protectors ruler modifier (for religious conversion)
tarim_basin.0171 = {
	hidden = yes
	
	trigger = {
		has_title = title:c_khotan
		NOT = { has_global_variable = RICE_tarim_basin_khotan_eight_protectors_abandoned }
	}
	
	immediate = {
		# Lose it if you convert away from Buddhism
		if = {
			limit = {
				NOT = { religion = religion:buddhism_religion }
			}
			remove_character_modifier = RICE_tarim_basin_khotan_eight_protectors
			if = {
				limit = {
					RICE_tarim_basin_eight_protectors_remain_trigger = no
					NOT = {
						any_liege_or_above = {
							RICE_tarim_basin_eight_protectors_remain_trigger = yes
						}
					}
				}
				save_scope_as = khotan_new_ruler
				RICE_tarim_basin_eight_protectors_abandoned_effect = yes
				every_player = {
					limit = {
						is_ai = no
						any_held_title = {
							tier = tier_county
							any_county_province = {
								geographical_region = RICE_land_silk_road_region
							}
						}	
					}
					trigger_event = {
						id = tarim_basin.0172
						days = 1
					}
				}
			}
		}
		# Gain it if you convert away to Buddhism
		if = {
			limit = {
				religion = religion:buddhism_religion
			}
			add_character_modifier = {
				modifier = RICE_tarim_basin_khotan_eight_protectors
			}
		}
	}
}



# Khotan is ruled by someone unfriendly to Buddhists, and the monks flee
tarim_basin.0172 = {
	type = character_event
	title = tarim_basin.0172.t
	desc = tarim_basin.0172.desc
	theme = faith
	#override_background = { event_background = burning_building }

	right_portrait = {
		character = scope:khotan_new_ruler
		animation = personality_callous
	}

	immediate = {
		play_music_cue = "mx_cue_sacredrite"
		title:c_khotan = { #For loc.
			save_scope_as = khotan
		}
		show_as_tooltip = {
			scope:khotan_new_ruler = {
				RICE_tarim_basin_eight_protectors_abandoned_effect = yes
			}
		}
	}

	# Ok
	option = {
		name = tarim_basin.0172.a
		trigger = {
			NOT = { religion = religion:buddhism_religion }
		}
		custom_tooltip = tarim_basin.0172.tooltip.1
		custom_tooltip = tarim_basin.0172.tooltip.2
	}
	option = {
		name = tarim_basin.0172.b
		trigger = {
			religion = religion:buddhism_religion
		}
		custom_tooltip = tarim_basin.0172.tooltip.1
		custom_tooltip = tarim_basin.0172.tooltip.2
	}

}