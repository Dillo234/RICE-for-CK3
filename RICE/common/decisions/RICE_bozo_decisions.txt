


RICE_bozo_establish_wangara_decision = {
	picture = "gfx/interface/illustrations/decisions/decision_RICE_gold.dds"
	major = yes
	desc = RICE_bozo_establish_wangara_decision_desc

	ai_check_interval = 120

	is_shown = {
		NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
		is_landed = yes
		NOT = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:RICE_bozo_wangara_decision_done
			}
		}
		
		capital_province = {
			geographical_region = world_africa_west
		}
	}

	is_valid = {

		culture = {			
			OR = {
				has_cultural_pillar = heritage_sahelian
				has_cultural_pillar = heritage_west_african
			}
		}
		
		# Needs to be a ruler of some level of power
		highest_held_title_tier >= tier_duchy
		sub_realm_size >= 10


		# Own at least two of the Mali mines
		any_culture_county = {
			count >= 2
			any_county_province = {
				has_building_or_higher = mali_mines_01
			}
		}

		# Completely control at least 2 mines
		# calc_true_if = {
		# 	amount >= 2
		# 	AND = {
		# 		completely_controls = title:c_bambuk
		# 		title:b_bambuk.title_province = {
		# 			has_building_or_higher = mali_mines_01
		# 		}
		# 	}
		# 	completely_controls = title:c_bure
		# 	completely_controls = title:c_niani
		# }

	}

	is_valid_showing_failures_only = {
		is_adult = yes
		RICE_is_available_adult_even_if_sick_trigger = yes
	}

	cost = {
		gold = {
			value = medium_gold_value
		}
		prestige = {
			value = medium_prestige_value
		}
	}

	effect = {

		#Can only happen once
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:RICE_bozo_wangara_decision_done
		}

		save_scope_as = wangara_founder

		show_as_tooltip = {
			RICE_bozo_establish_wangara_effect = yes
		}
		
		custom_tooltip = RICE_bozo_establish_wangara_decision_effect_tooltip_1
		custom_tooltip = RICE_bozo_establish_wangara_decision_effect_tooltip_2

		
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_bozo_establish_wangara_decision_context_tooltip
		}

		every_player = {
			limit = {
				OR = {
					this = scope:wangara_founder	
					any_held_county = {
						any_county_province = {
							geographical_region = world_africa_west
						}
					}
				}
			}
			trigger_event = bozo.8888
		}
	}

	ai_will_do = {
		base = 15

		modifier = {
			add = 10
			has_trait = ambitious
		}
		modifier = {
			add = -10
			has_trait = lazy
		}
		modifier = {
			add = 10
			has_trait = greedy
		}
		modifier = {
			add = -10
			has_trait = paranoid
		}

	}
}


RICE_bozo_mud_masons_decision = {
	picture = "gfx/interface/illustrations/decisions/decision_RICE_mosque_of_djenne.dds"
	ai_check_interval = 40
	
	cooldown = { days = 3650 }

	
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					culture = { has_cultural_tradition = tradition_RICE_african_mud_masons }
				}
				desc = RICE_bozo_mud_masons_decision_desc
			}
			desc = RICE_bozo_mud_masons_decision_desc_not_culture
		}
	}
	selection_tooltip = RICE_bozo_mud_masons_decision_tooltip

	is_shown = {
		highest_held_title_tier > tier_barony
		is_landed = yes
		OR = {
			has_title = title:c_jenne
			culture = { has_cultural_tradition = tradition_RICE_african_mud_masons }
			any_held_title = {
				tier = tier_county
				culture = {
					has_cultural_tradition = tradition_RICE_african_mud_masons
				}
			}
		}
	}
	
	is_valid = {
		OR = {
			has_title = title:c_jenne
			culture = { has_cultural_tradition = tradition_RICE_african_mud_masons }
			any_held_title = {
				tier = tier_county
				culture = {
					has_cultural_tradition = tradition_RICE_african_mud_masons
				}
			}
		}
	}
	
	is_valid_showing_failures_only = {
		RICE_is_available_adult_even_if_sick_trigger = yes
	}


		
    widget = {
    	gui = "decision_view_widget_RICE_bozo_mud_masons_decision"
		controller = decision_option_list_controller
    	
		decision_has_second_step = yes
		decision_custom_widget_container = "custom_widgets_container_step_two"
		decision_to_second_step_button = "RICE_bozo_mud_masonry_work_type" 

		item = {
			value = RICE_bozo_mud_masons_general_option
			current_description = RICE_bozo_mud_masons_general_option_desc
			localization = RICE_bozo_mud_masons_general_option
			icon = "gfx/interface/icons/widgets/RICE_tribal_holding.dds"

			ai_chance = {
				value = 10
			}
		}

		item = {		
			is_valid = {
				any_held_title = {
					tier = tier_county
					any_county_province = {
						has_holding_type = castle_holding
					}
				}
			}
			value = RICE_bozo_mud_masons_castle_option
			current_description = RICE_bozo_mud_masons_castle_option_desc
			localization = RICE_bozo_mud_masons_castle_option
			icon = "gfx/interface/icons/widgets/RICE_castle_holding.dds"

			ai_chance = {
				value = 10
			}
		}

		item = {		
			is_valid = {
				any_held_title = {
					tier = tier_county
					any_county_province = {
						has_holding_type = city_holding
					}
				}
			}
			value = RICE_bozo_mud_masons_city_option
			current_description = RICE_bozo_mud_masons_city_option_desc
			localization = RICE_bozo_mud_masons_city_option
			icon = "gfx/interface/icons/widgets/RICE_city_holding.dds"

			ai_chance = {
				value = 10
			}
		}

		item = {		
			is_valid = {
				any_held_title = {
					tier = tier_county
					any_county_province = {
						has_holding_type = church_holding
					}
				}
			}
			value = RICE_bozo_mud_masons_church_option
			current_description = RICE_bozo_mud_masons_church_option_desc
			localization = RICE_bozo_mud_masons_church_option
			icon = "gfx/interface/icons/widgets/RICE_church_holding.dds"

			ai_chance = {
				value = 10
			}
		}



	}

	effect = {

		custom_tooltip = RICE_bozo_mud_masons_decision_effect_tooltip_1
		custom_tooltip = RICE_bozo_mud_masons_decision_effect_tooltip_2
				
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_bozo_mud_masons_decision_context_tooltip
		}

		# Not sure why AI can't pick one option or another
		if = {
			limit = { is_ai = yes }
			random_list = {
				10 = {
					set_variable = {
						name = RICE_bozo_mud_masonry_work_type
						value = flag:general
					}
				}
				10 = {
					trigger = {
						any_held_title = {
							tier = tier_county
							any_county_province = {
								has_holding_type = castle_holding
							}
						}
					}
					set_variable = {
						name = RICE_bozo_mud_masonry_work_type
						value = flag:castle
					}
				}
				10 = {
					trigger = {
						any_held_title = {
							tier = tier_county
							any_county_province = {
								has_holding_type = city_holding
							}
						}
					}
					set_variable = {
						name = RICE_bozo_mud_masonry_work_type
						value = flag:city
					}
				}
				10 = {
					trigger = {
						any_held_title = {
							tier = tier_county
							any_county_province = {
								has_holding_type = church_holding
							}
						}
					}
					set_variable = {
						name = RICE_bozo_mud_masonry_work_type
						value = flag:church
					}
				}
			}
		}
		else_if = {
			limit = {
				scope:RICE_bozo_mud_masons_general_option = yes
			}
			set_variable = {
				name = RICE_bozo_mud_masonry_work_type
				value = flag:general
			}
		}
		else_if = {
			limit = {
				scope:RICE_bozo_mud_masons_castle_option = yes
			}
			set_variable = {
				name = RICE_bozo_mud_masonry_work_type
				value = flag:castle
			}
		}
		else_if = {
			limit = {
				scope:RICE_bozo_mud_masons_city_option = yes
			}
			set_variable = {
				name = RICE_bozo_mud_masonry_work_type
				value = flag:city
			}
		}
		else_if = {
			limit = {
				scope:RICE_bozo_mud_masons_church_option = yes
			}
			set_variable = {
				name = RICE_bozo_mud_masonry_work_type
				value = flag:church
			}
		}
		
		#trigger_event = normandy.0020
	}

	cost = { 
		gold = { value = RICE_activity_cost } # Will depend
	}	

	ai_potential = {
		short_term_gold > RICE_activity_cost
	}

	ai_will_do = {
		base = 30
		modifier = {
			add = 10
			has_trait = ambitious
		}
		modifier = {
			add = -10
			has_trait = content
		}
		modifier = {
			add = 10
			has_trait = diligent
		}
		modifier = {
			add = -10
			has_trait = lazy
		}
	}
}

