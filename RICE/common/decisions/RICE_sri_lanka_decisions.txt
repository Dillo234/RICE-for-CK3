
#############################################
#											#
# STRUGGLE ENDING DECISIONS				    #
#											#
#############################################

# Unite the Sangha Ending
RICE_sri_lanka_struggle_ending_unite_sangha_decision = {
	major = yes
	title = RICE_sri_lanka_struggle_ending_unite_sangha_decision
	picture = "gfx/interface/illustrations/decisions/decision_rice_ancient_buddhist_holy_site.dds"
	extra_picture = "gfx/interface/illustrations/struggle_decisions_buttons/decision_rice_ancient_buddhist_holy_site_small.dds"
	desc = RICE_sri_lanka_struggle_ending_unite_sangha_decision_desc
	selection_tooltip = RICE_sri_lanka_struggle_ending_unite_sangha_decision_tooltip
	confirm_click_sound = "event:/DLC/FP2/SFX/UI/fp2_struggle_ending_decision_confirm"
	is_invisible = yes

	sort_order = 80

	is_valid = {
		is_independent_ruler = yes

		exists = struggle:RICE_sri_lanka_struggle

		custom_tooltip = {
			text = struggle_ending_decision_correct_involvement_tt
			any_character_struggle = {
				involvement = involved
				is_struggle_type = RICE_sri_lanka_struggle
			}
		}

		OR = {
			religion = religion:buddhism_religion
			faith = { has_doctrine = doctrine_pluralism_pluralistic }
		}

		OR = {
			AND = {
				custom_tooltip = {
					text = RICE_sri_lanka_struggle_ending_unite_decision_mahavihara_tt
					global_var:RICE_mahavihara_prominence >= 900
				}
				has_trait_xp = {
					trait = RICE_mahavihara_trait
					value >= 40
				}
				#has_trait = RICE_mahavihara_trait
			}
			AND = {
				custom_tooltip = {
					text = RICE_sri_lanka_struggle_ending_unite_decision_abhayagiri_tt
					global_var:RICE_abhayagiri_prominence >= 900
				}
				has_trait_xp = {
					trait = RICE_abhayagiri_trait
					value >= 40
				}
				#has_trait = RICE_abhayagiri_trait
			}
			AND = {
				custom_tooltip = {
					text = RICE_sri_lanka_struggle_ending_unite_decision_jetavana_tt
					global_var:RICE_jetavana_prominence >= 900
				}
				has_trait_xp = {
					trait = RICE_jetavana_trait
					value >= 40
				}
				#has_trait = RICE_jetavana_trait
			}
		}

		OR = {
			AND = {			
				has_title = title:k_lanka
				completely_controls = title:k_lanka
				piety_level >= 2
			}
			AND = {
				# Completely control at least 2 of 3 Sri Lankan duchies
				calc_true_if = {
					amount >= 2
					completely_controls = title:d_dakhina_desa
					completely_controls = title:d_ruhunu
					completely_controls = title:d_sinhala
				}
				piety_level >= 3
			}
			piety_level >= 4
		}

		

	}

	effect = {

		save_scope_as = sri_lanka_struggle_ender

		##### Major Effects #####
		#show_as_tooltip = {
		#	RICE_sri_lanka_struggle_ending_uniter_effect = yes
		#}
		# Pali Canon doctrine
		custom_tooltip = RICE_sri_lanka_struggle_ending_uniter_pali_canon_doctrine_effect_tt
		# Phase doctrine
		custom_tooltip = RICE_sri_lanka_struggle_ending_uniter_phase_doctrine_effect_tt
		# Relic effect
		custom_tooltip = RICE_sri_lanka_struggle_ending_uniter_relic_effect_tt

		# Trigger the ending event
		trigger_event = sri_lanka.0007
	}

	cost = {}

	ai_check_interval = 120

	ai_potential = { always = yes }

	ai_will_do = { base = 100 }
}

# Destroy the Sangha Ending
RICE_sri_lanka_struggle_ending_destroy_sangha_decision = {
	major = yes
	title = RICE_sri_lanka_struggle_ending_destroy_sangha_decision
	picture = "gfx/interface/illustrations/decisions/decision_RICE_burning_building.dds"
	extra_picture = "gfx/interface/illustrations/struggle_decisions_buttons/decision_RICE_burning_building_small.dds"
	desc = RICE_sri_lanka_struggle_ending_destroy_sangha_decision_desc
	selection_tooltip = RICE_sri_lanka_struggle_ending_destroy_sangha_decision_tooltip
	confirm_click_sound = "event:/DLC/FP2/SFX/UI/fp2_struggle_ending_decision_confirm"
	is_invisible = yes

	sort_order = 80

	is_valid = {
		is_independent_ruler = yes

		exists = struggle:RICE_sri_lanka_struggle

		custom_tooltip = {
			text = struggle_ending_decision_correct_involvement_tt
			any_character_struggle = {
				involvement = involved
				is_struggle_type = RICE_sri_lanka_struggle
			}
		}

		NOT = { religion = religion:buddhism_religion }


		custom_tooltip = {
			text = RICE_sri_lanka_struggle_ending_destroy_decision_mahavihara_tt
			global_var:RICE_mahavihara_prominence < 100
		}

		custom_tooltip = {
			text = RICE_sri_lanka_struggle_ending_destroy_decision_abhayagiri_tt
			global_var:RICE_abhayagiri_prominence < 100
		}

		custom_tooltip = {
			text = RICE_sri_lanka_struggle_ending_destroy_decision_jetavana_tt
			global_var:RICE_jetavana_prominence < 100
		}

		NOR = {
			has_trait = RICE_mahavihara_trait
			has_trait = RICE_abhayagiri_trait
			has_trait = RICE_jetavana_trait
		}

		has_title = title:k_lanka
		completely_controls = title:k_lanka

		
		prestige_level >= 2

	}

	effect = {

		save_scope_as = sri_lanka_struggle_destroyer

		##### Major Effects #####
		show_as_tooltip = {
			RICE_sri_lanka_struggle_ending_destroyer_effect = yes
		}
		# Doctrine
		custom_tooltip = RICE_sri_lanka_struggle_ending_uniter_destroyer_doctrine_effect

		# Trigger the ending event
		trigger_event = sri_lanka.8888
	}

	cost = {}

	ai_check_interval = 120

	ai_potential = { always = yes }

	ai_will_do = { base = 100 }
}




#############################################
#											#
# OTHER DECISIONS						    #
#											#
#############################################


RICE_india_irrigation_tank_decision = {
	picture = "gfx/interface/illustrations/decisions/decision_rice_indian_agriculture.dds"
	desc = RICE_india_irrigation_tank_decision_desc

	ai_check_interval = 48

	is_shown = {
		OR = {
			capital_province = {
				geographical_region = world_india
			}
			culture = {			
				has_innovation = innovation_RICE_irrigation_tanks
			}

		}	
	}

	is_valid = {
		culture = {			
			has_innovation = innovation_RICE_irrigation_tanks
		}
	}

	is_valid_showing_failures_only = {
		is_available_adult = yes
	}

	cost = {
		gold = {
			value = medium_gold_value
		}
		prestige = {
			value = medium_prestige_value
		}
	}

	effect = {
		
		custom_tooltip = RICE_india_irrigation_tank_decision_effect_tooltip_1
		custom_tooltip = RICE_india_irrigation_tank_decision_effect_tooltip_2

		show_as_tooltip = {
			RICE_india_irrigation_tank_decision_effect = yes
		}

		
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_india_irrigation_tank_decision_context_tooltip
		}

		trigger_event = sri_lanka.8888
	}

	ai_will_do = {
		base = 30

		modifier = {
			add = 10
			has_trait = ambitious
		}
		modifier = {
			add = -10
			has_trait = greedy
		}
		modifier = {
			add = 10
			has_trait = diligent
		}
		modifier = {
			add = -10
			has_trait = lazy
		}

	}
}


RICE_sri_lanka_choose_monastic_sect = {
	picture = "gfx/interface/illustrations/decisions/decision_rice_ancient_buddhist_holy_site.dds"
	major = yes
	desc = RICE_sri_lanka_choose_monastic_sect_desc

	ai_check_interval = 48

	cooldown = { days = 3650 }

	is_shown = {
		RICE_sri_lanka_struggle_decisions_light_trigger = yes
		NOR = {
			has_trait = RICE_mahavihara_trait
			has_trait = RICE_abhayagiri_trait
			has_trait = RICE_jetavana_trait
		}
		NOT = { has_character_flag = RICE_picking_sri_lankan_monastery }
	}
	is_valid = {

		RICE_sri_lanka_struggle_decisions_trigger = yes

	}

	is_valid_showing_failures_only = {
		is_adult = yes
		RICE_is_available_adult_even_if_sick_trigger = yes
	}

	cost = {
		gold = {
			value = major_gold_value
		}
	}

	effect = {
		
		custom_tooltip = RICE_sri_lanka_choose_monastic_sect_effect_tooltip_1
		custom_tooltip = RICE_sri_lanka_choose_monastic_sect_effect_tooltip_2

		
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_sri_lanka_choose_monastic_sect_context_tooltip
		}

		trigger_event = sri_lanka.0020
	}

	ai_will_do = {
		base = 15

		modifier = {
			add = 10
			has_trait = ambitious
		}
		modifier = {
			add = -10
			has_trait = lazy
		}
		modifier = {
			add = 10
			has_trait = zealous
		}
		modifier = {
			add = -10
			has_trait = cynical
		}

	}
}

RICE_sri_lanka_change_monastic_sect = {
	picture = "gfx/interface/illustrations/decisions/decision_rice_ancient_buddhist_holy_site.dds"
	major = yes
	desc = RICE_sri_lanka_change_monastic_sect_desc

	ai_check_interval = 64

	cooldown = { days = 3650 }

	is_shown = {
		RICE_sri_lanka_struggle_decisions_light_trigger = yes
		OR = {
			has_trait = RICE_mahavihara_trait
			has_trait = RICE_abhayagiri_trait
			has_trait = RICE_jetavana_trait
		}
		#NOT = { has_character_flag = RICE_picking_sri_lankan_monastery }
	}
	is_valid = {

		OR = {
			has_trait = RICE_mahavihara_trait
			has_trait = RICE_abhayagiri_trait
			has_trait = RICE_jetavana_trait
		}

		RICE_sri_lanka_struggle_decisions_trigger = yes

	}

	is_valid_showing_failures_only = {
		is_adult = yes
		RICE_is_available_adult_even_if_sick_trigger = yes
	}

	cost = {
		gold = {
			value = major_gold_value
		}
	}

	effect = {

		if = {
			limit = {
				has_trait = RICE_mahavihara_trait
			}
			show_as_tooltip = {
				remove_trait = RICE_mahavihara_trait
			}
			custom_tooltip = RICE_sri_lanka_change_monastic_sect_effect_tooltip_1
		}
		else_if = {
			limit = {
				has_trait = RICE_abhayagiri_trait
			}
			show_as_tooltip = {
				remove_trait = RICE_abhayagiri_trait
			}
			custom_tooltip = RICE_sri_lanka_change_monastic_sect_effect_tooltip_2
		}
		else_if = {
			limit = {
				has_trait = RICE_jetavana_trait
			}
			show_as_tooltip = {
				remove_trait = RICE_jetavana_trait
			}
			custom_tooltip = RICE_sri_lanka_change_monastic_sect_effect_tooltip_3
		}

		custom_tooltip = RICE_sri_lanka_change_monastic_sect_effect_tooltip_4
		custom_tooltip = RICE_sri_lanka_change_monastic_sect_effect_tooltip_5
		

		
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_sri_lanka_change_monastic_sect_context_tooltip
		}

		trigger_event = sri_lanka.0021
	}

	ai_will_do = {
		base = 5

		modifier = {
			add = 5
			has_trait = fickle
		}
		modifier = {
			add = -5
			has_trait = zealous
		}

	}
}



RICE_india_land_grant_decision = {
	picture = "gfx/interface/illustrations/decisions/decision_indian_temple.dds"
	ai_check_interval = 40
	
	cooldown = { days = 3650 }

	
	desc = RICE_india_land_grant_decision_desc
	selection_tooltip = RICE_india_land_grant_decision_tooltip

	is_shown = {
		highest_held_title_tier > tier_barony
		is_landed = yes
		OR = {
			religion = religion:buddhism_religion
			religion = religion:hinduism_religion
			religion = religion:jainism_religion
		}
	}
	
	is_valid = {
		OR = {
			religion = religion:buddhism_religion
			religion = religion:hinduism_religion
			religion = religion:jainism_religion
		}
		custom_description = {
			text = "RICE_india_land_grant_decision_req"
			any_held_title = {
				tier = tier_county
				any_county_province = {
					geographical_region = world_india
				}
			}
		}
	}
	
	is_valid_showing_failures_only = {
		is_available_adult = yes
	}


		
    widget = {
    	gui = "decision_view_widget_RICE_india_land_grant_decision"
		controller = decision_option_list_controller
    	
		decision_has_second_step = yes
		decision_custom_widget_container = "custom_widgets_container_step_two"
		decision_to_second_step_button = "RICE_india_land_grant_type" 

		item = {							
			value = RICE_india_land_grant_buddhism_option
			current_description = RICE_india_land_grant_buddhism_option_desc
			localization = RICE_india_land_grant_buddhism_option
			icon = "gfx/interface/icons/widgets/RICE_buddhism_generic_widget.dds"

			ai_chance = {
				value = 10
			}
		}

		item = {						
			value = RICE_india_land_grant_hinduism_option
			current_description = RICE_india_land_grant_hinduism_option_desc
			localization = RICE_india_land_grant_hinduism_option
			icon = "gfx/interface/icons/widgets/RICE_hinduism_generic_widget.dds"

			ai_chance = {
				value = 10
			}
		}

		item = {						
			value = RICE_india_land_grant_jainism_option
			current_description = RICE_india_land_grant_jainism_option_desc
			localization = RICE_india_land_grant_jainism_option
			icon = "gfx/interface/icons/widgets/RICE_jainism_generic_widget.dds"

			ai_chance = {
				value = 10
			}
		}


	}

	effect = {

		custom_tooltip = RICE_india_land_grant_decision_effect_tooltip_1	
		custom_tooltip = RICE_india_land_grant_decision_effect_tooltip_2
		custom_tooltip = RICE_india_land_grant_decision_effect_tooltip_3
		custom_tooltip = RICE_india_land_grant_decision_effect_tooltip_4
		custom_tooltip = RICE_india_land_grant_decision_effect_tooltip_5

		if = {
			limit = {
				OR = {
					has_trait = RICE_mahavihara_trait
					has_trait = RICE_abhayagiri_trait
					has_trait = RICE_jetavana_trait
				}
			}
			custom_tooltip = RICE_sri_lanka_prominence_bonus
		}
		
						
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_india_land_grant_decision_context_tooltip
		}

		# Not sure why AI can't pick one option or another
		if = {
			limit = { is_ai = yes }
			random_list = {
				10 = {
					trigger = {
						any_held_title = {
							tier = tier_county
							religion = religion:buddhism_religion
						}
					}
					set_variable = {
						name = RICE_india_land_grant_type
						value = flag:buddhism
					}
				}
				10 = {
					trigger = {
						any_held_title = {
							tier = tier_county
							religion = religion:hinduism_religion
						}
					}
					set_variable = {
						name = RICE_india_land_grant_type
						value = flag:hinduism
					}
				}
				10 = {
					trigger = {
						any_held_title = {
							tier = tier_county
							religion = religion:jainism_religion
						}
					}
					set_variable = {
						name = RICE_india_land_grant_type
						value = flag:jainism
					}
				}
			}
		}
		else_if = {
			limit = {
				scope:RICE_india_land_grant_buddhism_option = yes
			}
			set_variable = {
				name = RICE_india_land_grant_type
				value = flag:buddhism
			}
		}
		else_if = {
			limit = {
				scope:RICE_india_land_grant_hinduism_option = yes
			}
			set_variable = {
				name = RICE_india_land_grant_type
				value = flag:hinduism
			}
		}
		else_if = {
			limit = {
				scope:RICE_india_land_grant_jainism_option = yes
			}
			set_variable = {
				name = RICE_india_land_grant_type
				value = flag:jainism
			}
		}

		
		trigger_event = sri_lanka.0010
	}

	cost = { 
		gold = { value = RICE_india_grant_decision_cost } # Will depend
	}	

	ai_potential = {
		short_term_gold > RICE_india_grant_decision_cost
	}

	ai_will_do = {
		base = 30
		modifier = {
			add = 10
			has_trait = ambitious
		}
		modifier = {
			add = -10
			has_trait = lazy
		}
		modifier = {
			add = 10
			has_trait = generous
		}
		modifier = {
			add = -10
			has_trait = greedy
		}
		modifier = {
			add = 10
			has_trait = zealous
		}
		modifier = {
			add = -10
			has_trait = cynical
		}
	}
}





RICE_sri_lanka_support_monastery = {
	picture = "gfx/interface/illustrations/decisions/decision_ck2_roi_large_temple.dds"
	ai_check_interval = 40
	
	cooldown = { days = 3650 }

	
	desc = RICE_sri_lanka_support_monastery_desc
	selection_tooltip = RICE_sri_lanka_support_monastery_tooltip

	is_shown = {
		highest_held_title_tier > tier_barony
		is_landed = yes

		RICE_sri_lanka_struggle_decisions_light_trigger = yes		
	}
	
	is_valid = {

		RICE_sri_lanka_struggle_decisions_trigger = yes
		OR = {
			has_trait = RICE_mahavihara_trait
			has_trait = RICE_abhayagiri_trait
			has_trait = RICE_jetavana_trait
		}
	}
	
	is_valid_showing_failures_only = {
		is_available_adult = yes
	}

	widget = {
		gui = "decision_view_widget_RICE_sri_lanka_progressbars_all"
	}
		
    widget = {
    	gui = "decision_view_widget_RICE_sri_lanka_support_monastery"
		controller = decision_option_list_controller
    	
		decision_has_second_step = yes
		decision_custom_widget_container = "custom_widgets_container_step_two"
		decision_to_second_step_button = "RICE_sri_lanka_support_monastery_type" 

		item = {	
			value = RICE_sri_lanka_support_monastery_almsgiving_option
			current_description = RICE_sri_lanka_support_monastery_almsgiving_option_desc
			localization = RICE_sri_lanka_support_monastery_almsgiving_option
			icon = "gfx/interface/icons/widgets/RICE_sri_lanka_almsgiving.dds"

			ai_chance = {
				value = 10
			}
		}

		item = {	
			value = RICE_sri_lanka_support_monastery_ritual_deposits_option
			current_description = RICE_sri_lanka_support_monastery_ritual_deposits_option_desc
			localization = RICE_sri_lanka_support_monastery_ritual_deposits_option
			icon = "gfx/interface/icons/widgets/RICE_sri_lanka_ritual_deposits.dds"

			ai_chance = {
				value = 10
			}
		}

		item = {
			is_valid = {
				capital_province = {
					geographical_region = RICE_sri_lanka_struggle_region
				}					
			}	
			value = RICE_sri_lanka_support_monastery_gavu_pillars_option
			current_description = RICE_sri_lanka_support_monastery_gavu_pillars_option_desc
			localization = RICE_sri_lanka_support_monastery_gavu_pillars_option
			icon = "gfx/interface/icons/widgets/RICE_sri_lanka_gavu_pillars.dds"

			ai_chance = {
				value = 10
			}
		}

		item = {
			value = RICE_sri_lanka_support_monastery_ordination_ceremonies_option
			current_description = RICE_sri_lanka_support_monastery_ordination_ceremonies_option_desc
			localization = RICE_sri_lanka_support_monastery_ordination_ceremonies_option
			icon = "gfx/interface/icons/widgets/RICE_sri_lanka_ordination_ceremonies.dds"

			ai_chance = {
				value = 10
			}
		}

		item = {	
			value = RICE_sri_lanka_support_monastery_pali_literature_option
			current_description = RICE_sri_lanka_support_monastery_pali_literature_option_desc
			localization = RICE_sri_lanka_support_monastery_pali_literature_option
			icon = "gfx/interface/icons/widgets/RICE_sri_lanka_pali_literature.dds"

			ai_chance = {
				value = 10
			}
		}

		item = {			
			is_valid = {
				capital_province = {
					geographical_region = RICE_sri_lanka_struggle_region
				}					
			}
			value = RICE_sri_lanka_support_monastery_ambalamas_option
			current_description = RICE_sri_lanka_support_monastery_ambalamas_option_desc
			localization = RICE_sri_lanka_support_monastery_ambalamas_option
			icon = "gfx/interface/icons/widgets/RICE_sri_lanka_ambalamas.dds"

			ai_chance = {
				value = 10
			}
		}

		item = {
			is_valid = {
				capital_province = {
					geographical_region = RICE_sri_lanka_struggle_region
				}					
			}	
			value = RICE_sri_lanka_support_monastery_frontier_monks_option
			current_description = RICE_sri_lanka_support_monastery_frontier_monks_option_desc
			localization = RICE_sri_lanka_support_monastery_frontier_monks_option
			icon = "gfx/interface/icons/widgets/RICE_sri_lanka_frontier_monks.dds"

			ai_chance = {
				value = 10
			}
		}

		item = {	
			is_valid = {
				capital_province = {
					geographical_region = RICE_sri_lanka_struggle_region
				}					
			}
			value = RICE_sri_lanka_support_monastery_parivena_schools_option
			current_description = RICE_sri_lanka_support_monastery_parivena_schools_option_desc
			localization = RICE_sri_lanka_support_monastery_parivena_schools_option
			icon = "gfx/interface/icons/widgets/RICE_sri_lanka_parivena_schools.dds"

			ai_chance = {
				value = 10
			}
		}

		item = {
			is_valid = {	
				NOT = {					
					capital_province = {
						geographical_region = RICE_sri_lanka_struggle_region
					}	
				}			
			}	
			value = RICE_sri_lanka_support_monastery_senior_guides_option
			current_description = RICE_sri_lanka_support_monastery_senior_guides_option_desc
			localization = RICE_sri_lanka_support_monastery_senior_guides_option
			icon = "gfx/interface/icons/widgets/RICE_sri_lanka_senior_guides.dds"

			ai_chance = {
				value = 10
			}
		}


	}

	effect = {

		custom_tooltip = RICE_sri_lanka_support_monastery_effect_tooltip_1	
		custom_tooltip = RICE_sri_lanka_support_monastery_effect_tooltip_2
		custom_tooltip = RICE_sri_lanka_support_monastery_effect_tooltip_3
		custom_tooltip = RICE_sri_lanka_support_monastery_effect_tooltip_4

		if = {
			limit = {
				OR = {
					has_trait = RICE_mahavihara_trait
					has_trait = RICE_abhayagiri_trait
					has_trait = RICE_jetavana_trait
				}
			}
			custom_tooltip = RICE_sri_lanka_prominence_bonus
		}
		
						
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_sri_lanka_support_monastery_context_tooltip
		}

		# Not sure why AI can't pick one option or another
		if = {
			limit = { is_ai = yes }
			random_list = {
				10 = {
					set_variable = {
						name = RICE_sri_lanka_support_monastery_type
						value = flag:almsgiving
					}
				}
				10 = {
					set_variable = {
						name = RICE_sri_lanka_support_monastery_type
						value = flag:gavu_pillars
					}
				}
				10 = {
					set_variable = {
						name = RICE_sri_lanka_support_monastery_type
						value = flag:ritual_deposits
					}
				}
				10 = {
					set_variable = {
						name = RICE_sri_lanka_support_monastery_type
						value = flag:pali_literature
					}
				}
				10 = {
					set_variable = {
						name = RICE_sri_lanka_support_monastery_type
						value = flag:ambalamas
					}
				}
				10 = {
					set_variable = {
						name = RICE_sri_lanka_support_monastery_type
						value = flag:ordination_ceremonies
					}
				}
				10 = {
					set_variable = {
						name = RICE_sri_lanka_support_monastery_type
						value = flag:frontier_monks
					}
				}
				10 = {
					set_variable = {
						name = RICE_sri_lanka_support_monastery_type
						value = flag:parivena_schools
					}
				}
				10 = {
					set_variable = {
						name = RICE_sri_lanka_support_monastery_type
						value = flag:senior_guides
					}
				}
			}
		}
		else_if = {
			limit = {
				scope:RICE_sri_lanka_support_monastery_almsgiving_option = yes
			}
			set_variable = {
				name = RICE_sri_lanka_support_monastery_type
				value = flag:almsgiving
			}
		}
		else_if = {
			limit = {
				scope:RICE_sri_lanka_support_monastery_gavu_pillars_option = yes
			}
			set_variable = {
				name = RICE_sri_lanka_support_monastery_type
				value = flag:gavu_pillars
			}
		}
		else_if = {
			limit = {
				scope:RICE_sri_lanka_support_monastery_ritual_deposits_option = yes
			}
			set_variable = {
				name = RICE_sri_lanka_support_monastery_type
				value = flag:ritual_deposits
			}
		}
		else_if = {
			limit = {
				scope:RICE_sri_lanka_support_monastery_pali_literature_option = yes
			}
			set_variable = {
				name = RICE_sri_lanka_support_monastery_type
				value = flag:pali_literature
			}
		}
		else_if = {
			limit = {
				scope:RICE_sri_lanka_support_monastery_ambalamas_option = yes
			}
			set_variable = {
				name = RICE_sri_lanka_support_monastery_type
				value = flag:ambalamas
			}
		}
		else_if = {
			limit = {
				scope:RICE_sri_lanka_support_monastery_ordination_ceremonies_option = yes
			}
			set_variable = {
				name = RICE_sri_lanka_support_monastery_type
				value = flag:ordination_ceremonies
			}
		}
		else_if = {
			limit = {
				scope:RICE_sri_lanka_support_monastery_frontier_monks_option = yes
			}
			set_variable = {
				name = RICE_sri_lanka_support_monastery_type
				value = flag:frontier_monks
			}
		}
		else_if = {
			limit = {
				scope:RICE_sri_lanka_support_monastery_parivena_schools_option = yes
			}
			set_variable = {
				name = RICE_sri_lanka_support_monastery_type
				value = flag:parivena_schools
			}
		}
		else_if = {
			limit = {
				scope:RICE_sri_lanka_support_monastery_senior_guides_option = yes
			}
			set_variable = {
				name = RICE_sri_lanka_support_monastery_type
				value = flag:senior_guides
			}
		}

		
		trigger_event = sri_lanka.0030
	}

	minimum_cost = { 
		gold = { value = 50 } # Will depend
	}	

	ai_potential = {
		short_term_gold > 50
	}

	ai_will_do = {
		base = 30
		modifier = {
			add = 10
			has_trait = ambitious
		}
		modifier = {
			add = -10
			has_trait = lazy
		}
		modifier = {
			add = 10
			has_trait = generous
		}
		modifier = {
			add = -10
			has_trait = greedy
		}
		modifier = {
			add = 10
			has_trait = zealous
		}
		modifier = {
			add = -10
			has_trait = cynical
		}
	}
}



RICE_sri_lanka_persecute_monastery = {
	picture = "gfx/interface/illustrations/decisions/decision_ck2_roi_large_temple.dds"

	title = {
		first_valid = {
			triggered_desc = {
				trigger = {
					religion = religion:buddhism_religion
					# OR = {
					# 	has_trait = RICE_mahavihara_trait
					# 	has_trait = RICE_abhayagiri_trait
					# 	has_trait = RICE_jetavana_trait
					# }
				}
				desc = RICE_sri_lanka_persecute_monastery_buddhist
			}
			desc = RICE_sri_lanka_persecute_monastery_non_buddhist
		}
	}

	ai_check_interval = 40
	
	cooldown = { days = 3650 }

	
	desc = RICE_sri_lanka_persecute_monastery_desc
	selection_tooltip = RICE_sri_lanka_persecute_monastery_tooltip

	is_shown = {
		highest_held_title_tier > tier_barony
		is_landed = yes
		any_held_county = {
			any_county_province = {
				geographical_region = RICE_sri_lanka_struggle_region
			}
		}		
	}
	
	is_valid = {
		any_held_county = {
			any_county_province = {
				geographical_region = RICE_sri_lanka_struggle_region
			}
		}
	}
	
	is_valid_showing_failures_only = {
		is_available_adult = yes
	}

	widget = {
		gui = "decision_view_widget_RICE_sri_lanka_progressbars_all"
	}
		
    widget = {
    	gui = "decision_view_widget_RICE_sri_lanka_persecute_monastery"
		controller = decision_option_list_controller
    	
		decision_has_second_step = yes
		decision_custom_widget_container = "custom_widgets_container_step_two"
		decision_to_second_step_button = "RICE_sri_lanka_persecute_monastery_type" 

		item = {	
			value = RICE_sri_lanka_persecute_monastery_burn_books_option
			current_description = RICE_sri_lanka_persecute_monastery_burn_books_option_desc
			localization = RICE_sri_lanka_persecute_monastery_burn_books_option
			icon = "gfx/interface/icons/widgets/RICE_sri_lanka_burn_books.dds"

			ai_chance = {
				value = 10
			}
		}

		item = {	
			value = RICE_sri_lanka_persecute_monastery_defrock_heretics_option
			current_description = RICE_sri_lanka_persecute_monastery_defrock_heretics_option_desc
			localization = RICE_sri_lanka_persecute_monastery_defrock_heretics_option
			icon = "gfx/interface/icons/widgets/RICE_sri_lanka_defrock_heretics.dds"

			ai_chance = {
				value = 10
			}
		}

		item = {	
			value = RICE_sri_lanka_persecute_monastery_plunder_wealth_option
			current_description = RICE_sri_lanka_persecute_monastery_plunder_wealth_option_desc
			localization = RICE_sri_lanka_persecute_monastery_plunder_wealth_option
			icon = "gfx/interface/icons/widgets/RICE_sri_lanka_plunder_wealth.dds"

			ai_chance = {
				value = 10
			}
		}

		item = {	
			value = RICE_sri_lanka_persecute_monastery_seize_land_option
			current_description = RICE_sri_lanka_persecute_monastery_seize_land_option_desc
			localization = RICE_sri_lanka_persecute_monastery_seize_land_option
			icon = "gfx/interface/icons/widgets/RICE_sri_lanka_seize_land.dds"

			ai_chance = {
				value = 10
			}
		}

		item = {
			is_valid = {
				NOT = { religion = religion:buddhism_religion }
			}	
			value = RICE_sri_lanka_persecute_monastery_ransack_monasteries_option
			current_description = RICE_sri_lanka_persecute_monastery_ransack_monasteries_option_desc
			localization = RICE_sri_lanka_persecute_monastery_ransack_monasteries_option
			icon = "gfx/interface/icons/widgets/RICE_sri_lanka_ransack_monasteries.dds"

			ai_chance = {
				value = 10
			}
		}


	}

	effect = {

		custom_tooltip = RICE_sri_lanka_persecute_monastery_effect_tooltip_1	
		custom_tooltip = RICE_sri_lanka_persecute_monastery_effect_tooltip_2
		custom_tooltip = RICE_sri_lanka_persecute_monastery_effect_tooltip_3
		custom_tooltip = RICE_sri_lanka_persecute_monastery_effect_tooltip_4

		if = {
			limit = {
				OR = {
					has_trait = RICE_mahavihara_trait
					has_trait = RICE_abhayagiri_trait
					has_trait = RICE_jetavana_trait
				}
			}
			custom_tooltip = RICE_sri_lanka_prominence_bonus
		}
		
						
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_sri_lanka_persecute_monastery_context_tooltip
		}

		# Not sure why AI can't pick one option or another
		if = {
			limit = { is_ai = yes }
			random_list = {
				10 = {
					set_variable = {
						name = RICE_sri_lanka_persecute_monastery_type
						value = flag:burn_books
					}
				}
				10 = {
					set_variable = {
						name = RICE_sri_lanka_persecute_monastery_type
						value = flag:defrock_heretics
					}
				}
				10 = {
					set_variable = {
						name = RICE_sri_lanka_persecute_monastery_type
						value = flag:plunder_wealth
					}
				}
				10 = {
					set_variable = {
						name = RICE_sri_lanka_persecute_monastery_type
						value = flag:seize_land
					}
				}
				10 = {
					set_variable = {
						name = RICE_sri_lanka_persecute_monastery_type
						value = flag:ransack_monastery
					}
				}
			}
		}
		else_if = {
			limit = {
				scope:RICE_sri_lanka_persecute_monastery_burn_books_option = yes
			}
			set_variable = {
				name = RICE_sri_lanka_persecute_monastery_type
				value = flag:burn_books
			}
		}
		else_if = {
			limit = {
				scope:RICE_sri_lanka_persecute_monastery_defrock_heretics_option = yes
			}
			set_variable = {
				name = RICE_sri_lanka_persecute_monastery_type
				value = flag:defrock_heretics
			}
		}
		else_if = {
			limit = {
				scope:RICE_sri_lanka_persecute_monastery_plunder_wealth_option = yes
			}
			set_variable = {
				name = RICE_sri_lanka_persecute_monastery_type
				value = flag:plunder_wealth
			}
		}
		else_if = {
			limit = {
				scope:RICE_sri_lanka_persecute_monastery_seize_land_option = yes
			}
			set_variable = {
				name = RICE_sri_lanka_persecute_monastery_type
				value = flag:seize_land
			}
		}
		else_if = {
			limit = {
				scope:RICE_sri_lanka_persecute_monastery_ransack_monasteries_option = yes
			}
			set_variable = {
				name = RICE_sri_lanka_persecute_monastery_type
				value = flag:ransack_monastery
			}
		}

		
		trigger_event = sri_lanka.0031
	}

	minimum_cost = { 
		prestige = { value = major_prestige_value } # Will depend
	}	

	ai_potential = {
		prestige > major_prestige_value
	}

	ai_will_do = {
		base = 30
		modifier = {
			add = 10
			has_trait = ambitious
		}
		modifier = {
			add = -10
			has_trait = lazy
		}
		modifier = {
			add = 10
			has_trait = generous
		}
		modifier = {
			add = -10
			has_trait = greedy
		}
		modifier = {
			add = 10
			has_trait = zealous
		}
		modifier = {
			add = -10
			has_trait = cynical
		}
	}
}




RICE_sri_lanka_enshrine_relic = {
	picture = "gfx/interface/illustrations/decisions/decision_rice_ancient_buddhist_holy_site.dds"
	major = yes
	desc = RICE_sri_lanka_enshrine_relic_desc

	ai_check_interval = 48

	cooldown = { days = 10950 }

	is_shown = {
		has_global_variable = RICE_sri_lanka_ending_united_sangha
		OR = {
			# Wouldn't make sense for the Bodhi tree
			# has_global_variable = RICE_sri_lanka_ending_united_sangha_bodhi
			has_global_variable = RICE_sri_lanka_ending_united_sangha_tooth
			has_global_variable = RICE_sri_lanka_ending_united_sangha_dharmadhatu
		}
		#NOT = {
		#	exists = struggle:RICE_sri_lanka_struggle
		#}
		any_held_county = {
			any_county_province = {
				geographical_region = RICE_sri_lanka_struggle_region
			}
		}
	}
	is_valid = {


		trigger_if = {
			limit = {
				has_global_variable = RICE_sri_lanka_ending_united_sangha_tooth
			}
			any_held_county = {
				any_county_province = {
					geographical_region = RICE_sri_lanka_struggle_region
				}
				has_county_modifier = RICE_sri_lanka_relic_tooth_shrine_modifier
			}
		}
		trigger_else_if = {
			limit = {
				has_global_variable = RICE_sri_lanka_ending_united_sangha_dharmadhatu
			}
			any_held_county = {
				any_county_province = {
					geographical_region = RICE_sri_lanka_struggle_region
				}
				has_county_modifier = RICE_sri_lanka_relic_dharmadhatu_shrine_modifier
			}
		}
		# trigger_else_if = {
		# 	limit = {
		# 		has_global_variable = RICE_sri_lanka_ending_united_sangha_bodhi
		# 	}
		# 	any_held_county = {
		# 		any_county_province = {
		# 			geographical_region = RICE_sri_lanka_struggle_region
		# 		}
		# 		has_county_modifier = RICE_sri_lanka_relic_bodhi_shrine_modifier
		# 	}
		# }

		religion = religion:buddhism_religion


	}

	is_valid_showing_failures_only = {
		is_adult = yes
		RICE_is_available_adult_even_if_sick_trigger = yes
	}


    widget = {
    	gui = "decision_view_widget_RICE_sri_lanka_enshrine_relic"
		controller = decision_option_list_controller
    	
		decision_has_second_step = yes
		decision_custom_widget_container = "custom_widgets_container_step_two"
		decision_to_second_step_button = "RICE_sri_lanka_enshrine_relic_type" 

		# c_dakhina_desa
		item = {
			value = RICE_sri_lanka_relic_dakhina_desa_option
			is_shown = {
				has_title = title:c_dakhina_desa
			}
			current_description = RICE_sri_lanka_relic_dakhina_desa_option_desc
			localization = RICE_sri_lanka_relic_dakhina_desa_option
			icon = "gfx/interface/icons/terrain_types/floodplains.dds"

			ai_chance = {
				value = 1
			}
		}

		# c_kandy
		item = {
			value = RICE_sri_lanka_relic_kandy_option
			is_shown = {
				has_title = title:c_kandy
			}
			current_description = RICE_sri_lanka_relic_kandy_option_desc
			localization = RICE_sri_lanka_relic_kandy_option
			icon = "gfx/interface/icons/terrain_types/floodplains.dds"

			ai_chance = {
				value = 1
			}
		}

		# c_rohana
		item = {
			value = RICE_sri_lanka_relic_rohana_option
			is_shown = {
				has_title = title:c_rohana
			}
			current_description = RICE_sri_lanka_relic_rohana_option_desc
			localization = RICE_sri_lanka_relic_rohana_option
			icon = "gfx/interface/icons/terrain_types/floodplains.dds"

			ai_chance = {
				value = 1
			}
		}

		# c_batticaloa
		item = {
			value = RICE_sri_lanka_relic_batticaloa_option
			is_shown = {
				has_title = title:c_batticaloa
			}
			current_description = RICE_sri_lanka_relic_batticaloa_option_desc
			localization = RICE_sri_lanka_relic_batticaloa_option
			icon = "gfx/interface/icons/terrain_types/floodplains.dds"

			ai_chance = {
				value = 1
			}
		}

		# c_phiti
		item = {
			value = RICE_sri_lanka_relic_phiti_option
			is_shown = {
				has_title = title:c_phiti
			}
			current_description = RICE_sri_lanka_relic_phiti_option_desc
			localization = RICE_sri_lanka_relic_phiti_option
			icon = "gfx/interface/icons/terrain_types/floodplains.dds"

			ai_chance = {
				value = 1
			}
		}

		# c_trincomalee
		item = {
			value = RICE_sri_lanka_relic_trincomalee_option
			is_shown = {
				has_title = title:c_trincomalee
			}
			current_description = RICE_sri_lanka_relic_trincomalee_option_desc
			localization = RICE_sri_lanka_relic_trincomalee_option
			icon = "gfx/interface/icons/terrain_types/floodplains.dds"

			ai_chance = {
				value = 1
			}
		}

		# c_jaffna
		item = {
			value = RICE_sri_lanka_relic_jaffna_option
			is_shown = {
				has_title = title:c_jaffna
			}
			current_description = RICE_sri_lanka_relic_jaffna_option_desc
			localization = RICE_sri_lanka_relic_jaffna_option
			icon = "gfx/interface/icons/terrain_types/floodplains.dds"

			ai_chance = {
				value = 1
			}
		}

		# c_kotte
		item = {
			value = RICE_sri_lanka_relic_kotte_option
			is_shown = {
				has_title = title:c_kotte
			}
			current_description = RICE_sri_lanka_relic_kotte_option_desc
			localization = RICE_sri_lanka_relic_kotte_option
			icon = "gfx/interface/icons/terrain_types/floodplains.dds"

			ai_chance = {
				value = 1
			}
		}
	}

	cost = {
		gold = {
			value = major_gold_value
		}
	}

	effect = {
		
		custom_tooltip = RICE_sri_lanka_enshrine_relic_effect_tooltip_1
		custom_tooltip = RICE_sri_lanka_enshrine_relic_effect_tooltip_2

		
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_sri_lanka_enshrine_relic_context_tooltip
		}

		trigger_event = sri_lanka.8888
	}

	ai_will_do = {
		base = 15

		modifier = {
			add = 10
			has_trait = ambitious
		}
		modifier = {
			add = -10
			has_trait = lazy
		}
		modifier = {
			add = 10
			has_trait = zealous
		}
		modifier = {
			add = -10
			has_trait = cynical
		}

	}
}
