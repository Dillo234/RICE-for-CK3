

RICE_tarim_basin_patronize_a_mogao_cave = {
	picture = "gfx/interface/illustrations/decisions/decision_mogao_caves.dds"

	major = yes

	ai_check_interval = 48
	
	desc = RICE_tarim_basin_patronize_a_mogao_cave_desc
	
	is_shown = {
		NOT = { exists = var:RICE_tarim_basin_mogao_cave_type }
		is_ruler = yes
		is_landed = yes
		any_directly_owned_province = {
			geographical_region = RICE_dunhuang_region
		}
		OR = {
			religion = religion:buddhism_religion
			RICE_is_greater_sinosphere_culture_trigger = yes
		}
	}
	
	is_valid = {
		OR = {
			religion = religion:buddhism_religion
			RICE_is_greater_sinosphere_culture_trigger = yes
		}
	}
	
	is_valid_showing_failures_only = {
		is_available_adult = yes
	}

	minimum_cost = {
		# Matches the cost defined in 00_inspirations.txt
		gold = RICE_tarim_basin_mogao_cave_basic_cost_value
	}

    widget = {
    	gui = "decision_view_widget_RICE_tarim_basin_mogao_caves"
		controller = decision_option_list_controller
    	
		decision_has_second_step = yes
		decision_custom_widget_container = "custom_widgets_container_step_two"
		decision_to_second_step_button = "RICE_tarim_basin_patronize_a_mogao_cave_choose_type" 


		# Family focus
		item = {
			value = RICE_tarim_basin_mogao_cave_family_option
			current_description = RICE_tarim_basin_mogao_cave_family_option_desc
			localization = RICE_tarim_basin_mogao_cave_family_option
			icon = "gfx/interface/icons/widgets/RICE_mogao_cave_noble.dds"

			ai_chance = {
				value = 1
			}
		}
		# Jataka Tales focus
		item = {
			value = RICE_tarim_basin_mogao_cave_jataka_option
			current_description = RICE_tarim_basin_mogao_cave_jataka_option_desc
			localization = RICE_tarim_basin_mogao_cave_jataka_option
			icon = "gfx/interface/icons/widgets/RICE_mogao_cave_jataka.dds"

			ai_chance = {
				value = 1
			}
		}
		# Buddhist Deity focus
		item = {
			value = RICE_tarim_basin_mogao_cave_deities_option
			current_description = RICE_tarim_basin_mogao_cave_deities_option_desc
			localization = RICE_tarim_basin_mogao_cave_deities_option
			icon = "gfx/interface/icons/widgets/RICE_mogao_cave_deity.dds"

			ai_chance = {
				value = 1
			}
		}
	}

	effect = {

		custom_tooltip = RICE_tarim_basin_patronize_a_mogao_cave_effect_tooltip_1
		
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_tarim_basin_patronize_a_mogao_cave_context_tooltip
		}

		if = { # Family
			limit = { scope:RICE_tarim_basin_mogao_cave_family_option = yes }
			set_variable = {
				name = RICE_tarim_basin_mogao_cave_type
				value = flag:family
			}
		}

		if = { # Jataka
			limit = { scope:RICE_tarim_basin_mogao_cave_jataka_option = yes }
			set_variable = {
				name = RICE_tarim_basin_mogao_cave_type
				value = flag:jataka
			}
		}

		if = { # Deities
			limit = { scope:RICE_tarim_basin_mogao_cave_deities_option = yes }
			set_variable = {
				name = RICE_tarim_basin_mogao_cave_type
				value = flag:deities
			}
		}
		
		trigger_event = {
			id = tarim_basin.0070
		}
	}

	ai_potential = {
		short_term_gold > ai_war_chest_desired_gold_value
	}

	ai_will_do = {
		base = 50
		modifier = {
			add = 20
			has_trait = zealous
		}
		modifier = {
			add = -20
			has_trait = cynical
		}
		modifier = {
			add = 15
			has_trait = ambitious
		}
		modifier = {
			add = -15
			has_trait = lazy
		}
	}
}

RICE_reinforce_relations_silk_road_communities_silk_road_communities = {
	picture = "gfx/interface/illustrations/decisions/decision_silk_road.dds"

	major = yes

	ai_check_interval = 48

	cooldown = { days = 3650 }
	
	desc = RICE_reinforce_relations_silk_road_communities_silk_road_communities_desc
	
	is_shown = {
		is_ruler = yes
		is_landed = yes
		any_directly_owned_province = {
			geographical_region = RICE_silk_road_region
		}
	}
	
	# is_valid = {		
	# }
	
	is_valid_showing_failures_only = {
		is_available_adult = yes
	}

    widget = {
    	gui = "decision_view_widget_RICE_silk_road_community"
		controller = decision_option_list_controller
    	
		decision_has_second_step = yes
		decision_custom_widget_container = "custom_widgets_container_step_two"
		decision_to_second_step_button = "RICE_silk_road_pick_a_community_type" 


		# Sinic
		item = {
			value = RICE_community_sinic_option
			current_description = RICE_community_sinic_option_desc
			localization = RICE_community_sinic_option
			icon = "gfx/interface/icons/widgets/RICE_silk_road_community_sinic.dds"

			ai_chance = {
				value = 1
			}
		}

		# Nomad
		item = {
			value = RICE_community_nomad_option
			current_description = RICE_community_nomad_option_desc
			localization = RICE_community_nomad_option
			icon = "gfx/interface/icons/widgets/RICE_silk_road_community_nomad.dds"

			ai_chance = {
				value = 1
			}
		}

		# Middle Eastern
		item = {
			value = RICE_community_middle_eastern_option
			current_description = RICE_community_middle_eastern_option_desc
			localization = RICE_community_middle_eastern_option
			icon = "gfx/interface/icons/widgets/RICE_silk_road_community_middle_eastern.dds"

			ai_chance = {
				value = 1
			}
		}

		# Himalayan
		item = {
			value = RICE_community_himalayan_option
			current_description = RICE_community_himalayan_option_desc
			localization = RICE_community_himalayan_option
			icon = "gfx/interface/icons/widgets/RICE_silk_road_community_himalayan.dds"

			ai_chance = {
				value = 1
			}
		}

		# Indic
		item = {
			value = RICE_community_indic_option
			current_description = RICE_community_indic_option_desc
			localization = RICE_community_indic_option
			icon = "gfx/interface/icons/widgets/RICE_silk_road_community_indic.dds"

			ai_chance = {
				value = 1
			}
		}
	}

	effect = {

		custom_tooltip = RICE_reinforce_relations_silk_road_communities_silk_road_communities_effect_tooltip_1
		custom_tooltip = RICE_reinforce_relations_silk_road_communities_silk_road_communities_effect_tooltip_2
		
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_reinforce_relations_silk_road_communities_silk_road_communities_context_tooltip
		}

		if = { # Sinic
			limit = { scope:RICE_community_sinic_option = yes }
			set_variable = {
				name = RICE_silk_road_community_type
				value = flag:sinic
			}
		}

		if = { # Indic
			limit = { scope:RICE_community_indic_option = yes }
			set_variable = {
				name = RICE_silk_road_community_type
				value = flag:indic
			}
		}
		
		trigger_event = {
			id = tarim_basin.8888
		}
	}

	cost = {
		gold = { value = minor_gold_value } # Will depend
	}

	ai_potential = {
		short_term_gold > ai_war_chest_desired_gold_value
	}

	ai_will_do = {
		base = 50
		modifier = {
			add = 20
			has_trait = ambitious
		}
		modifier = {
			add = -20
			has_trait = lazy
		}
	}
}


RICE_iranian_sinicization = {
	picture = "gfx/interface/illustrations/decisions/decision_silk_road.dds"

	major = yes

	ai_check_interval = 48

	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					game_start_date >= 755.1.1
					game_start_date <= 950.1.1
					current_date < 1000.1.1
				}
				desc = RICE_iranian_sinicization_desc.867
			}
			triggered_desc = {
				trigger = {
					OR = {
						game_start_date < 755.1.1
						game_start_date > 950.1.1
						current_date >= 1000.1.1
					}
				}
				desc = RICE_iranian_sinicization_desc
			}
		}
	}
	
	is_shown = {
		is_ruler = yes
		is_landed = yes
		any_directly_owned_province = {
			geographical_region = RICE_silk_road_region
		}
		culture = {			
			NOT = { has_cultural_pillar = heritage_chinese }
		}
		OR = {
			culture = culture:sogdian
			culture = culture:saka
			culture = culture:tocharian
			culture = {
				any_parent_culture_or_above = {
					OR = {
						this = culture:sogdian
						this = culture:saka
						this = culture:tocharian
					}
				}
			}
		}
	}
	
	is_valid = {
		any_directly_owned_province = {
			geographical_region = RICE_silk_road_region
		}
		OR = {
			top_liege = {
				culture = { has_cultural_pillar = heritage_chinese }
			}
			capital_province = {
				culture = { has_cultural_pillar = heritage_chinese }
			}
		}
		culture = {			
			NOT = { has_cultural_pillar = heritage_chinese }
		}
		OR = {
			culture = culture:sogdian
			culture = culture:saka
			culture = culture:tocharian
			culture = {
				any_parent_culture_or_above = {
					OR = {
						this = culture:sogdian
						this = culture:saka
						this = culture:tocharian
					}
				}
			}
		}
		#prestige_level >= 3
	}
	
	is_valid_showing_failures_only = {
		is_available_adult = yes
	}


	effect = {

		culture = {
			save_scope_as = old_culture
		}

		custom_tooltip = RICE_iranian_sinicization_effect_tooltip_1

		RICE_tarim_basin_sinicize_effect = yes
		
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_iranian_sinicization_context_tooltip
		}
		
		trigger_event = {
			id = tarim_basin.0010
		}
	}

	cost = {
		gold = { value = medium_gold_value }
	}

	ai_potential = {
		short_term_gold > medium_gold_value
	}

	ai_will_do = {
		base = 20
		modifier = {
			add = -30
			highest_held_title_tier > tier_duchy # Don't want kings becoming Chinese willy nilly
		}
		modifier = {
			add = 10
			has_trait = ambitious
		}
		modifier = {
			add = -10
			has_trait = lazy
		}
	}
}





