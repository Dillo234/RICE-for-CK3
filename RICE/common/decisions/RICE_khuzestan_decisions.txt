


RICE_khuzestan_khuzi_status_decision = {
	picture = "gfx/interface/illustrations/decisions/decision_iranian_court.dds"
	major = yes
	desc = RICE_khuzestan_khuzi_status_decision_desc

	ai_check_interval = 120

	is_shown = {
		is_ruler = yes
		highest_held_title_tier > tier_barony
		culture = {
			OR = {				
				any_parent_culture_or_above = {
					this = culture:elamite
				}
				has_cultural_tradition = tradition_RICE_khuzi
			}
		}
		NOT = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:RICE_khuzestan_khuzi_dignity_restored
			}
		}
	}

	is_valid = {
		OR = {
			AND = {
				highest_held_title_tier = tier_county
				prestige_level >= 5
			}
			AND = {
				highest_held_title_tier >= tier_duchy
				prestige_level >= 3
			}
		}
		has_title = title:c_tustar
		OR = {
			religion = religion:islam_religion
			religion = religion:christianity_religion
			religion = religion:judaism_religion
		}
		completely_controls = title:d_khuzestan
		calc_true_if = {
			amount >= 2
			completely_controls = title:d_kermanshah
			completely_controls = title:d_wasit
			completely_controls = title:d_basra
		}
	}

	is_valid_showing_failures_only = {
		is_adult = yes
		is_available = yes
	}

	cost = {
		gold = {
			value = major_gold_value
		}
		prestige = {
			value = major_prestige_value
		}
	}

	effect = {
		#Can only happen once
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:RICE_khuzestan_khuzi_dignity_restored
		}

		save_scope_as = khuzi_hero

		show_as_tooltip = {
			RICE_khuzestan_kingdom_effect = yes
		}
		
		custom_tooltip = RICE_khuzestan_khuzi_status_decision_effect_tooltip_1
		
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_khuzestan_khuzi_status_decision_context_tooltip
		}
		
		trigger_event = aachen.0003

		add_to_list = notification_sent
	}

	ai_will_do = {
		base = 25
		modifier = {
			add = 15
			has_trait = ambitious
		}
		modifier = {
			add = 15
			has_trait = zealous
		}
		modifier = {
			add = -40
			# Tomb supposedly dates to 11th century
			current_date <= 900.1.1
		}
		modifier = {
			add = -20
			# Tomb supposedly dates to 11th century
			current_date <= 950.1.1
		}
		modifier = {
			add = -10
			# Tomb supposedly dates to 11th century
			current_date <= 1000.1.1
		}
		modifier = {
			add = -5
			# Tomb supposedly dates to 11th century
			current_date <= 1050.1.1
		}
	}
}



RICE_khuzestan_rebury_daniel = {
	picture = "gfx/interface/illustrations/decisions/decision_small_town_arabic.dds"
	major = yes
	desc = RICE_khuzestan_rebury_daniel_desc

	ai_check_interval = 120

	is_shown = {
		#NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
		is_landed = yes
		OR = {
			title:c_tustar = {
				squared_distance = {
					target = root.capital_province
					value <= squared_distance_medium
				}
			}
			any_held_title = {
				tier = tier_county
				duchy = title:d_khuzestan			
			}
			has_title = title:c_tustar
		}
		#has_title = title:c_tustar
		OR = {
			religion = religion:islam_religion
			religion = religion:christianity_religion
			religion = religion:judaism_religion
		}
		NOT = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:RICE_khuzestan_daniel_reburied
			}
		}
	}

	is_valid = {
		OR = {
			AND = {
				highest_held_title_tier = tier_county
				prestige_level >= 3
			}
			AND = {
				highest_held_title_tier >= tier_kingdom
				prestige_level >= 2
			}
		}
		has_title = title:c_tustar
		OR = {
			religion = religion:islam_religion
			religion = religion:christianity_religion
			religion = religion:judaism_religion
		}
	}

	is_valid_showing_failures_only = {
		is_adult = yes
		is_available = yes
	}

	cost = {
		gold = {
			value = major_gold_value
		}
		# prestige = {
		# 	value = major_prestige_value
		# }
	}

	effect = {
		#Can only happen once
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:RICE_khuzestan_daniel_reburied
		}

		save_scope_as = sanjar

		show_as_tooltip = {
			RICE_khuzestan_move_daniel_tomb_effect = yes
		}
		
		#custom_tooltip = RICE_khuzestan_rebury_daniel_effect_tooltip_1
		
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_khuzestan_rebury_daniel_context_tooltip
		}
		
		trigger_event = khuzestan.0025

		add_to_list = notification_sent
	}

	ai_will_do = {
		base = 25
		modifier = {
			add = 15
			has_trait = ambitious
		}
		modifier = {
			add = 15
			has_trait = zealous
		}
		modifier = {
			add = -40
			# Tomb supposedly dates to 11th century
			current_date <= 900.1.1
		}
		modifier = {
			add = -20
			# Tomb supposedly dates to 11th century
			current_date <= 950.1.1
		}
		modifier = {
			add = -10
			# Tomb supposedly dates to 11th century
			current_date <= 1000.1.1
		}
		modifier = {
			add = -5
			# Tomb supposedly dates to 11th century
			current_date <= 1050.1.1
		}
	}
}

RICE_khuzestan_tomb_of_daniel_decision = {
	picture = "gfx/interface/illustrations/decisions/decision_desert_pilgrimage.dds"

	ai_check_interval = 64

	cooldown = { days = 7300 }
	
	desc = RICE_khuzestan_tomb_of_daniel_decision_desc
	
	is_shown = {
		is_landed = yes
		OR = {
			religion = religion:islam_religion
			religion = religion:christianity_religion
			religion = religion:judaism_religion
			faith = {
				OR = {
					has_doctrine = tenet_islamic_syncretism
					has_doctrine = tenet_jewish_syncretism
					has_doctrine = tenet_christian_syncretism
				}
			}
		}
		OR = {
			title:c_tustar = {
				squared_distance = {
					target = root.capital_province
					value <= squared_distance_medium
				}
			}
			any_held_title = {
				tier = tier_county
				duchy = title:d_khuzestan			
			}
		}
	}
	
	is_valid = {
		OR = {
			religion = religion:islam_religion
			religion = religion:christianity_religion
			religion = religion:judaism_religion
			faith = {
				OR = {
					has_doctrine = tenet_islamic_syncretism
					has_doctrine = tenet_jewish_syncretism
					has_doctrine = tenet_christian_syncretism
				}
			}
		}
		OR = {
			custom_description = {
				text = RICE_tomb_of_daniel_pilgrimage_distance_req						
				is_target_in_global_variable_list = {
					name = unavailable_unique_decisions
					target = flag:RICE_khuzestan_daniel_reburied
				}
				title:c_tustar = {
					squared_distance = {
						target = root.capital_province
						value <= squared_distance_medium
					}
				}
			}
			custom_description = {
				text = RICE_khuzestan_geographical_req
				any_held_title = {
					tier = tier_county
					duchy = title:d_khuzestan
				}
			}
		}
	}
	
	is_valid_showing_failures_only = {
		is_available_adult = yes
	}

	effect = {
		custom_tooltip = RICE_khuzestan_tomb_of_daniel_decision_effect_tooltip_1
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_khuzestan_tomb_of_daniel_decision_context_tooltip
		}
		trigger_event = {
			id = khuzestan.0020
		}
	}

	cost = { 
		gold = { value = medium_gold_value } # Will depend
	}	

	ai_potential = {
		short_term_gold > medium_gold_value
	}

	ai_will_do = {
		base = 30
		modifier = {
			add = 15
			has_trait = zealous
		}
		modifier = {
			add = -15
			has_trait = cynical
		}
	}
}


RICE_khuzestan_repair_shushtar_hydraulics = {
	picture = "gfx/interface/illustrations/decisions/decision_visit_western_oasis_springs.dds"

	ai_check_interval = 64

	cooldown = { days = 3650 }
	
	desc = RICE_khuzestan_repair_shushtar_hydraulics_desc
	
	is_shown = {
		is_landed = yes
		has_title = title:c_tustar
	}
	
	is_valid = {
		has_title = title:c_tustar
	}
	
	is_valid_showing_failures_only = {
		is_available_adult = yes
	}

	effect = {
		custom_tooltip = RICE_khuzestan_repair_shushtar_hydraulics_effect_tooltip_1
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_khuzestan_repair_shushtar_hydraulics_context_tooltip
		}
		trigger_event = {
			id = khuzestan.8888
		}
	}

	cost = { 
		gold = { value = medium_gold_value } # Will depend
	}	

	ai_potential = {
		short_term_gold > medium_gold_value
	}

	ai_will_do = {
		base = 30
		modifier = {
			add = 15
			has_trait = diligent
		}
		modifier = {
			add = -15
			has_trait = lazy
		}
	}
}