RICE_setup_galicia_flavor_pack_effect = {

	#########################################################################
	#
	# CULTURE AND RELIGION STUFF
	#
	#########################################################################

	culture:galician = {
		add_culture_tradition = tradition_RICE_galician_portuguese_poetry
		remove_variable = tradition_cooldown
	}	

	culture:portuguese = {
		add_culture_tradition = tradition_RICE_galician_portuguese_poetry
		remove_variable = tradition_cooldown
	}

}


RICE_galicia_saint_james_infrastructure_close_effect = {
	every_held_title = {
		limit = {
			tier = tier_county
			any_county_province = {
				geographical_region = RICE_galicia_region	
			}
		}
		add_county_modifier = {
			modifier = RICE_galicia_saint_james_infrastructure_close
			years = 10
		}
	}	
}

RICE_galicia_saint_james_infrastructure_midrange_high_effect = {
	every_held_title = {
		limit = {
			tier = tier_county
			county_control >= medium_county_control
			any_county_province = {
				geographical_region = RICE_close_to_galicia_region
				NOT = { geographical_region = RICE_galicia_region }
			}
		}
		add_county_modifier = {
			modifier = RICE_galicia_saint_james_infrastructure_midrange_high
			years = 10
		}
	}	
}

RICE_galicia_saint_james_infrastructure_distant_high_effect = {
	every_held_title = {
		limit = {
			tier = tier_county
			county_control >= medium_county_control
			any_county_province = {
				geographical_region = RICE_distant_from_galicia_region	
			}
		}
		add_county_modifier = {
			modifier = RICE_galicia_saint_james_infrastructure_distant_high
			years = 10
		}
	}	
}

RICE_galicia_saint_james_infrastructure_midrange_low_effect = {
	every_held_title = {
		limit = {
			tier = tier_county
			county_control < medium_county_control
			any_county_province = {
				geographical_region = RICE_close_to_galicia_region
				NOT = { geographical_region = RICE_galicia_region }
			}
		}
		add_county_modifier = {
			modifier = RICE_galicia_saint_james_infrastructure_midrange_low
			years = 10
		}
	}	
}

RICE_galicia_saint_james_infrastructure_distant_low_effect = {
	every_held_title = {
		limit = {
			tier = tier_county
			county_control < medium_county_control
			any_county_province = {
				geographical_region = RICE_distant_from_galicia_region	
			}
		}
		add_county_modifier = {
			modifier = RICE_galicia_saint_james_infrastructure_distant_low
			years = 10
		}
	}	
}

RICE_galicia_saint_james_tolls_close_effect = {
	every_held_title = {
		limit = {
			tier = tier_county
			any_county_province = {
				geographical_region = RICE_galicia_region	
			}
		}
		add_county_modifier = {
			modifier = RICE_galicia_saint_james_tolls_close
			years = 10
		}
	}	
}

RICE_galicia_saint_james_tolls_midrange_high_effect = {
	every_held_title = {
		limit = {
			tier = tier_county
			county_control >= medium_county_control
			any_county_province = {
				geographical_region = RICE_close_to_galicia_region
				NOT = { geographical_region = RICE_galicia_region }
			}
		}
		add_county_modifier = {
			modifier = RICE_galicia_saint_james_tolls_midrange_high
			years = 10
		}
	}	
}

RICE_galicia_saint_james_tolls_distant_high_effect = {
	every_held_title = {
		limit = {
			tier = tier_county
			county_control >= medium_county_control
			any_county_province = {
				geographical_region = RICE_distant_from_galicia_region	
			}
		}
		add_county_modifier = {
			modifier = RICE_galicia_saint_james_tolls_distant_high
			years = 10
		}
	}	
}

RICE_galicia_saint_james_tolls_midrange_low_effect = {
	every_held_title = {
		limit = {
			tier = tier_county
			county_control < medium_county_control
			any_county_province = {
				geographical_region = RICE_close_to_galicia_region
				NOT = { geographical_region = RICE_galicia_region }
			}
		}
		add_county_modifier = {
			modifier = RICE_galicia_saint_james_tolls_midrange_low
			years = 10
		}
	}	
}

RICE_galicia_saint_james_tolls_distant_low_effect = {
	every_held_title = {
		limit = {
			tier = tier_county
			county_control < medium_county_control
			any_county_province = {
				geographical_region = RICE_distant_from_galicia_region	
			}
		}
		add_county_modifier = {
			modifier = RICE_galicia_saint_james_tolls_distant_low
			years = 10
		}
	}	
}

RICE_galicia_saint_james_prayer_warrior_effect = {
	random_list = {
		# Nothing
		40 = {
			show_chance = no
			desc = RICE_saint_james_intercession_tooltip.nothing
			hidden_effect = {
				send_interface_toast = {
					left_icon = ROOT
					title = RICE_saint_james_intercession_tooltip.nothing
					custom_tooltip = RICE_saint_james_intercession_tooltip.nothing
				}
			}

		}
		# Minor intercession
		30 = {
			show_chance = no
			desc = RICE_saint_james_intercession_tooltip.minor
			modifier = {
				add = 5
				num_virtuous_traits >= 1
			}
			modifier = {
				add = 5
				num_virtuous_traits >= 2
			}
			modifier = {
				add = 5
				num_virtuous_traits >= 3
			}
			modifier = {
				add = -5				
				num_sinful_traits >= 1
			}
			modifier = {
				add = -5				
				num_sinful_traits >= 2
			}
			modifier = {
				add = -5				
				num_sinful_traits >= 3
			}
			modifier = {
				add = 5
				has_trait = zealous
			}
			modifier = {
				add = -5
				has_trait = cynical
			}
			send_interface_toast = {
				left_icon = ROOT
				title = RICE_saint_james_intercession_tooltip.minor
				# Warrior
				if = {
					limit = {
						OR = {
							AND = {
								exists = struggle:iberian_struggle
								struggle:iberian_struggle = { is_struggle_phase = struggle_iberia_phase_hostility }
							}
							AND = {
								NOT = { exists = struggle:iberian_struggle }
								NOT = { has_global_variable = fp2_struggle_conciliation_ending }
								NOT = { has_global_variable = fp2_struggle_compromise_ending }
							}
						}
					}
					add_character_modifier = {
						modifier = RICE_galicia_saint_james_modifier_warrior_minor
						years = 10
					}
				}
				# Preacher
				else_if = {
					limit = {
						OR = {
							AND = {
								exists = struggle:iberian_struggle
								struggle:iberian_struggle = { is_struggle_phase = struggle_iberia_phase_conciliation }
							}
							AND = {
								NOT = { exists = struggle:iberian_struggle }
								has_global_variable = fp2_struggle_conciliation_ending
							}
						}
					}
					add_character_modifier = {
						modifier = RICE_galicia_saint_james_modifier_preacher_minor
						years = 10
					}
				}
				# Pilgrim
				else_if = {
					limit = {
						OR = {
							AND = {
								exists = struggle:iberian_struggle
								OR = {
									struggle:iberian_struggle = { is_struggle_phase = struggle_iberia_phase_compromise }
									struggle:iberian_struggle = { is_struggle_phase = struggle_iberia_phase_opportunity }
								}
							}
							AND = {
								NOT = { exists = struggle:iberian_struggle }
								has_global_variable = fp2_struggle_compromise_ending
							}
						}
					}
					add_character_modifier = {
						modifier = RICE_galicia_saint_james_modifier_pilgrim_minor
						years = 10
					}
				}
				# Failsafe, or if player doesn't have the DLC
				else = {
					random_list = {
						10 = {
							add_character_modifier = {
								modifier = RICE_galicia_saint_james_modifier_warrior_minor
								years = 10
							}
						}
						10 = {
							add_character_modifier = {
								modifier = RICE_galicia_saint_james_modifier_preacher_minor
								years = 10
							}
						}
						10 = {
							add_character_modifier = {
								modifier = RICE_galicia_saint_james_modifier_pilgrim_minor
								years = 10
							}
						}
					}
				}
			}
		}
		# Major intercession
		20 = {
			show_chance = no
			desc = RICE_saint_james_intercession_tooltip.major
			modifier = {
				add = 5
				num_virtuous_traits >= 1
			}
			modifier = {
				add = 5
				num_virtuous_traits >= 2
			}
			modifier = {
				add = 5
				num_virtuous_traits >= 3
			}
			modifier = {
				add = -5				
				num_sinful_traits >= 1
			}
			modifier = {
				add = -5				
				num_sinful_traits >= 2
			}
			modifier = {
				add = -5				
				num_sinful_traits >= 3
			}
			modifier = {
				add = 5
				has_trait = zealous
			}
			modifier = {
				add = -5
				has_trait = cynical
			}
			send_interface_toast = {
				left_icon = ROOT
				title = RICE_saint_james_intercession_tooltip.major
				# Warrior
				if = {
					limit = {
						OR = {
							AND = {
								exists = struggle:iberian_struggle
								struggle:iberian_struggle = { is_struggle_phase = struggle_iberia_phase_hostility }
							}
							AND = {
								NOT = { exists = struggle:iberian_struggle }
								NOT = { has_global_variable = fp2_struggle_conciliation_ending }
								NOT = { has_global_variable = fp2_struggle_compromise_ending }
							}
						}
					}
					add_character_modifier = {
						modifier = RICE_galicia_saint_james_modifier_warrior_major
						years = 10
					}
				}
				# Preacher
				else_if = {
					limit = {
						OR = {
							AND = {
								exists = struggle:iberian_struggle
								struggle:iberian_struggle = { is_struggle_phase = struggle_iberia_phase_conciliation }
							}
							AND = {
								NOT = { exists = struggle:iberian_struggle }
								has_global_variable = fp2_struggle_conciliation_ending
							}
						}
					}
					add_character_modifier = {
						modifier = RICE_galicia_saint_james_modifier_preacher_major
						years = 10
					}
				}
				# Pilgrim
				else_if = {
					limit = {
						OR = {
							AND = {
								exists = struggle:iberian_struggle
								OR = {
									struggle:iberian_struggle = { is_struggle_phase = struggle_iberia_phase_compromise }
									struggle:iberian_struggle = { is_struggle_phase = struggle_iberia_phase_opportunity }
								}
							}
							AND = {
								NOT = { exists = struggle:iberian_struggle }
								has_global_variable = fp2_struggle_compromise_ending
							}
						}
					}
					add_character_modifier = {
						modifier = RICE_galicia_saint_james_modifier_pilgrim_major
						years = 10
					}
				}
				# Failsafe, or if player doesn't have the DLC
				else = {
					random_list = {
						10 = {
							add_character_modifier = {
								modifier = RICE_galicia_saint_james_modifier_warrior_major
								years = 10
							}
						}
						10 = {
							add_character_modifier = {
								modifier = RICE_galicia_saint_james_modifier_preacher_major
								years = 10
							}
						}
						10 = {
							add_character_modifier = {
								modifier = RICE_galicia_saint_james_modifier_pilgrim_major
								years = 10
							}
						}
					}
				}
			}
		}
		# Great intercession
		10 = {
			show_chance = no
			desc = RICE_saint_james_intercession_tooltip.great
			modifier = {
				add = 5
				num_virtuous_traits >= 1
			}
			modifier = {
				add = 5
				num_virtuous_traits >= 2
			}
			modifier = {
				add = 5
				num_virtuous_traits >= 3
			}
			modifier = {
				add = -5				
				num_sinful_traits >= 1
			}
			modifier = {
				add = -5				
				num_sinful_traits >= 2
			}
			modifier = {
				add = -5				
				num_sinful_traits >= 3
			}
			modifier = {
				add = 5
				has_trait = zealous
			}
			modifier = {
				add = -5
				has_trait = cynical
			}
			send_interface_toast = {
				left_icon = ROOT
				title = RICE_saint_james_intercession_tooltip.great
				# Warrior
				if = {
					limit = {
						OR = {
							AND = {
								exists = struggle:iberian_struggle
								struggle:iberian_struggle = { is_struggle_phase = struggle_iberia_phase_hostility }
							}
							AND = {
								NOT = { exists = struggle:iberian_struggle }
								NOT = { has_global_variable = fp2_struggle_conciliation_ending }
								NOT = { has_global_variable = fp2_struggle_compromise_ending }
							}
						}
					}
					add_character_modifier = {
						modifier = RICE_galicia_saint_james_modifier_warrior_great
						years = 10
					}
				}
				# Preacher
				else_if = {
					limit = {
						OR = {
							AND = {
								exists = struggle:iberian_struggle
								struggle:iberian_struggle = { is_struggle_phase = struggle_iberia_phase_conciliation }
							}
							AND = {
								NOT = { exists = struggle:iberian_struggle }
								has_global_variable = fp2_struggle_conciliation_ending
							}
						}
					}
					add_character_modifier = {
						modifier = RICE_galicia_saint_james_modifier_preacher_great
						years = 10
					}
				}
				# Pilgrim
				else_if = {
					limit = {
						OR = {
							AND = {
								exists = struggle:iberian_struggle
								OR = {
									struggle:iberian_struggle = { is_struggle_phase = struggle_iberia_phase_compromise }
									struggle:iberian_struggle = { is_struggle_phase = struggle_iberia_phase_opportunity }
								}
							}
							AND = {
								NOT = { exists = struggle:iberian_struggle }
								has_global_variable = fp2_struggle_compromise_ending
							}
						}
					}
					add_character_modifier = {
						modifier = RICE_galicia_saint_james_modifier_pilgrim_great
						years = 10
					}
				}
				# Failsafe, or if player doesn't have the DLC
				else = {
					random_list = {
						10 = {
							add_character_modifier = {
								modifier = RICE_galicia_saint_james_modifier_warrior_great
								years = 10
							}
						}
						10 = {
							add_character_modifier = {
								modifier = RICE_galicia_saint_james_modifier_preacher_great
								years = 10
							}
						}
						10 = {
							add_character_modifier = {
								modifier = RICE_galicia_saint_james_modifier_pilgrim_great
								years = 10
							}
						}
					}
				}
			}
		}
	}
}

RICE_galicia_alter_the_altar_effect = {
	add_prestige = 250
	add_character_modifier = {
		modifier = RICE_galicia_altered_saint_james_tomb
		years = 10
	}
	cp:councillor_court_chaplain = {
		add_character_modifier = {
			modifier = RICE_galicia_altered_saint_james_tomb
			years = 10
		}
	}
	every_county_in_region = {
		region = RICE_galicia_region
		custom = RICE_every_county_in_galicia
		change_county_control = -25
		add_county_modifier = {
			modifier = RICE_galicia_recently_altered_the_altar
			years = 30
		}
	}

	# title:c_santiago = {
	# 	add_county_modifier = {
	# 		modifier = RICE_galicia_recently_altered_the_altar
	# 		years = 25
	# 	}
	# }

	stress_impact = {
		compassionate = miniscule_stress_impact_gain
		just = miniscule_stress_impact_gain
		content = minor_stress_impact_gain
		lazy = minor_stress_impact_gain
		paranoid = minor_stress_impact_gain
	}
}

RICE_galicia_1117_uprising_effect = {
	add_prestige = -250
	every_county_in_region = {
		region = RICE_galicia_region
		custom = RICE_every_county_in_galicia
		change_county_control = -25
		add_county_modifier = {
			modifier = RICE_galicia_recent_1117_uprising
			years = 10
		}
	}

	stress_impact = {
		base = minor_stress_impact_gain
		compassionate = miniscule_stress_impact_gain
		just = miniscule_stress_impact_gain
		content = miniscule_stress_impact_gain
		lazy = miniscule_stress_impact_gain
		paranoid = miniscule_stress_impact_gain
		zealous = minor_stress_impact_gain
	}
}


