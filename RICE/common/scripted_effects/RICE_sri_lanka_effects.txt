

RICE_setup_sri_lanka_flavor_pack_effect = {



	#########################################################################
	#
	# CULTURE AND RELIGION STUFF
	#
	#########################################################################

	culture:vedda = {
		add_culture_tradition = tradition_RICE_cave_dwellers
		remove_variable = tradition_cooldown
	}

	culture:sinhala = {
		remove_culture_tradition = tradition_ruling_caste
		remove_culture_tradition = tradition_fervent_temple_builders
		remove_culture_tradition = tradition_city_keepers
		add_culture_tradition = tradition_religious_patronage
		add_culture_tradition = tradition_stalwart_defenders
		add_culture_tradition = tradition_maritime_mercantilism
		add_culture_tradition = tradition_RICE_wewas
		remove_variable = tradition_cooldown
	}

	culture:gujarati = {
		add_culture_tradition = tradition_RICE_stepwells
		remove_variable = tradition_cooldown
	}

	culture:rajput = {
		add_culture_tradition = tradition_RICE_stepwells
		remove_variable = tradition_cooldown
	}

	culture:shona = {
		remove_culture_tradition = tradition_RICE_swahili_contacts
		add_culture_tradition = tradition_RICE_zimbabwe
		add_culture_tradition = tradition_RICE_bantu_migrators
		remove_variable = tradition_cooldown
	}

	culture:makua = {
		add_culture_tradition = tradition_RICE_bantu_migrators
		remove_variable = tradition_cooldown
	}

	culture:makonde = {
		add_culture_tradition = tradition_RICE_bantu_migrators
		remove_variable = tradition_cooldown
	}

	culture:mijikenda = {
		add_culture_tradition = tradition_RICE_bantu_migrators
		remove_variable = tradition_cooldown
	}

	culture:pokomo = {
		add_culture_tradition = tradition_RICE_bantu_migrators
		remove_variable = tradition_cooldown
	}

	culture:seuta = {
		add_culture_tradition = tradition_RICE_bantu_migrators
		remove_variable = tradition_cooldown
	}

	culture:sabaki = {
		add_culture_tradition = tradition_RICE_bantu_migrators
		remove_variable = tradition_cooldown
	}

	culture:ruvu = {
		add_culture_tradition = tradition_RICE_bantu_migrators
		remove_variable = tradition_cooldown
	}

	culture:tsonga = {
		add_culture_tradition = tradition_RICE_bantu_migrators
		add_culture_tradition = tradition_RICE_cattle_kraals
		remove_variable = tradition_cooldown
	}

	culture:nguni = {
		add_culture_tradition = tradition_RICE_bantu_migrators
		add_culture_tradition = tradition_RICE_cattle_kraals
		remove_variable = tradition_cooldown
	}

	culture:sotho_tswana = {
		add_culture_tradition = tradition_RICE_bantu_migrators
		add_culture_tradition = tradition_RICE_zimbabwe
		add_culture_tradition = tradition_RICE_cattle_kraals
		remove_variable = tradition_cooldown
	}

	every_culture_global = {
		limit = {
			OR = {
				has_cultural_pillar = heritage_indo_aryan
				has_cultural_pillar = heritage_dravidian
			}
		}
		add_innovation = innovation_RICE_irrigation_tanks
	}

	every_county = {
		limit = {
			culture = culture:welayta
		}
		set_county_faith = faith:welayta_pagan
		holder = {
			if = {
				limit = {
					culture = culture:welayta
				}
				set_character_faith = faith:welayta_pagan
			}
			every_courtier_or_guest = {
				limit = {
					culture = culture:welayta
				}
				set_character_faith = faith:welayta_pagan
			}
		}
	}	


	#########################################################################
	#
	# TITLE HISTORY
	#
	#########################################################################

	# For 867 bookmark
	if = {
		limit = {
			game_start_date = 867.1.1
		}
		# Give some territory to Udaya
		character:189014 = {
			get_title = title:c_kandy
			RICE_setup_new_granted_ruler_bonuses_effect = yes
		}
		# Give some territory to Udaya
		character:RICE_sri_lanka_001 = {
			get_title = title:c_trincomalee
			get_title = title:c_batticaloa
			RICE_setup_new_granted_ruler_bonuses_effect = yes
		}
	}

	#########################################################################
	#
	# MISC STUFF
	#
	#########################################################################

	start_struggle = {
		struggle_type = RICE_sri_lanka_struggle
		start_phase = struggle_RICE_sri_lanka_phase_degeneration
	}

	set_global_variable = {
		name = RICE_mahavihara_prominence
		value = 100
	}

	set_global_variable = {
		name = RICE_abhayagiri_prominence
		value = 100
	}

	set_global_variable = {
		name = RICE_jetavana_prominence
		value = 100
	}

}


RICE_setup_sri_lanka_display_values = {
	if = {
		limit = {
			OR = {
				AND = {						
					exists = struggle:RICE_sri_lanka_struggle
					any_character_struggle = {
						involvement = involved
						is_struggle_type = RICE_sri_lanka_struggle
					}	
				}		
				AND = {
					any_held_title = {
						tier = tier_county
						any_county_province = {
							geographical_region = RICE_sri_lanka_struggle_region		
						}
					}
					has_global_variable = RICE_sri_lanka_ending_united_sangha
				}
			}
		}
		send_interface_message = {
			type = event_generic_neutral
			title = RICE_sri_lanka_values_notification.title
			custom_tooltip = RICE_sri_lanka_values_notification.mahavihara_tooltip
			custom_tooltip = RICE_sri_lanka_values_notification.abhayagiri_tooltip
			custom_tooltip = RICE_sri_lanka_values_notification.jetavana_tooltip
		}
	}
}


RICE_sri_lanka_struggle_land_grant_buddhist_effect = {
	if = {
		limit = {
			exists = struggle:RICE_sri_lanka_struggle
			OR = {
				any_character_struggle = {
					involvement = involved
					is_struggle_type = RICE_sri_lanka_struggle
				}
				any_character_struggle = {
					involvement = interloper
					is_struggle_type = RICE_sri_lanka_struggle
				}
			}
		}
		struggle:RICE_sri_lanka_struggle = {
			activate_struggle_catalyst = {
				catalyst = catalyst_RICE_sri_lanka_land_grants_buddhist
				character = root
			}
		}
	}
}

RICE_sri_lanka_struggle_land_grant_non_buddhist_effect = {
	if = {
		limit = {
			exists = struggle:RICE_sri_lanka_struggle
			OR = {
				any_character_struggle = {
					involvement = involved
					is_struggle_type = RICE_sri_lanka_struggle
				}
				any_character_struggle = {
					involvement = interloper
					is_struggle_type = RICE_sri_lanka_struggle
				}
			}
		}
		struggle:RICE_sri_lanka_struggle = {
			activate_struggle_catalyst = {
				catalyst = catalyst_RICE_sri_lanka_land_grants_non_buddhist
				character = root
			}
		}
	}
}

RICE_sri_lanka_struggle_ending_uniter_effect = {
	give_nickname = nick_the_great
	if = {
		limit = {
			religion = religion:buddhism
		}
		add_piety = 1000
	}
	else = {
		add_prestige = 1000
	}
	dynasty = {
		add_dynasty_prestige = 1000
		add_dynasty_modifier = {
			modifier = RICE_sri_lanka_sangha_uniter_modifier
		}
	}
	RICE_sri_lanka_struggle_ending_doctrine_effect = yes
}

RICE_sri_lanka_struggle_ending_destroyer_effect = {
	give_nickname = nick_the_sangha_destroyer
	add_prestige = 500
	add_gold = 1000
	dynasty = {
		add_dynasty_modifier = {
			modifier = RICE_sri_lanka_sangha_destroyer_modifier
		}
	}
}

RICE_sri_lanka_struggle_ending_doctrine_effect = {

	# Upgraded Pali Canon doctrines
	if = {
		limit = {
			has_trait = RICE_mahavihara_trait
		}
		religion:buddhism_religion = {
			every_faith = {
				custom = RICE_every_theravada_faith
				limit = {
					has_doctrine = rice_theravada_canon_doctrine
				}
				remove_doctrine = rice_theravada_canon_doctrine
				add_doctrine = rice_theravada_canon_mahavihara_doctrine
			}
		}
		set_global_variable = {
			name = RICE_sri_lanka_ending_united_sangha_mahavihara
			value = yes
		}
	}
	else_if = {
		limit = {
			has_trait = RICE_abhayagiri_trait
		}
		religion:buddhism_religion = {
			every_faith = {
				custom = RICE_every_theravada_faith
				limit = {
					has_doctrine = rice_theravada_canon_doctrine
				}
				remove_doctrine = rice_theravada_canon_doctrine
				add_doctrine = rice_theravada_canon_abhayagiri_doctrine
			}
		}
		set_global_variable = {
			name = RICE_sri_lanka_ending_united_sangha_abhayagiri
			value = yes
		}
	}
	else_if = {
		limit = {
			has_trait = RICE_jetavana_trait
		}
		religion:buddhism_religion = {
			every_faith = {
				custom = RICE_every_theravada_faith
				limit = {
					has_doctrine = rice_theravada_canon_doctrine
				}
				remove_doctrine = rice_theravada_canon_doctrine
				add_doctrine = rice_theravada_canon_jetavana_doctrine
			}
		}
		set_global_variable = {
			name = RICE_sri_lanka_ending_united_sangha_jetavana
			value = yes
		}
	}

	# Phase Doctrines
	if = {
		limit = {
			exists = struggle:RICE_sri_lanka_struggle
			struggle:RICE_sri_lanka_struggle = {
				is_struggle_phase = struggle_RICE_sri_lanka_phase_degeneration
			}
		}
		religion:buddhism_religion = {
			every_faith = {
				custom = RICE_every_theravada_faith
				limit = {
					has_doctrine = rice_theravada_canon_doctrine
				}
				add_doctrine = rice_theravada_degeneration_doctrine
			}
		}
	}
	else_if = {
		limit = {
			exists = struggle:RICE_sri_lanka_struggle
			struggle:RICE_sri_lanka_struggle = {
				is_struggle_phase = struggle_RICE_sri_lanka_phase_accumulation
			}
		}
		religion:buddhism_religion = {
			every_faith = {
				custom = RICE_every_theravada_faith
				limit = {
					has_doctrine = rice_theravada_canon_doctrine
				}
				add_doctrine = rice_theravada_accumulation_doctrine
			}
		}
	}
	else_if = {
		limit = {
			exists = struggle:RICE_sri_lanka_struggle
			struggle:RICE_sri_lanka_struggle = {
				is_struggle_phase = struggle_RICE_sri_lanka_phase_purification
			}
		}
		religion:buddhism_religion = {
			every_faith = {
				custom = RICE_every_theravada_faith
				limit = {
					has_doctrine = rice_theravada_canon_doctrine
				}
				add_doctrine = rice_theravada_purification_doctrine
			}
		}
	}
}