

RICE_setup_sri_lanka_flavor_pack_effect = {



	#########################################################################
	#
	# CULTURE AND RELIGION STUFF
	#
	#########################################################################

	culture:somali = { save_scope_as = somali }
	culture:komi = { save_scope_as = komi }

	culture:vedda = {
		get_all_innovations_from = scope:komi
		add_culture_tradition = tradition_RICE_cave_dwellers
		remove_variable = tradition_cooldown
	}

	culture:sinhala = {
		add_innovation = innovation_RICE_velakkara_guards
		remove_culture_tradition = tradition_ruling_caste
		remove_culture_tradition = tradition_fervent_temple_builders
		remove_culture_tradition = tradition_city_keepers
		add_culture_tradition = tradition_religious_patronage
		add_culture_tradition = tradition_stalwart_defenders
		add_culture_tradition = tradition_maritime_mercantilism
		add_culture_tradition = tradition_RICE_wewas
		remove_variable = tradition_cooldown
	}

	culture:tamil = {
		add_innovation = innovation_RICE_velakkara_guards
	}

	culture:gujarati = {
		add_culture_tradition = tradition_RICE_stepwells
		remove_variable = tradition_cooldown
	}

	culture:rajput = {
		add_culture_tradition = tradition_RICE_stepwells
		remove_variable = tradition_cooldown
	}

	culture:shona = {
		add_culture_tradition = tradition_RICE_zimbabwe
		add_culture_tradition = tradition_RICE_bantu_migrators
		remove_variable = tradition_cooldown
	}

	culture:makua = {		
		get_all_innovations_from = scope:somali
		add_culture_tradition = tradition_RICE_bantu_migrators
		remove_variable = tradition_cooldown
	}

	culture:makonde = {
		get_all_innovations_from = scope:somali
		add_culture_tradition = tradition_RICE_bantu_migrators
		remove_variable = tradition_cooldown
	}

	culture:mijikenda = {
		get_all_innovations_from = scope:somali
		add_culture_tradition = tradition_RICE_bantu_migrators
		remove_variable = tradition_cooldown
	}

	culture:pokomo = {
		get_all_innovations_from = scope:somali
		add_culture_tradition = tradition_RICE_bantu_migrators
		remove_variable = tradition_cooldown
	}

	culture:seuta = {
		get_all_innovations_from = scope:somali
		add_culture_tradition = tradition_RICE_bantu_migrators
		remove_variable = tradition_cooldown
	}

	culture:sabaki = {
		get_all_innovations_from = scope:somali
		add_culture_tradition = tradition_RICE_bantu_migrators
		remove_variable = tradition_cooldown
	}

	culture:ruvu = {
		get_all_innovations_from = scope:somali
		add_culture_tradition = tradition_RICE_bantu_migrators
		remove_variable = tradition_cooldown
	}

	culture:tsonga = {
		get_all_innovations_from = scope:somali
		add_culture_tradition = tradition_RICE_cattle_kraals
		add_culture_tradition = tradition_RICE_bantu_migrators
		remove_variable = tradition_cooldown
	}

	culture:nguni = {
		get_all_innovations_from = scope:somali
		add_culture_tradition = tradition_RICE_cattle_kraals
		add_culture_tradition = tradition_RICE_bantu_migrators
		remove_variable = tradition_cooldown
	}

	culture:sotho_tswana = {
		get_all_innovations_from = scope:somali
		add_culture_tradition = tradition_RICE_cattle_kraals
		add_culture_tradition = tradition_RICE_zimbabwe
		add_culture_tradition = tradition_RICE_bantu_migrators
		remove_variable = tradition_cooldown
	}

	culture:aweer = {
		get_all_innovations_from = scope:somali
	}

	culture:dahalo = {
		get_all_innovations_from = scope:somali
	}

	every_culture_global = {
		limit = {
			OR = {
				has_cultural_pillar = heritage_indo_aryan
				has_cultural_pillar = heritage_dravidian
			}
		}
		add_innovation = innovation_RICE_irrigation_tanks
	}

	every_county = {
		limit = {
			culture = culture:welayta
		}
		set_county_faith = faith:welayta_pagan
		holder = {
			if = {
				limit = {
					culture = culture:welayta
				}
				set_character_faith = faith:welayta_pagan
			}
			every_courtier_or_guest = {
				limit = {
					culture = culture:welayta
				}
				set_character_faith = faith:welayta_pagan
			}
		}
	}	



	#########################################################################
	#
	# TITLE HISTORY
	#
	#########################################################################

	# For 867 bookmark
	if = {
		limit = {
			game_start_date = 867.1.1
		}
		# Give some territory to Udaya
		character:189014 = {
			get_title = title:c_kandy
			RICE_setup_new_granted_ruler_bonuses_effect = yes
		}
		# Give some territory to Udaya
		character:RICE_sri_lanka_001 = {
			get_title = title:c_trincomalee
			get_title = title:c_batticaloa
			RICE_setup_new_granted_ruler_bonuses_effect = yes
		}
	}

	# For 1066 bookmark
	if = {
		limit = {
			game_start_date = 1066.9.15
		}
		# Give some territory to Budal/Buddharaja
		character:RICE_sri_lanka_002 = {
			get_title = title:c_dakhina_desa
			RICE_setup_new_granted_ruler_bonuses_effect = yes
		}
		character:189029 = {
			spawn_army = {
				name = RICE_vijayabahu_velakkara_guards
				men_at_arms = {
					type = RICE_velakkara
					stacks = 4
				}
				men_at_arms = {
					type = paiks
					stacks = 2
				}
				men_at_arms = {
					type = light_footmen
					stacks = 2
				}
				men_at_arms = {
					type = pikemen_unit
					stacks = 1
				}
				# men_at_arms = {
				# 	type = war_elephant
				# 	stacks = 1
				# }
				location = province:3266
				origin = province:3267
			}
		}

		character:RICE_sri_lanka_008 = {
			save_scope_as = lilavati
		}
		# Not actually true, but he was born after 1066 most likely so the timeline doesn't make sense to begin with
		character:189030 = {
			set_mother = scope:lilavati
		}

	}
	if = {
		limit = {
			game_start_date >= 990.1.1
		}
		title:c_phiti = {
			add_county_modifier = {
				modifier = RICE_sri_lanka_decline_of_anuradhapura
				years = 150
			}
		}
		title:c_phiti.title_province = {
			remove_building = generic_university
			add_special_building = RICE_sri_lanka_ruins_of_anuradhapura
		}
	}


	#########################################################################
	#
	# CULTURE/RELIGION HISTORY
	#
	#########################################################################

	# Natkokwe Burmese "paganism"
	if = {
		limit = {
			roa_is_active = no
		}
		title:c_takon = {
			set_county_faith = faith:burmic
		}
		title:c_takon.holder = {
			set_character_faith_with_conversion = faith:burmic
			every_courtier = {
				limit = {
					OR = {
						faith = faith:ari
						culture = { has_cultural_pillar = heritage_burman }
					}
				}
				random = {
					chance = 50
					set_character_faith_with_conversion = faith:burmic
				}
			}
		}
		title:c_hanlan = {
			set_county_faith = faith:burmic
		}
		title:c_hanlan.holder = {
			set_character_faith_with_conversion = faith:burmic
			every_courtier = {
				limit = {
					OR = {
						faith = faith:ari
						culture = { has_cultural_pillar = heritage_burman }
					}
				}
				random = {
					chance = 50
					set_character_faith_with_conversion = faith:burmic
				}
			}
		}
		title:c_kale = {
			set_county_faith = faith:burmic
		}
		title:c_kale.holder = {
			set_character_faith_with_conversion = faith:burmic
			every_courtier = {
				limit = {
					OR = {
						faith = faith:ari
						culture = { has_cultural_pillar = heritage_burman }
					}
				}
				random = {
					chance = 50
					set_character_faith_with_conversion = faith:burmic
				}
			}
		}
		# if = {
		# 	limit = {
		# 		game_start_date < 1050.1.1
		# 	}
		# 	title:c_kyaukse = {
		# 		set_county_faith = faith:burmic
		# 	}
		# 	title:c_madaya = {
		# 		set_county_faith = faith:burmic
		# 	}
		# 	title:c_hanlan.holder = {
		# 		set_character_faith_with_conversion = faith:burmic
		# 		every_courtier = {
		# 			limit = {
		# 				OR = {
		# 					faith = faith:ari
		# 					culture = { has_cultural_pillar = heritage_burman }
		# 				}
		# 			}
		# 			set_character_faith_with_conversion = faith:burmic
		# 		}
		# 	}
		# }
	}

	#########################################################################
	#
	# MISC STUFF
	#
	#########################################################################

	
	# Start the Sri Lanka struggle
	# Won't start on any other phase but the predefined starting phase
	# start_struggle = {
	# 	struggle_type = RICE_sri_lanka_struggle
	# 	start_phase = struggle_RICE_sri_lanka_phase_degeneration
	# }

}



RICE_setup_sri_lanka_after_game_start_effect = {


	# Starting Sri Lankan struggle phase based on game rule
	if = {
		limit = {
			has_game_rule = RICE_sri_lanka_starting_phase_accumulation
		}
		start_struggle = {
			struggle_type = RICE_sri_lanka_struggle
			start_phase = struggle_RICE_sri_lanka_phase_degeneration
		}
		# Won't start on any other phase but the predefined starting phase
		struggle:RICE_sri_lanka_struggle = {
			change_struggle_phase = struggle_RICE_sri_lanka_phase_accumulation
		}
	}
	else_if = {
		limit = {
			has_game_rule = RICE_sri_lanka_starting_phase_purification
		}
		start_struggle = {
			struggle_type = RICE_sri_lanka_struggle
			start_phase = struggle_RICE_sri_lanka_phase_degeneration
		}
		# Won't start on any other phase but the predefined starting phase
		struggle:RICE_sri_lanka_struggle = {
			change_struggle_phase = struggle_RICE_sri_lanka_phase_purification
		}
	}
	else_if = {
		limit = {
			has_game_rule = RICE_sri_lanka_starting_phase_degeneration
		}
		start_struggle = {
			struggle_type = RICE_sri_lanka_struggle
			start_phase = struggle_RICE_sri_lanka_phase_degeneration
		}
	}
	else_if = {
		limit = {
			has_game_rule = RICE_sri_lanka_starting_phase_random
		}
		start_struggle = {
			struggle_type = RICE_sri_lanka_struggle
			start_phase = struggle_RICE_sri_lanka_phase_degeneration
		}
		random_list = {
			10 = {
				# Stay in Degeneration, you degenerates
			}
			10 = {
				# Won't start on any other phase but the predefined starting phase
				struggle:RICE_sri_lanka_struggle = {
					change_struggle_phase = struggle_RICE_sri_lanka_phase_purification
				}
			}
			10 = {
				# Won't start on any other phase but the predefined starting phase
				struggle:RICE_sri_lanka_struggle = {
					change_struggle_phase = struggle_RICE_sri_lanka_phase_accumulation
				}
			}
		}
	}
	else = {
		if = {
			limit = {
				game_start_date >= 1150.1.1
			}
			start_struggle = {
				struggle_type = RICE_sri_lanka_struggle
				start_phase = struggle_RICE_sri_lanka_phase_degeneration
			}
			# Won't start on any other phase but the predefined starting phase
			struggle:RICE_sri_lanka_struggle = {
				change_struggle_phase = struggle_RICE_sri_lanka_phase_purification
			}
		}
		else_if = {
			limit = {
				game_start_date >= 990.1.1
			}
			start_struggle = {
				struggle_type = RICE_sri_lanka_struggle
				start_phase = struggle_RICE_sri_lanka_phase_degeneration
			}
		}
		else = {
			start_struggle = {
				struggle_type = RICE_sri_lanka_struggle
				start_phase = struggle_RICE_sri_lanka_phase_degeneration
			}
			# Won't start on any other phase but the predefined starting phase
			struggle:RICE_sri_lanka_struggle = {
				change_struggle_phase = struggle_RICE_sri_lanka_phase_accumulation
			}
		}
	}

	# Starting Sri Lankan Monastery Prominence based on game rule
	if = {
		limit = {
			has_game_rule = RICE_sri_lanka_starting_prominence_balanced
		}
		set_global_variable = {
			name = RICE_mahavihara_prominence
			value = 100
		}
	
		set_global_variable = {
			name = RICE_abhayagiri_prominence
			value = 100
		}
	
		set_global_variable = {
			name = RICE_jetavana_prominence
			value = 100
		}
	}
	else_if = {
		limit = {
			has_game_rule = RICE_sri_lanka_starting_prominence_balanced_high
		}
		set_global_variable = {
			name = RICE_mahavihara_prominence
			value = 300
		}
	
		set_global_variable = {
			name = RICE_abhayagiri_prominence
			value = 300
		}
	
		set_global_variable = {
			name = RICE_jetavana_prominence
			value = 300
		}
	}
	else_if = {
		limit = {
			has_game_rule = RICE_sri_lanka_starting_prominence_high
		}
		set_global_variable = {
			name = RICE_mahavihara_prominence
			value = 100
		}
	
		set_global_variable = {
			name = RICE_abhayagiri_prominence
			value = 100
		}
	
		set_global_variable = {
			name = RICE_jetavana_prominence
			value = 100
		}
	}
	else_if = {
		limit = {
			has_game_rule = RICE_sri_lanka_starting_prominence_random
		}
		
		set_global_variable = {
			name = RICE_mahavihara_prominence
			value = {
				value = 0
				add = {
					integer_range = {
						min = 1
						max = 200
					}
				}
			}
		}
		
		set_global_variable = {
			name = RICE_abhayagiri_prominence
			value = {
				value = 0
				add = {
					integer_range = {
						min = 1
						max = 200
					}
				}
			}
		}
		
		set_global_variable = {
			name = RICE_jetavana_prominence
			value = {
				value = 0
				add = {
					integer_range = {
						min = 1
						max = 200
					}
				}
			}
		}

	}
	else_if = {
		limit = {
			has_game_rule = RICE_sri_lanka_starting_prominence_random_high
		}
		
		set_global_variable = {
			name = RICE_mahavihara_prominence
			value = {
				value = 0
				add = {
					integer_range = {
						min = 1
						max = 400
					}
				}
			}
		}
		
		set_global_variable = {
			name = RICE_abhayagiri_prominence
			value = {
				value = 0
				add = {
					integer_range = {
						min = 1
						max = 400
					}
				}
			}
		}
		
		set_global_variable = {
			name = RICE_jetavana_prominence
			value = {
				value = 0
				add = {
					integer_range = {
						min = 1
						max = 400
					}
				}
			}
		}

	}
	# Default
	else = {
		set_global_variable = {
			name = RICE_mahavihara_prominence
			value = 150
		}
	
		set_global_variable = {
			name = RICE_abhayagiri_prominence
			value = 250
		}
	
		set_global_variable = {
			name = RICE_jetavana_prominence
			value = 50
		}
	}


	# 60% chance rulers in Sri Lanka start off with monastery traits
	struggle:RICE_sri_lanka_struggle = {
		every_involved_ruler = {
			limit = {
				is_ai = yes
			}
			random_list = {
				20 = { }
				10 = { add_trait = RICE_mahavihara_trait }
				10 = { add_trait = RICE_abhayagiri_trait }
				10 = { add_trait = RICE_jetavana_trait }
			}
		}
	}


}


RICE_setup_sri_lanka_display_values = {
	if = {
		limit = {
			OR = {
				AND = {						
					exists = struggle:RICE_sri_lanka_struggle
					any_character_struggle = {
						involvement = involved
						is_struggle_type = RICE_sri_lanka_struggle
					}	
				}		
				AND = {
					any_held_title = {
						tier = tier_county
						any_county_province = {
							geographical_region = RICE_sri_lanka_struggle_region		
						}
					}
					has_global_variable = RICE_sri_lanka_ending_united_sangha
				}
			}
		}
		send_interface_message = {
			type = event_generic_neutral
			title = RICE_sri_lanka_values_notification.title
			custom_tooltip = RICE_sri_lanka_values_notification.mahavihara_tooltip
			custom_tooltip = RICE_sri_lanka_values_notification.abhayagiri_tooltip
			custom_tooltip = RICE_sri_lanka_values_notification.jetavana_tooltip
		}
	}
}


RICE_sri_lanka_struggle_land_grant_buddhist_effect = {
	if = {
		limit = {
			exists = struggle:RICE_sri_lanka_struggle
			OR = {
				any_character_struggle = {
					involvement = involved
					is_struggle_type = RICE_sri_lanka_struggle
				}
				any_character_struggle = {
					involvement = interloper
					is_struggle_type = RICE_sri_lanka_struggle
				}
			}
		}
		struggle:RICE_sri_lanka_struggle = {
			activate_struggle_catalyst = {
				catalyst = catalyst_RICE_sri_lanka_land_grants_buddhist
				character = root
			}
		}
	}
}

RICE_sri_lanka_struggle_land_grant_non_buddhist_effect = {
	if = {
		limit = {
			exists = struggle:RICE_sri_lanka_struggle
			OR = {
				any_character_struggle = {
					involvement = involved
					is_struggle_type = RICE_sri_lanka_struggle
				}
				any_character_struggle = {
					involvement = interloper
					is_struggle_type = RICE_sri_lanka_struggle
				}
			}
		}
		struggle:RICE_sri_lanka_struggle = {
			activate_struggle_catalyst = {
				catalyst = catalyst_RICE_sri_lanka_land_grants_non_buddhist
				character = root
			}
		}
	}
}

RICE_sri_lanka_struggle_ending_uniter_effect = {
	give_nickname = nick_the_great
	if = {
		limit = {
			religion = religion:buddhism
		}
		add_piety = 1000
	}
	else = {
		add_prestige = 1000
	}
	dynasty = {
		add_dynasty_prestige = 1000
		add_dynasty_modifier = {
			modifier = RICE_sri_lanka_sangha_uniter_modifier
		}
	}
	set_global_variable = {
		name = RICE_sri_lanka_ending_united_sangha
		value = yes
	}
	RICE_sri_lanka_struggle_ending_doctrine_effect = yes
	RICE_sri_lanka_struggle_ending_phase_effect = yes
}

RICE_sri_lanka_struggle_ending_destroyer_effect = {
	give_nickname = nick_the_sangha_destroyer
	add_prestige = 500
	add_gold = 3000
	dynasty = {
		add_dynasty_modifier = {
			modifier = RICE_sri_lanka_sangha_destroyer_modifier
		}
	}
	set_global_variable = {
		name = RICE_sri_lanka_ending_destroyed_sangha
		value = yes
	}
	religion:buddhism_religion = {
		every_faith = {
			custom = RICE_every_theravada_faith
			limit = {
				has_doctrine = rice_theravada_canon_doctrine
			}
			add_doctrine = rice_theravada_destruction_of_sangha_doctrine
		}
	}
}

RICE_sri_lanka_struggle_ending_foreigner_effect = {
	give_nickname = nick_the_great
	add_piety = 500
	add_prestige = 500
	dynasty = {
		add_dynasty_prestige = 1000
		add_dynasty_modifier = {
			modifier = RICE_sri_lanka_sangha_reviver_modifier
		}
	}
	set_global_variable = {
		name = RICE_sri_lanka_ending_united_sangha
		value = yes
	}
	set_global_variable = {
		name = RICE_sri_lanka_ending_revived_sangha
		value = yes
	}
	RICE_sri_lanka_struggle_ending_doctrine_effect = yes
	religion:buddhism_religion = {
		every_faith = {
			custom = RICE_every_theravada_faith
			limit = {
				has_doctrine = rice_theravada_canon_doctrine
			}
			add_doctrine = rice_theravada_outsider_doctrine
		}
	}
}

RICE_sri_lanka_struggle_ending_doctrine_effect = {

	# Upgraded Pali Canon doctrines
	if = {
		limit = {
			has_trait = RICE_mahavihara_trait
		}
		religion:buddhism_religion = {
			every_faith = {
				custom = RICE_every_theravada_faith
				limit = {
					has_doctrine = rice_theravada_canon_doctrine
				}
				remove_doctrine = rice_theravada_canon_doctrine
				add_doctrine = rice_theravada_canon_mahavihara_doctrine
			}
		}
		set_global_variable = {
			name = RICE_sri_lanka_ending_united_sangha_mahavihara
			value = yes
		}
	}
	else_if = {
		limit = {
			has_trait = RICE_abhayagiri_trait
		}
		religion:buddhism_religion = {
			every_faith = {
				custom = RICE_every_theravada_faith
				limit = {
					has_doctrine = rice_theravada_canon_doctrine
				}
				remove_doctrine = rice_theravada_canon_doctrine
				add_doctrine = rice_theravada_canon_abhayagiri_doctrine
			}
		}
		set_global_variable = {
			name = RICE_sri_lanka_ending_united_sangha_abhayagiri
			value = yes
		}
	}
	else_if = {
		limit = {
			has_trait = RICE_jetavana_trait
		}
		religion:buddhism_religion = {
			every_faith = {
				custom = RICE_every_theravada_faith
				limit = {
					has_doctrine = rice_theravada_canon_doctrine
				}
				remove_doctrine = rice_theravada_canon_doctrine
				add_doctrine = rice_theravada_canon_jetavana_doctrine
			}
		}
		set_global_variable = {
			name = RICE_sri_lanka_ending_united_sangha_jetavana
			value = yes
		}
	}
}

RICE_sri_lanka_struggle_ending_phase_effect = {
	# Phase Doctrines
	if = {
		limit = {
			exists = struggle:RICE_sri_lanka_struggle
			struggle:RICE_sri_lanka_struggle = {
				is_struggle_phase = struggle_RICE_sri_lanka_phase_degeneration
			}
		}
		religion:buddhism_religion = {
			every_faith = {
				custom = RICE_every_theravada_faith
				limit = {
					has_doctrine = rice_theravada_canon_doctrine
				}
				add_doctrine = rice_theravada_degeneration_doctrine
			}
		}
	}
	else_if = {
		limit = {
			exists = struggle:RICE_sri_lanka_struggle
			struggle:RICE_sri_lanka_struggle = {
				is_struggle_phase = struggle_RICE_sri_lanka_phase_accumulation
			}
		}
		religion:buddhism_religion = {
			every_faith = {
				custom = RICE_every_theravada_faith
				limit = {
					has_doctrine = rice_theravada_canon_doctrine
				}
				add_doctrine = rice_theravada_accumulation_doctrine
			}
		}
	}
	else_if = {
		limit = {
			exists = struggle:RICE_sri_lanka_struggle
			struggle:RICE_sri_lanka_struggle = {
				is_struggle_phase = struggle_RICE_sri_lanka_phase_purification
			}
		}
		religion:buddhism_religion = {
			every_faith = {
				custom = RICE_every_theravada_faith
				limit = {
					has_doctrine = rice_theravada_canon_doctrine
				}
				add_doctrine = rice_theravada_purification_doctrine
			}
		}
	}
}

RICE_sri_lanka_monastery_prominence_gain_minor_effect = {
	if = {
		limit = {
			has_trait = RICE_mahavihara_trait
		}
		change_global_variable = {
			name = RICE_mahavihara_prominence
			add = RICE_sri_lanka_prominence_gain_minor
		}
		add_trait_xp = {
			trait = RICE_mahavihara_trait
			value = RICE_sri_lanka_patron_trait_gain_minor
		}
	}
	else_if = {
		limit = {
			has_trait = RICE_abhayagiri_trait
		}
		change_global_variable = {
			name = RICE_abhayagiri_prominence
			add = RICE_sri_lanka_prominence_gain_minor
		}
		add_trait_xp = {
			trait = RICE_abhayagiri_trait
			value = RICE_sri_lanka_patron_trait_gain_minor
		}
	}
	else_if = {
		limit = {
			has_trait = RICE_jetavana_trait
		}
		change_global_variable = {
			name = RICE_jetavana_prominence
			add = RICE_sri_lanka_prominence_gain_minor
		}
		add_trait_xp = {
			trait = RICE_jetavana_trait
			value = RICE_sri_lanka_patron_trait_gain_minor
		}
	}
}

RICE_sri_lanka_monastery_prominence_gain_medium_effect = {
	if = {
		limit = {
			has_trait = RICE_mahavihara_trait
		}
		change_global_variable = {
			name = RICE_mahavihara_prominence
			add = RICE_sri_lanka_prominence_gain_medium
		}
		add_trait_xp = {
			trait = RICE_mahavihara_trait
			value = RICE_sri_lanka_patron_trait_gain_medium
		}
	}
	else_if = {
		limit = {
			has_trait = RICE_abhayagiri_trait
		}
		change_global_variable = {
			name = RICE_abhayagiri_prominence
			add = RICE_sri_lanka_prominence_gain_medium
		}
		add_trait_xp = {
			trait = RICE_abhayagiri_trait
			value = RICE_sri_lanka_patron_trait_gain_medium
		}
	}
	else_if = {
		limit = {
			has_trait = RICE_jetavana_trait
		}
		change_global_variable = {
			name = RICE_jetavana_prominence
			add = RICE_sri_lanka_prominence_gain_medium
		}
		add_trait_xp = {
			trait = RICE_jetavana_trait
			value = RICE_sri_lanka_patron_trait_gain_medium
		}
	}
}

RICE_sri_lanka_monastery_prominence_gain_major_effect = {
	if = {
		limit = {
			has_trait = RICE_mahavihara_trait
		}
		change_global_variable = {
			name = RICE_mahavihara_prominence
			add = RICE_sri_lanka_prominence_gain_major
		}
		add_trait_xp = {
			trait = RICE_mahavihara_trait
			value = RICE_sri_lanka_patron_trait_gain_major
		}
	}
	else_if = {
		limit = {
			has_trait = RICE_abhayagiri_trait
		}
		change_global_variable = {
			name = RICE_abhayagiri_prominence
			add = RICE_sri_lanka_prominence_gain_major
		}
		add_trait_xp = {
			trait = RICE_abhayagiri_trait
			value = RICE_sri_lanka_patron_trait_gain_major
		}
	}
	else_if = {
		limit = {
			has_trait = RICE_jetavana_trait
		}
		change_global_variable = {
			name = RICE_jetavana_prominence
			add = RICE_sri_lanka_prominence_gain_major
		}
		add_trait_xp = {
			trait = RICE_jetavana_trait
			value = RICE_sri_lanka_patron_trait_gain_major
		}
	}
}



RICE_sri_lanka_all_monasteries_prominence_loss_minor_effect = {
	if = {
		limit = {
			has_trait = RICE_mahavihara_trait
		}
		change_global_variable = {
			name = RICE_mahavihara_prominence
			add = RICE_sri_lanka_prominence_loss_minor
		}
		change_global_variable = {
			name = RICE_abhayagiri_prominence
			add = RICE_sri_lanka_prominence_loss_medium
		}
		change_global_variable = {
			name = RICE_jetavana_prominence
			add = RICE_sri_lanka_prominence_loss_medium
		}
		add_trait_xp = {
			trait = RICE_mahavihara_trait
			value = RICE_sri_lanka_patron_trait_loss_minor
		}
	}
	else_if = {
		limit = {
			has_trait = RICE_abhayagiri_trait
		}
		change_global_variable = {
			name = RICE_mahavihara_prominence
			add = RICE_sri_lanka_prominence_loss_medium
		}
		change_global_variable = {
			name = RICE_abhayagiri_prominence
			add = RICE_sri_lanka_prominence_loss_minor
		}
		change_global_variable = {
			name = RICE_jetavana_prominence
			add = RICE_sri_lanka_prominence_loss_medium
		}
		add_trait_xp = {
			trait = RICE_abhayagiri_trait
			value = RICE_sri_lanka_patron_trait_loss_minor
		}
	}
	else_if = {
		limit = {
			has_trait = RICE_jetavana_trait
		}
		change_global_variable = {
			name = RICE_mahavihara_prominence
			add = RICE_sri_lanka_prominence_loss_medium
		}
		change_global_variable = {
			name = RICE_abhayagiri_prominence
			add = RICE_sri_lanka_prominence_loss_medium
		}
		change_global_variable = {
			name = RICE_jetavana_prominence
			add = RICE_sri_lanka_prominence_loss_minor
		}
		add_trait_xp = {
			trait = RICE_jetavana_trait
			value = RICE_sri_lanka_patron_trait_loss_minor
		}
	}
	else = {
		change_global_variable = {
			name = RICE_mahavihara_prominence
			add = RICE_sri_lanka_prominence_loss_medium
		}
		change_global_variable = {
			name = RICE_abhayagiri_prominence
			add = RICE_sri_lanka_prominence_loss_medium
		}
		change_global_variable = {
			name = RICE_jetavana_prominence
			add = RICE_sri_lanka_prominence_loss_medium
		}
	}
}

RICE_sri_lanka_monastery_prominence_all_loss_medium_effect = {
	if = {
		limit = {
			has_trait = RICE_mahavihara_trait
		}
		change_global_variable = {
			name = RICE_mahavihara_prominence
			add = RICE_sri_lanka_prominence_loss_medium
		}
		change_global_variable = {
			name = RICE_abhayagiri_prominence
			add = RICE_sri_lanka_prominence_loss_major
		}
		change_global_variable = {
			name = RICE_jetavana_prominence
			add = RICE_sri_lanka_prominence_loss_major
		}
		add_trait_xp = {
			trait = RICE_mahavihara_trait
			value = RICE_sri_lanka_patron_trait_loss_medium
		}
	}
	else_if = {
		limit = {
			has_trait = RICE_abhayagiri_trait
		}
		change_global_variable = {
			name = RICE_mahavihara_prominence
			add = RICE_sri_lanka_prominence_loss_major
		}
		change_global_variable = {
			name = RICE_abhayagiri_prominence
			add = RICE_sri_lanka_prominence_loss_medium
		}
		change_global_variable = {
			name = RICE_jetavana_prominence
			add = RICE_sri_lanka_prominence_loss_major
		}
		add_trait_xp = {
			trait = RICE_abhayagiri_trait
			value = RICE_sri_lanka_patron_trait_loss_medium
		}
	}
	else_if = {
		limit = {
			has_trait = RICE_jetavana_trait
		}
		change_global_variable = {
			name = RICE_mahavihara_prominence
			add = RICE_sri_lanka_prominence_loss_major
		}
		change_global_variable = {
			name = RICE_abhayagiri_prominence
			add = RICE_sri_lanka_prominence_loss_major
		}
		change_global_variable = {
			name = RICE_jetavana_prominence
			add = RICE_sri_lanka_prominence_loss_medium
		}
		add_trait_xp = {
			trait = RICE_jetavana_trait
			value = RICE_sri_lanka_patron_trait_loss_medium
		}
	}
	else = {
		change_global_variable = {
			name = RICE_mahavihara_prominence
			add = RICE_sri_lanka_prominence_loss_major
		}
		change_global_variable = {
			name = RICE_abhayagiri_prominence
			add = RICE_sri_lanka_prominence_loss_major
		}
		change_global_variable = {
			name = RICE_jetavana_prominence
			add = RICE_sri_lanka_prominence_loss_major
		}
	}
}

RICE_sri_lanka_monastery_prominence_all_loss_major_effect = {
	if = {
		limit = {
			has_trait = RICE_mahavihara_trait
		}
		change_global_variable = {
			name = RICE_mahavihara_prominence
			add = RICE_sri_lanka_prominence_loss_major
		}
		change_global_variable = {
			name = RICE_abhayagiri_prominence
			add = RICE_sri_lanka_prominence_loss_massive
		}
		change_global_variable = {
			name = RICE_jetavana_prominence
			add = RICE_sri_lanka_prominence_loss_massive
		}
		add_trait_xp = {
			trait = RICE_mahavihara_trait
			value = RICE_sri_lanka_patron_trait_loss_major
		}
	}
	else_if = {
		limit = {
			has_trait = RICE_abhayagiri_trait
		}
		change_global_variable = {
			name = RICE_mahavihara_prominence
			add = RICE_sri_lanka_prominence_loss_massive
		}
		change_global_variable = {
			name = RICE_abhayagiri_prominence
			add = RICE_sri_lanka_prominence_loss_major
		}
		change_global_variable = {
			name = RICE_jetavana_prominence
			add = RICE_sri_lanka_prominence_loss_massive
		}
		add_trait_xp = {
			trait = RICE_abhayagiri_trait
			value = RICE_sri_lanka_patron_trait_loss_major
		}
	}
	else_if = {
		limit = {
			has_trait = RICE_jetavana_trait
		}
		change_global_variable = {
			name = RICE_mahavihara_prominence
			add = RICE_sri_lanka_prominence_loss_massive
		}
		change_global_variable = {
			name = RICE_abhayagiri_prominence
			add = RICE_sri_lanka_prominence_loss_massive
		}
		change_global_variable = {
			name = RICE_jetavana_prominence
			add = RICE_sri_lanka_prominence_loss_major
		}
		add_trait_xp = {
			trait = RICE_jetavana_trait
			value = RICE_sri_lanka_patron_trait_loss_major
		}
	}
	else = {
		change_global_variable = {
			name = RICE_mahavihara_prominence
			add = RICE_sri_lanka_prominence_loss_massive
		}
		change_global_variable = {
			name = RICE_abhayagiri_prominence
			add = RICE_sri_lanka_prominence_loss_massive
		}
		change_global_variable = {
			name = RICE_jetavana_prominence
			add = RICE_sri_lanka_prominence_loss_massive
		}
	}
}




RICE_sri_lanka_all_monasteries_prominence_all_loss_minor_effect_tooltip = {
	if = {
		limit = {
			has_trait = RICE_mahavihara_trait
		}
		custom_tooltip = RICE_sri_lanka_abhayagiri_prominence_decrease_minor_tooltip
		custom_tooltip = RICE_sri_lanka_jetavana_prominence_decrease_minor_tooltip
	}
	else_if = {
		limit = {
			has_trait = RICE_abhayagiri_trait
		}
		custom_tooltip = RICE_sri_lanka_mahavihara_prominence_decrease_minor_tooltip
		custom_tooltip = RICE_sri_lanka_jetavana_prominence_decrease_minor_tooltip
	}
	else_if = {
		limit = {
			has_trait = RICE_jetavana_trait
		}
		custom_tooltip = RICE_sri_lanka_mahavihara_prominence_decrease_minor_tooltip
		custom_tooltip = RICE_sri_lanka_abhayagiri_prominence_decrease_minor_tooltip
	}
	else = {
		custom_tooltip = RICE_sri_lanka_mahavihara_prominence_decrease_minor_tooltip
		custom_tooltip = RICE_sri_lanka_abhayagiri_prominence_decrease_minor_tooltip
		custom_tooltip = RICE_sri_lanka_jetavana_prominence_decrease_minor_tooltip
	}
}

RICE_sri_lanka_all_monasteries_prominence_all_loss_medium_effect_tooltip = {
	if = {
		limit = {
			has_trait = RICE_mahavihara_trait
		}
		custom_tooltip = RICE_sri_lanka_mahavihara_prominence_decrease_minor_tooltip
		custom_tooltip = RICE_sri_lanka_abhayagiri_prominence_decrease_medium_tooltip
		custom_tooltip = RICE_sri_lanka_jetavana_prominence_decrease_medium_tooltip
	}
	else_if = {
		limit = {
			has_trait = RICE_abhayagiri_trait
		}
		custom_tooltip = RICE_sri_lanka_mahavihara_prominence_decrease_medium_tooltip
		custom_tooltip = RICE_sri_lanka_abhayagiri_prominence_decrease_minor_tooltip
		custom_tooltip = RICE_sri_lanka_jetavana_prominence_decrease_medium_tooltip
	}
	else_if = {
		limit = {
			has_trait = RICE_jetavana_trait
		}
		custom_tooltip = RICE_sri_lanka_mahavihara_prominence_decrease_medium_tooltip
		custom_tooltip = RICE_sri_lanka_abhayagiri_prominence_decrease_medium_tooltip
		custom_tooltip = RICE_sri_lanka_jetavana_prominence_decrease_minor_tooltip
	}
	else = {
		custom_tooltip = RICE_sri_lanka_mahavihara_prominence_decrease_medium_tooltip
		custom_tooltip = RICE_sri_lanka_abhayagiri_prominence_decrease_medium_tooltip
		custom_tooltip = RICE_sri_lanka_jetavana_prominence_decrease_medium_tooltip
	}
}


RICE_sri_lanka_all_monasteries_prominence_all_loss_major_effect_tooltip = {
	if = {
		limit = {
			has_trait = RICE_mahavihara_trait
		}
		custom_tooltip = RICE_sri_lanka_mahavihara_prominence_decrease_medium_tooltip
		custom_tooltip = RICE_sri_lanka_abhayagiri_prominence_decrease_major_tooltip
		custom_tooltip = RICE_sri_lanka_jetavana_prominence_decrease_major_tooltip
	}
	else_if = {
		limit = {
			has_trait = RICE_abhayagiri_trait
		}
		custom_tooltip = RICE_sri_lanka_mahavihara_prominence_decrease_major_tooltip
		custom_tooltip = RICE_sri_lanka_abhayagiri_prominence_decrease_medium_tooltip
		custom_tooltip = RICE_sri_lanka_jetavana_prominence_decrease_major_tooltip
	}
	else_if = {
		limit = {
			has_trait = RICE_jetavana_trait
		}
		custom_tooltip = RICE_sri_lanka_mahavihara_prominence_decrease_major_tooltip
		custom_tooltip = RICE_sri_lanka_abhayagiri_prominence_decrease_major_tooltip
		custom_tooltip = RICE_sri_lanka_jetavana_prominence_decrease_medium_tooltip
	}
	else = {
		custom_tooltip = RICE_sri_lanka_mahavihara_prominence_decrease_major_tooltip
		custom_tooltip = RICE_sri_lanka_abhayagiri_prominence_decrease_major_tooltip
		custom_tooltip = RICE_sri_lanka_jetavana_prominence_decrease_major_tooltip
	}
}


RICE_sri_lanka_all_monasteries_prominence_all_loss_massive_effect_tooltip = {
	if = {
		limit = {
			has_trait = RICE_mahavihara_trait
		}
		custom_tooltip = RICE_sri_lanka_mahavihara_prominence_decrease_major_tooltip
		custom_tooltip = RICE_sri_lanka_abhayagiri_prominence_decrease_massive_tooltip
		custom_tooltip = RICE_sri_lanka_jetavana_prominence_decrease_massive_tooltip
	}
	else_if = {
		limit = {
			has_trait = RICE_abhayagiri_trait
		}
		custom_tooltip = RICE_sri_lanka_mahavihara_prominence_decrease_massive_tooltip
		custom_tooltip = RICE_sri_lanka_abhayagiri_prominence_decrease_major_tooltip
		custom_tooltip = RICE_sri_lanka_jetavana_prominence_decrease_massive_tooltip
	}
	else_if = {
		limit = {
			has_trait = RICE_jetavana_trait
		}
		custom_tooltip = RICE_sri_lanka_mahavihara_prominence_decrease_massive_tooltip
		custom_tooltip = RICE_sri_lanka_abhayagiri_prominence_decrease_massive_tooltip
		custom_tooltip = RICE_sri_lanka_jetavana_prominence_decrease_major_tooltip
	}
	else = {
		custom_tooltip = RICE_sri_lanka_mahavihara_prominence_decrease_massive_tooltip
		custom_tooltip = RICE_sri_lanka_abhayagiri_prominence_decrease_massive_tooltip
		custom_tooltip = RICE_sri_lanka_jetavana_prominence_decrease_massive_tooltip
	}
}

RICE_sri_lanka_all_monasteries_prominence_all_loss_monumental_effect_tooltip = {
	if = {
		limit = {
			has_trait = RICE_mahavihara_trait
		}
		custom_tooltip = RICE_sri_lanka_mahavihara_prominence_decrease_massive_tooltip
		custom_tooltip = RICE_sri_lanka_abhayagiri_prominence_decrease_monumental_tooltip
		custom_tooltip = RICE_sri_lanka_jetavana_prominence_decrease_monumental_tooltip
	}
	else_if = {
		limit = {
			has_trait = RICE_abhayagiri_trait
		}
		custom_tooltip = RICE_sri_lanka_mahavihara_prominence_decrease_monumental_tooltip
		custom_tooltip = RICE_sri_lanka_abhayagiri_prominence_decrease_massive_tooltip
		custom_tooltip = RICE_sri_lanka_jetavana_prominence_decrease_monumental_tooltip
	}
	else_if = {
		limit = {
			has_trait = RICE_jetavana_trait
		}
		custom_tooltip = RICE_sri_lanka_mahavihara_prominence_decrease_monumental_tooltip
		custom_tooltip = RICE_sri_lanka_abhayagiri_prominence_decrease_monumental_tooltip
		custom_tooltip = RICE_sri_lanka_jetavana_prominence_decrease_massive_tooltip
	}
	else = {
		custom_tooltip = RICE_sri_lanka_mahavihara_prominence_decrease_monumental_tooltip
		custom_tooltip = RICE_sri_lanka_abhayagiri_prominence_decrease_monumental_tooltip
		custom_tooltip = RICE_sri_lanka_jetavana_prominence_decrease_monumental_tooltip
	}
}






RICE_sri_lanka_vijayabahu_reward_budal_effect = {
	add_prestige = 500
	if = {
		limit = {
			character:RICE_sri_lanka_002 = {
				is_alive = yes
			}
		}
		character:RICE_sri_lanka_002 = {
			add_prestige = 500
			add_piety = 500
		}
		if = {
			limit = {
				character:RICE_sri_lanka_002 = {
					is_ruler = yes
					is_independent_ruler = no
				}	
			}
			character:RICE_sri_lanka_002 = {
				vassal_contract_set_obligation_level = {
					type = title_revocation_rights
					level = 1
				}
			}
		}
	}
	dynasty:RICE_sitnaru_bim = {
		add_dynasty_prestige = 1000
		add_dynasty_modifier = {
			modifier = RICE_sri_lanka_budal_dynasty_privileges
			years = 1000
		}
	}
}





RICE_sri_lanka_struggle_irrigation_tank_small_effect = {
	if = {
		limit = {
			exists = struggle:RICE_sri_lanka_struggle
			any_character_struggle = {
				involvement = involved
				is_struggle_type = RICE_sri_lanka_struggle
			}
		}
		struggle:RICE_sri_lanka_struggle = {
			activate_struggle_catalyst = {
				catalyst = catalayst_RICE_irrigation_tank_small
				character = root
			}
		}
	}
}

RICE_sri_lanka_struggle_irrigation_tank_medium_effect = {
	if = {
		limit = {
			exists = struggle:RICE_sri_lanka_struggle
			any_character_struggle = {
				involvement = involved
				is_struggle_type = RICE_sri_lanka_struggle
			}
		}
		struggle:RICE_sri_lanka_struggle = {
			activate_struggle_catalyst = {
				catalyst = catalayst_RICE_irrigation_tank_medium
				character = root
			}
		}
	}
}

RICE_sri_lanka_struggle_irrigation_tank_large_effect = {
	if = {
		limit = {
			exists = struggle:RICE_sri_lanka_struggle
			any_character_struggle = {
				involvement = involved
				is_struggle_type = RICE_sri_lanka_struggle
			}
		}
		struggle:RICE_sri_lanka_struggle = {
			activate_struggle_catalyst = {
				catalyst = catalayst_RICE_irrigation_tank_large
				character = root
			}
		}
	}
}

RICE_sri_lanka_struggle_irrigation_tank_huge_effect = {
	if = {
		limit = {
			exists = struggle:RICE_sri_lanka_struggle
			any_character_struggle = {
				involvement = involved
				is_struggle_type = RICE_sri_lanka_struggle
			}
		}
		struggle:RICE_sri_lanka_struggle = {
			activate_struggle_catalyst = {
				catalyst = catalayst_RICE_irrigation_tank_huge
				character = root
			}
		}
	}
}

RICE_sri_lanka_polonnaruwa_capital_effect = {
	title:c_trincomalee = {
		change_development_level = 5
		change_county_control = medium_county_control_gain
		add_county_modifier = {
			modifier = RICE_sri_lanka_polonnaruwa_capital_modifier
			years = 100
		}
	}
	title:d_sinhala = { set_capital_county = title:c_trincomalee }
	title:k_lanka = { set_capital_county = title:c_trincomalee }
	if = {
		limit = {
			has_title = title:c_trincomalee
		}
		title:c_trincomalee.holder = {
			set_realm_capital = title:c_trincomalee
			give_nickname = nick_the_great
		}
	}
	if = {
		limit = {
			title:c_trincomalee = {
				title_province = { has_special_building = no }
			}
		}
		title:c_trincomalee.title_province = {
			add_special_building_slot = generic_university
			add_building = generic_university
		}
	}
}



RICE_sri_lanka_ramasetu_pilgrimage_completed_log_entry_effect = {
	scope:activity = {
		add_activity_log_entry = {
			key = RICE_sri_lanka_ramasetu_pilgrimage_completed_log
			tags = { completed }
			# this line below adds the entry to the Effects section of the conclusion UI
			show_in_conclusion = yes
			character = root
			scope:host = {
				RICE_local_pilgrimage_generic_host_effect = yes
				stress_impact = {
					base = minor_stress_impact_loss
				}
				if = {
					limit = {
						has_character_modifier = RICE_sri_lanka_ramasetu_inspiration_rama
					}
					show_as_tooltip = {
						add_character_modifier = {
							modifier = RICE_sri_lanka_ramasetu_inspiration_rama
						}
					}
				}
				else_if = {
					limit = {
						has_character_modifier = RICE_sri_lanka_ramasetu_inspiration_ravana_war
					}
					show_as_tooltip = {
						add_character_modifier = {
							modifier = RICE_sri_lanka_ramasetu_inspiration_ravana_war
						}
					}
				}
				else_if = {
					limit = {
						has_character_modifier = RICE_sri_lanka_ramasetu_inspiration_nala_nila
					}
					show_as_tooltip = {
						add_character_modifier = {
							modifier = RICE_sri_lanka_ramasetu_inspiration_nala_nila
						}
					}
				}
				else_if = {
					limit = {
						has_character_modifier = RICE_sri_lanka_ramasetu_inspiration_vibhishana
					}
					show_as_tooltip = {
						add_character_modifier = {
							modifier = RICE_sri_lanka_ramasetu_inspiration_vibhishana
						}
					}
				}
				else_if = {
					limit = {
						has_character_modifier = RICE_sri_lanka_ramasetu_inspiration_sita
					}
					show_as_tooltip = {
						add_character_modifier = {
							modifier = RICE_sri_lanka_ramasetu_inspiration_sita
						}
					}
				}
				else_if = {
					limit = {
						has_character_modifier = RICE_sri_lanka_ramasetu_inspiration_hanuman
					}
					show_as_tooltip = {
						add_character_modifier = {
							modifier = RICE_sri_lanka_ramasetu_inspiration_hanuman
						}
					}
				}
			}
			every_attending_character = {
				limit = { NOT = { this = scope:host } }
				custom = EVERY_ACTIVITY_PARTICIPANT_EFFECT
				RICE_local_pilgrimage_generic_guest_effect = yes
			}	
		}
	}
}




RICE_sri_lanka_relic_veneration_effect = {
	if = {
		limit = {			
			involved_activity = {
				has_activity_option = { category = special_type option = RICE_sri_lanka_relic_veneration_type_bodhi }
			}
		}
		if = {
			limit = {
				OR = {
					has_trait = RICE_mahavihara_trait
					has_global_variable = RICE_sri_lanka_ending_united_sangha_bodhi
				}
			}
			RICE_sri_lanka_monastery_prominence_gain_medium_effect = yes
			add_character_modifier = {
				modifier = RICE_sri_lanka_relic_bodhi_great_modifier
				years = 10
			}
		}
		else = {
			change_global_variable = {
				name = RICE_mahavihara_prominence
				add = RICE_sri_lanka_prominence_gain_minor
			}
			add_character_modifier = {
				modifier = RICE_sri_lanka_relic_bodhi_modifier
				years = 10
			}
		}
		change_global_variable = {
			name = RICE_abhayagiri_prominence
			subtract = RICE_sri_lanka_prominence_gain_minor
		}
		change_global_variable = {
			name = RICE_jetavana_prominence
			subtract = RICE_sri_lanka_prominence_gain_minor
		}
	}
	else_if = {
		limit = {
			involved_activity = {
				has_activity_option = { category = special_type option = RICE_sri_lanka_relic_veneration_type_tooth }
			}			
		}
		if = {
			limit = {
				OR = {
					has_trait = RICE_abhayagiri_trait
					has_global_variable = RICE_sri_lanka_ending_united_sangha_tooth
				}
			}
			RICE_sri_lanka_monastery_prominence_gain_medium_effect = yes
			add_character_modifier = {
				modifier = RICE_sri_lanka_relic_tooth_great_modifier
				years = 10
			}
		}
		else = {
			change_global_variable = {
				name = RICE_abhayagiri_prominence
				add = RICE_sri_lanka_prominence_gain_minor
			}
			add_character_modifier = {
				modifier = RICE_sri_lanka_relic_tooth_modifier
				years = 10
			}
		}
		change_global_variable = {
			name = RICE_mahavihara_prominence
			subtract = RICE_sri_lanka_prominence_gain_minor
		}
		change_global_variable = {
			name = RICE_jetavana_prominence
			subtract = RICE_sri_lanka_prominence_gain_minor
		}
	}
	else_if = {
		limit = {
			involved_activity = {
				has_activity_option = { category = special_type option = RICE_sri_lanka_relic_veneration_type_dharmadhatu }
			}			
		}
		if = {
			limit = {
				OR = {
					has_trait = RICE_jetavana_trait
					has_global_variable = RICE_sri_lanka_ending_united_sangha_dharmadhatu
				}
			}
			RICE_sri_lanka_monastery_prominence_gain_medium_effect = yes
			add_character_modifier = {
				modifier = RICE_sri_lanka_relic_dharmadhatu_great_modifier
				years = 10
			}
		}
		else = {
			change_global_variable = {
				name = RICE_jetavana_prominence
				add = RICE_sri_lanka_prominence_gain_minor
			}
			add_character_modifier = {
				modifier = RICE_sri_lanka_relic_dharmadhatu_modifier
				years = 10
			}
		}
		change_global_variable = {
			name = RICE_mahavihara_prominence
			subtract = RICE_sri_lanka_prominence_gain_minor
		}
		change_global_variable = {
			name = RICE_abhayagiri_prominence
			subtract = RICE_sri_lanka_prominence_gain_minor
		}
	}
	add_piety = 100
	add_prestige = 50
	stress_impact = {
		base = miniscule_stress_impact_loss
		zealous = minor_stress_impact_loss
	}
}




RICE_sri_lanka_relic_veneration_completed_log_entry_effect = {
	scope:activity = {
		add_activity_log_entry = {
			key = RICE_sri_lanka_relic_veneration_completed_log
			tags = { completed }
			# this line below adds the entry to the Effects section of the conclusion UI
			show_in_conclusion = yes
			character = root
			scope:host = {
				RICE_sri_lanka_relic_veneration_effect = yes
				if = {
					limit = {
						exists = struggle:RICE_sri_lanka_struggle
						any_character_struggle = {
							involvement = involved
							is_struggle_type = RICE_sri_lanka_struggle
						}
					}
					struggle:RICE_sri_lanka_struggle = {
						activate_struggle_catalyst = {
							catalyst = catalayst_RICE_sri_lanka_relic_veneration
							character = scope:host
						}
					}
				}
			}
			
			every_attending_character = {
				limit = { NOT = { this = scope:host } }
				custom = EVERY_ACTIVITY_PARTICIPANT_EFFECT
				add_piety = 50
			}	
		}
	}
}

RICE_sri_lanka_relic_veneration_monastery_prominence_log_entry_effect = {
	scope:activity = {
		add_activity_log_entry = {
			key = RICE_sri_lanka_relic_veneration_monastery_prominence_log
			# this line below adds the entry to the Effects section of the conclusion UI
			show_in_conclusion = yes
			character = root
			scope:host = {
				show_as_tooltip = {
					if = {
						limit = {			
							involved_activity = {
								has_activity_option = { category = special_type option = RICE_sri_lanka_relic_veneration_type_bodhi }
							}
						}
						if = {
							limit = {
								OR = {
									has_trait = RICE_mahavihara_trait
									has_global_variable = RICE_sri_lanka_ending_united_sangha_bodhi
								}
							}
							custom_tooltip = RICE_sri_lanka_mahavihara_prominence_increase_medium_tooltip
						}
						else = {
							custom_tooltip = RICE_sri_lanka_mahavihara_prominence_increase_minor_tooltip
						}
						custom_tooltip = RICE_sri_lanka_abhayagiri_prominence_decrease_minor_tooltip
						custom_tooltip = RICE_sri_lanka_jetavana_prominence_decrease_minor_tooltip
					}
					else_if = {
						limit = {
							involved_activity = {
								has_activity_option = { category = special_type option = RICE_sri_lanka_relic_veneration_type_tooth }
							}			
						}
						if = {
							limit = {
								OR = {
									has_trait = RICE_abhayagiri_trait
									has_global_variable = RICE_sri_lanka_ending_united_sangha_tooth
								}
							}
							custom_tooltip = RICE_sri_lanka_abhayagiri_prominence_increase_medium_tooltip
						}
						else = {
							custom_tooltip = RICE_sri_lanka_abhayagiri_prominence_increase_minor_tooltip
						}
						custom_tooltip = RICE_sri_lanka_mahavihara_prominence_decrease_minor_tooltip
						custom_tooltip = RICE_sri_lanka_jetavana_prominence_decrease_minor_tooltip
					}
					else_if = {
						limit = {
							involved_activity = {
								has_activity_option = { category = special_type option = RICE_sri_lanka_relic_veneration_type_dharmadhatu }
							}			
						}
						if = {
							limit = {
								OR = {
									has_trait = RICE_jetavana_trait
									has_global_variable = RICE_sri_lanka_ending_united_sangha_dharmadhatu
								}
							}
							custom_tooltip = RICE_sri_lanka_jetavana_prominence_increase_medium_tooltip
						}
						else = {
							custom_tooltip = RICE_sri_lanka_jetavana_prominence_increase_minor_tooltip
						}
						custom_tooltip = RICE_sri_lanka_mahavihara_prominence_decrease_minor_tooltip
						custom_tooltip = RICE_sri_lanka_abhayagiri_prominence_decrease_minor_tooltip
					}					
				}
			}
		}
	}
}

RICE_sri_lanka_local_deities_misc_effect = {
	add_piety = 50
	if = {
		limit = {
			exists = struggle:RICE_sri_lanka_struggle
			any_character_struggle = {
				involvement = involved
				is_struggle_type = RICE_sri_lanka_struggle
			}
		}
		struggle:RICE_sri_lanka_struggle = {
			activate_struggle_catalyst = {
				catalyst = catalayst_RICE_sri_lanka_local_deity_worshipped
				character = root
			}
		}
	}
	# every_held_title = {
	# 	custom = RICE_every_sri_lanka_county
	# 	limit = {
	# 		tier = tier_county
	# 		any_county_province = {
	# 			geographical_region = RICE_sri_lanka_struggle_region
	# 		}
	# 	}
	# 	random = {
	# 		chance = RICE_sri_lanka_guardian_deity_county_chance
	# 		add_county_modifier = {
	# 			modifier = RICE_sri_lanka_guardian_deity_county_modifier
	# 			years = 10
	# 		}
	# 	}
	# }
}

RICE_sri_lanka_sri_pada_pilgrimage_completed_log_entry_effect = {
	scope:activity = {
		add_activity_log_entry = {
			key = RICE_sri_lanka_ramasetu_pilgrimage_completed_log
			tags = { completed }
			# this line below adds the entry to the Effects section of the conclusion UI
			show_in_conclusion = yes
			character = root
			scope:host = {
				RICE_local_pilgrimage_generic_host_effect = yes
				stress_impact = {
					base = minor_stress_impact_loss
				}
				if = {
					limit = {
						religion = { is_in_family = rf_abrahamic }
					}
					add_character_modifier = {
						modifier = RICE_sri_lanka_sri_pada_abrahamic_modifier
						years = 10
					}
				}
				else_if = {
					limit = {
						religion = religion:buddhism_religion
					}
					add_character_modifier = {
						modifier = RICE_sri_lanka_sri_pada_buddhist_modifier
						years = 10
					}
				}
				else_if = {
					limit = {
						religion = religion:hinduism_religion
					}
					add_character_modifier = {
						modifier = RICE_sri_lanka_sri_pada_hindu_modifier
						years = 10
					}
				}
				else_if = {
					limit = {
						religion = { is_in_family = rf_eastern }
					}
					add_character_modifier = {
						modifier = RICE_sri_lanka_sri_pada_other_eastern_modifier
						years = 10
					}
				}
				else = {
					add_character_modifier = {
						modifier = RICE_sri_lanka_sri_pada_pagan_modifier
						years = 10
					}
				}
			}
			every_attending_character = {
				limit = { NOT = { this = scope:host } }
				custom = EVERY_ACTIVITY_PARTICIPANT_EFFECT
				RICE_local_pilgrimage_generic_guest_effect = yes
				custom_tooltip = RICE_sri_pada_guest_modifier_tooltip
				hidden_effect = {
					if = {
						limit = {
							religion = { is_in_family = rf_abrahamic }
						}
						add_character_modifier = {
							modifier = RICE_sri_lanka_sri_pada_abrahamic_modifier
							years = 10
						}
					}
					else_if = {
						limit = {
							religion = religion:buddhism_religion
						}
						add_character_modifier = {
							modifier = RICE_sri_lanka_sri_pada_buddhist_modifier
							years = 10
						}
					}
					else_if = {
						limit = {
							religion = religion:hinduism_religion
						}
						add_character_modifier = {
							modifier = RICE_sri_lanka_sri_pada_hindu_modifier
							years = 10
						}
					}
					else_if = {
						limit = {
							religion = { is_in_family = rf_eastern }
						}
						add_character_modifier = {
							modifier = RICE_sri_lanka_sri_pada_other_eastern_modifier
							years = 10
						}
					}
					else = {
						add_character_modifier = {
							modifier = RICE_sri_lanka_sri_pada_pagan_modifier
							years = 10
						}
					}
				}
			}	
		}
	}
}


RICE_sri_lanka_monastery_prominence_all_loss_minor_effect = {

	if = {
		limit = {
			has_trait = RICE_mahavihara_trait
		}
		change_global_variable = {
			name = RICE_mahavihara_prominence
			add = RICE_sri_lanka_prominence_loss_minor
		}
	}

	if = {
		limit = {
			has_trait = RICE_abhayagiri_trait
		}
		change_global_variable = {
			name = RICE_abhayagiri_prominence
			add = RICE_sri_lanka_prominence_loss_minor
		}
	}

	if = {
		limit = {
			has_trait = RICE_jetavana_trait
		}
		change_global_variable = {
			name = RICE_jetavana_prominence
			add = RICE_sri_lanka_prominence_loss_minor
		}
	}

}

RICE_sri_lanka_monastery_prominence_all_loss_medium_effect = {

	if = {
		limit = {
			has_trait = RICE_mahavihara_trait
		}
		change_global_variable = {
			name = RICE_mahavihara_prominence
			add = RICE_sri_lanka_prominence_loss_minor
		}
	}
	else = {		
		change_global_variable = {
			name = RICE_mahavihara_prominence
			add = RICE_sri_lanka_prominence_loss_medium
		}
	}

	if = {
		limit = {
			has_trait = RICE_abhayagiri_trait
		}
		change_global_variable = {
			name = RICE_abhayagiri_prominence
			add = RICE_sri_lanka_prominence_loss_minor
		}
	}
	else = {		
		change_global_variable = {
			name = RICE_abhayagiri_prominence
			add = RICE_sri_lanka_prominence_loss_medium
		}
	}

	if = {
		limit = {
			has_trait = RICE_jetavana_trait
		}
		change_global_variable = {
			name = RICE_jetavana_prominence
			add = RICE_sri_lanka_prominence_loss_minor
		}
	}
	else = {		
		change_global_variable = {
			name = RICE_jetavana_prominence
			add = RICE_sri_lanka_prominence_loss_medium
		}
	}

}


RICE_sri_lanka_monastery_prominence_all_loss_major_effect = {

	if = {
		limit = {
			has_trait = RICE_mahavihara_trait
		}
		change_global_variable = {
			name = RICE_mahavihara_prominence
			add = RICE_sri_lanka_prominence_loss_medium
		}
	}
	else = {		
		change_global_variable = {
			name = RICE_mahavihara_prominence
			add = RICE_sri_lanka_prominence_loss_major
		}
	}

	if = {
		limit = {
			has_trait = RICE_abhayagiri_trait
		}
		change_global_variable = {
			name = RICE_abhayagiri_prominence
			add = RICE_sri_lanka_prominence_loss_medium
		}
	}
	else = {		
		change_global_variable = {
			name = RICE_abhayagiri_prominence
			add = RICE_sri_lanka_prominence_loss_major
		}
	}

	if = {
		limit = {
			has_trait = RICE_jetavana_trait
		}
		change_global_variable = {
			name = RICE_jetavana_prominence
			add = RICE_sri_lanka_prominence_loss_medium
		}
	}
	else = {		
		change_global_variable = {
			name = RICE_jetavana_prominence
			add = RICE_sri_lanka_prominence_loss_major
		}
	}

}

RICE_sri_lanka_monastery_prominence_all_loss_massive_effect = {

	if = {
		limit = {
			has_trait = RICE_mahavihara_trait
		}
		change_global_variable = {
			name = RICE_mahavihara_prominence
			add = RICE_sri_lanka_prominence_loss_major
		}
	}
	else = {		
		change_global_variable = {
			name = RICE_mahavihara_prominence
			add = RICE_sri_lanka_prominence_loss_massive
		}
	}

	if = {
		limit = {
			has_trait = RICE_abhayagiri_trait
		}
		change_global_variable = {
			name = RICE_abhayagiri_prominence
			add = RICE_sri_lanka_prominence_loss_major
		}
	}
	else = {		
		change_global_variable = {
			name = RICE_abhayagiri_prominence
			add = RICE_sri_lanka_prominence_loss_massive
		}
	}

	if = {
		limit = {
			has_trait = RICE_jetavana_trait
		}
		change_global_variable = {
			name = RICE_jetavana_prominence
			add = RICE_sri_lanka_prominence_loss_major
		}
	}
	else = {		
		change_global_variable = {
			name = RICE_jetavana_prominence
			add = RICE_sri_lanka_prominence_loss_massive
		}
	}

}


RICE_sri_lanka_monastery_prominence_all_loss_monumental_effect = {

	if = {
		limit = {
			has_trait = RICE_mahavihara_trait
		}
		change_global_variable = {
			name = RICE_mahavihara_prominence
			add = RICE_sri_lanka_prominence_loss_massive
		}
	}
	else = {		
		change_global_variable = {
			name = RICE_mahavihara_prominence
			add = RICE_sri_lanka_prominence_loss_monumental
		}
	}

	if = {
		limit = {
			has_trait = RICE_abhayagiri_trait
		}
		change_global_variable = {
			name = RICE_abhayagiri_prominence
			add = RICE_sri_lanka_prominence_loss_massive
		}
	}
	else = {		
		change_global_variable = {
			name = RICE_abhayagiri_prominence
			add = RICE_sri_lanka_prominence_loss_monumental
		}
	}

	if = {
		limit = {
			has_trait = RICE_jetavana_trait
		}
		change_global_variable = {
			name = RICE_jetavana_prominence
			add = RICE_sri_lanka_prominence_loss_massive
		}
	}
	else = {		
		change_global_variable = {
			name = RICE_jetavana_prominence
			add = RICE_sri_lanka_prominence_loss_monumental
		}
	}

}

# In case prominence goes above 1000 or below 0
RICE_sri_lanka_prominence_reset_effect = {
	if = {
		limit = {
			global_var:RICE_mahavihara_prominence > 1000
		}
		set_global_variable = {
			name = RICE_mahavihara_prominence
			value = 1000
		}		
	}
	else_if = {
		limit = {
			global_var:RICE_mahavihara_prominence < 0
		}
		set_global_variable = {
			name = RICE_mahavihara_prominence
			value = 0
		}		
	}
	if = {
		limit = {
			global_var:RICE_abhayagiri_prominence > 1000
		}
		set_global_variable = {
			name = RICE_abhayagiri_prominence
			value = 1000
		}		
	}
	else_if = {
		limit = {
			global_var:RICE_abhayagiri_prominence < 0
		}
		set_global_variable = {
			name = RICE_abhayagiri_prominence
			value = 0
		}		
	}
	if = {
		limit = {
			global_var:RICE_jetavana_prominence > 1000
		}
		set_global_variable = {
			name = RICE_jetavana_prominence
			value = 1000
		}		
	}
	else_if = {
		limit = {
			global_var:RICE_jetavana_prominence < 0
		}
		set_global_variable = {
			name = RICE_jetavana_prominence
			value = 0
		}		
	}
}


# If the Prominence values don't exist for some reason, set it to a random number
RICE_sri_lanka_prominence_values_restart_calculator_effect = {
	if = {
		limit = {
			NOT = { exists = global_var:RICE_mahavihara_prominence }
		}
		if = {
			limit = {
				exists = struggle:RICE_sri_lanka_struggle
			}
			set_global_variable = {
				name = RICE_mahavihara_prominence
				value = {
					value = 0
					add = {
						integer_range = {
							min = 1
							max = 150
						}
					}
				}
			}
		}
		else = {
			set_global_variable = {
				name = RICE_mahavihara_prominence
				value = {
					value = 0
					add = {
						integer_range = {
							min = 1
							max = 50
						}
					}
				}
			}
		}
	}
	if = {
		limit = {
			NOT = { exists = global_var:RICE_abhayagiri_prominence }
		}
		if = {
			limit = {
				exists = struggle:RICE_sri_lanka_struggle
			}
			set_global_variable = {
				name = RICE_abhayagiri_prominence
				value = {
					value = 0
					add = {
						integer_range = {
							min = 1
							max = 150
						}
					}
				}
			}
		}
		else = {
			set_global_variable = {
				name = RICE_abhayagiri_prominence
				value = {
					value = 0
					add = {
						integer_range = {
							min = 1
							max = 50
						}
					}
				}
			}
		}
	}
	if = {
		limit = {
			NOT = { exists = global_var:RICE_jetavana_prominence }
		}
		if = {
			limit = {
				exists = struggle:RICE_sri_lanka_struggle
			}
			set_global_variable = {
				name = RICE_jetavana_prominence
				value = {
					value = 0
					add = {
						integer_range = {
							min = 1
							max = 150
						}
					}
				}
			}
		}
		else = {
			set_global_variable = {
				name = RICE_jetavana_prominence
				value = {
					value = 0
					add = {
						integer_range = {
							min = 1
							max = 50
						}
					}
				}
			}
		}
	}
}



RICE_sri_lanka_annual_prominence_values_change_effect = {

	if = {
		limit = {
			exists = struggle:RICE_sri_lanka_struggle
			struggle:RICE_sri_lanka_struggle = {
				is_struggle_phase = struggle_RICE_sri_lanka_phase_purification
			}
		}
		change_global_variable = {
			name = RICE_mahavihara_prominence
			add = {
				value = {
					integer_range = {
						min = RICE_sri_lanka_prominence_change_purification_min
						max = RICE_sri_lanka_prominence_change_purification_max
					}
				}
			}
		}
		change_global_variable = {
			name = RICE_abhayagiri_prominence
			add = {
				value = {
					integer_range = {
						min = RICE_sri_lanka_prominence_change_purification_min
						max = RICE_sri_lanka_prominence_change_purification_max
					}
				}
			}
		}
		change_global_variable = {
			name = RICE_jetavana_prominence
			add = {
				value = {
					integer_range = {
						min = RICE_sri_lanka_prominence_change_purification_min
						max = RICE_sri_lanka_prominence_change_purification_max
					}
				}
			}
		}
	}
	else_if = {
		limit = {
			exists = struggle:RICE_sri_lanka_struggle
			struggle:RICE_sri_lanka_struggle = {
				is_struggle_phase = struggle_RICE_sri_lanka_phase_accumulation
			}
		}
		change_global_variable = {
			name = RICE_mahavihara_prominence
			add = {
				value = {
					integer_range = {
						min = RICE_sri_lanka_prominence_change_accumulation_min
						max = RICE_sri_lanka_prominence_change_accumulation_max
					}
				}
			}
		}
		change_global_variable = {
			name = RICE_abhayagiri_prominence
			add = {
				value = {
					integer_range = {
						min = RICE_sri_lanka_prominence_change_accumulation_min
						max = RICE_sri_lanka_prominence_change_accumulation_max
					}
				}
			}
		}
		change_global_variable = {
			name = RICE_jetavana_prominence
			add = {
				value = {
					integer_range = {
						min = RICE_sri_lanka_prominence_change_accumulation_min
						max = RICE_sri_lanka_prominence_change_accumulation_max
					}
				}
			}
		}
	}
	else_if = {
		limit = {
			exists = struggle:RICE_sri_lanka_struggle
			struggle:RICE_sri_lanka_struggle = {
				is_struggle_phase = struggle_RICE_sri_lanka_phase_degeneration
			}
		}
		change_global_variable = {
			name = RICE_mahavihara_prominence
			add = {
				value = {
					integer_range = {
						min = RICE_sri_lanka_prominence_change_degeneration_min
						max = RICE_sri_lanka_prominence_change_degeneration_max
					}
				}
			}
		}
		change_global_variable = {
			name = RICE_abhayagiri_prominence
			add = {
				value = {
					integer_range = {
						min = RICE_sri_lanka_prominence_change_degeneration_min
						max = RICE_sri_lanka_prominence_change_degeneration_max
					}
				}
			}
		}
		change_global_variable = {
			name = RICE_jetavana_prominence
			add = {
				value = {
					integer_range = {
						min = RICE_sri_lanka_prominence_change_degeneration_min
						max = RICE_sri_lanka_prominence_change_degeneration_max
					}
				}
			}
		}
	}
	else_if = {
		limit = {
			has_global_variable = RICE_sri_lanka_ending_united_sangha_mahavihara
		}
		change_global_variable = {
			name = RICE_mahavihara_prominence
			add = {
				value = {
					integer_range = {
						min = RICE_sri_lanka_prominence_change_winner_min
						max = RICE_sri_lanka_prominence_change_winner_max
					}
				}
			}
		}
		# No need to make it worse if it's already low
		if = {
			limit = {
				global_var:RICE_abhayagiri_prominence > 100
			}
			change_global_variable = {
				name = RICE_abhayagiri_prominence
				add = {
					value = {
						integer_range = {
							min = RICE_sri_lanka_prominence_change_loser_min
							max = RICE_sri_lanka_prominence_change_loser_max
						}
					}
				}
			}
		}
		if = {
			limit = {
				global_var:RICE_jetavana_prominence > 100
			}
			change_global_variable = {
				name = RICE_jetavana_prominence
				add = {
					value = {
						integer_range = {
							min = RICE_sri_lanka_prominence_change_loser_min
							max = RICE_sri_lanka_prominence_change_loser_max
						}
					}
				}
			}
		}
	}
	else_if = {
		limit = {
			has_global_variable = RICE_sri_lanka_ending_united_sangha_abhayagiri
		}
		change_global_variable = {
			name = RICE_abhayagiri_prominence
			add = {
				value = {
					integer_range = {
						min = RICE_sri_lanka_prominence_change_winner_min
						max = RICE_sri_lanka_prominence_change_winner_max
					}
				}
			}
		}
		# No need to make it worse if it's already low
		if = {
			limit = {
				global_var:RICE_mahavihara_prominence > 100
			}
			change_global_variable = {
				name = RICE_mahavihara_prominence
				add = {
					value = {
						integer_range = {
							min = RICE_sri_lanka_prominence_change_loser_min
							max = RICE_sri_lanka_prominence_change_loser_max
						}
					}
				}
			}
		}
		if = {
			limit = {
				global_var:RICE_jetavana_prominence > 100
			}
			change_global_variable = {
				name = RICE_jetavana_prominence
				add = {
					value = {
						integer_range = {
							min = RICE_sri_lanka_prominence_change_loser_min
							max = RICE_sri_lanka_prominence_change_loser_max
						}
					}
				}
			}
		}
	}
	else_if = {
		limit = {
			has_global_variable = RICE_sri_lanka_ending_united_sangha_jetavana
		}
		change_global_variable = {
			name = RICE_jetavana_prominence
			add = {
				value = {
					integer_range = {
						min = RICE_sri_lanka_prominence_change_winner_min
						max = RICE_sri_lanka_prominence_change_winner_max
					}
				}
			}
		}
		# No need to make it worse if it's already low
		if = {
			limit = {
				global_var:RICE_mahavihara_prominence > 100
			}
			change_global_variable = {
				name = RICE_mahavihara_prominence
				add = {
					value = {
						integer_range = {
							min = RICE_sri_lanka_prominence_change_loser_min
							max = RICE_sri_lanka_prominence_change_loser_max
						}
					}
				}
			}
		}
		if = {
			limit = {
				global_var:RICE_abhayagiri_prominence > 100
			}
			change_global_variable = {
				name = RICE_abhayagiri_prominence
				add = {
					value = {
						integer_range = {
							min = RICE_sri_lanka_prominence_change_loser_min
							max = RICE_sri_lanka_prominence_change_loser_max
						}
					}
				}
			}
		}
	}


}





