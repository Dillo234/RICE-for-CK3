yearly_global_pulse = {
	on_actions = { RICE_north_atlantic_maintenance_yearly_global_pulse }
}


RICE_north_atlantic_maintenance_yearly_global_pulse = {
	effect = {
		RICE_greenland_annual_values_calculator_effect = yes
		RICE_greenland_annual_values_reset_effect = yes
		RICE_notify_greenland_values_effect = yes

		# Vinland colony fails
		if = {
			limit = {
				exists = struggle:RICE_greenland_struggle	# Irrelevant if the Greenland struggle doesn't exist
				global_var:RICE_north_atlantic_vinland_outposts > 0
				NOT = { has_global_variable = RICE_vinland_fail_timer }
				#NOT = { has_global_variable = RICE_greenland_ending_integration }
				#NOT = { has_global_variable = RICE_greenland_ending_indigenous }
			}
			random = {
				chance = RICE_vinland_auto_fail_chance_value
				# Timer
				set_global_variable = {
					name = RICE_vinland_fail_timer
					value = yes
					days = 365
				}
				trigger_event = {
					id = north_atlantic.0015
					days = { 0 365 }
				}
			}
		}

		if = {
			limit = {
				exists = struggle:RICE_greenland_struggle	# Irrelevant if the Greenland struggle doesn't exist
				# Environmental/Socio-Economic changes have happened
				has_global_variable = RICE_greenland_environmental_change_warning
				has_global_variable = RICE_greenland_socio_economic_change_warning
				OR = {
					global_var:RICE_greenland_resilience <= 100
					global_var:RICE_greenland_networks <= 100
					AND = {
						global_var:RICE_greenland_resilience <= 500
						global_var:RICE_greenland_networks <= 500
					}
				}
			}
			random = {
				chance = RICE_greenland_auto_fail_chance_value
				set_global_variable = {
					name = RICE_greenland_eastern_settlement_abandoned
					value = yes
				}
				# Grace period - randomized
				random_list = {
					# 15 years
					10 = {
						set_global_variable = {
							name = RICE_greenland_eastern_settlement_abandoned_timer
							value = yes
							years = 5475
						}
					}
					# 20 years
					10 = {
						set_global_variable = {
							name = RICE_greenland_eastern_settlement_abandoned_timer
							value = yes
							years = 7300
						}
					}
					# 25 years
					10 = {
						set_global_variable = {
							name = RICE_greenland_eastern_settlement_abandoned_timer
							value = yes
							years = 9125
						}
					}
					# 30 years
					10 = {
						set_global_variable = {
							name = RICE_greenland_eastern_settlement_abandoned_timer
							value = yes
							years = 10950
						}
					}
				}
				change_global_variable = {
					name = RICE_greenland_resilience
					subtract = 50
				}
				change_global_variable = {
					name = RICE_greenland_networks
					subtract = 50
				}
				trigger_event = {
					id = north_atlantic.0011
					days = { 0 365 }
				}
			}
		}

	}
}



RICE_greenland_struggle_starting_events = {
	events = {
		north_atlantic.0005
		#north_atlantic.0002
	}
}
